{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/src/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers';\nimport { getIronSession } from 'iron-session';\n\nexport interface SessionData {\n  isAuthenticated: boolean;\n  username?: string;\n}\n\n// Validate SESSION_SECRET at runtime\nif (!process.env.SESSION_SECRET || process.env.SESSION_SECRET.length < 32) {\n  throw new Error('SESSION_SECRET must be set and at least 32 characters long');\n}\n\nconst sessionOptions = {\n  password: process.env.SESSION_SECRET,\n  cookieName: 'admin_session',\n  cookieOptions: {\n    secure: process.env.NODE_ENV === 'production',\n    httpOnly: true,\n    sameSite: 'lax' as const,\n    maxAge: 60 * 60 * 24 * 7, // 1 week\n  },\n};\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  return getIronSession<SessionData>(cookieStore, sessionOptions);\n}\n\nexport async function isAuthenticated() {\n  const session = await getSession();\n  return session.isAuthenticated === true;\n}\n\nexport async function login(username: string, password: string): Promise<boolean> {\n  const adminUsername = process.env.ADMIN_USERNAME || 'admin';\n  const adminPassword = process.env.ADMIN_PASSWORD || 'changeme';\n\n  if (username === adminUsername && password === adminPassword) {\n    const session = await getSession();\n    session.isAuthenticated = true;\n    session.username = username;\n    await session.save();\n    return true;\n  }\n  \n  return false;\n}\n\nexport async function logout() {\n  const session = await getSession();\n  session.destroy();\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAOA,qCAAqC;AACrC,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,IAAI,QAAQ,GAAG,CAAC,cAAc,CAAC,MAAM,GAAG,IAAI;IACzE,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,iBAAiB;IACrB,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,YAAY;IACZ,eAAe;QACb,QAAQ,oDAAyB;QACjC,UAAU;QACV,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,OAAO,IAAA,oKAAc,EAAc,aAAa;AAClD;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,OAAO,QAAQ,eAAe,KAAK;AACrC;AAEO,eAAe,MAAM,QAAgB,EAAE,QAAgB;IAC5D,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IACpD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IAEpD,IAAI,aAAa,iBAAiB,aAAa,eAAe;QAC5D,MAAM,UAAU,MAAM;QACtB,QAAQ,eAAe,GAAG;QAC1B,QAAQ,QAAQ,GAAG;QACnB,MAAM,QAAQ,IAAI;QAClB,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,QAAQ,OAAO;AACjB","debugId":null}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { login } from '@/lib/auth';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { username, password } = await request.json();\n\n    if (!username || !password) {\n      return NextResponse.json(\n        { error: 'Username and password are required' },\n        { status: 400 }\n      );\n    }\n\n    const success = await login(username, password);\n\n    if (success) {\n      return NextResponse.json({ success: true });\n    } else {\n      return NextResponse.json(\n        { error: 'Invalid credentials' },\n        { status: 401 }\n      );\n    }\n  } catch (error) {\n    console.error('Login error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjD,IAAI,CAAC,YAAY,CAAC,UAAU;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,IAAA,6HAAK,EAAC,UAAU;QAEtC,IAAI,SAAS;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAK;QAC3C,OAAO;YACL,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}