{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/shared/schema.ts"],"sourcesContent":["import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, integer, boolean, index, uniqueIndex, bigint, jsonb } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Legacy admin users (username/password)\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\n// OAuth users table (for Replit Auth)\nexport const oauthUsers = pgTable(\"oauth_users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Session storage table (for Replit Auth)\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// Admin whitelist (approved emails for OAuth login)\nexport const adminWhitelist = pgTable(\"admin_whitelist\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").notNull().unique(),\n  addedAt: timestamp(\"added_at\").defaultNow(),\n  addedBy: varchar(\"added_by\"), // Who whitelisted this email\n  notes: text(\"notes\"), // Optional notes about this admin\n});\n\nexport const blogPosts = pgTable(\"blog_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  h1: text(\"h1\"), // Custom H1 tag (optional, falls back to title if not set)\n  slug: text(\"slug\").notNull().unique(),\n  content: text(\"content\").notNull(),\n  excerpt: text(\"excerpt\"),\n  author: text(\"author\").notNull().default(\"Economy Plumbing\"),\n  publishDate: timestamp(\"publish_date\").notNull().defaultNow(),\n  category: text(\"category\").notNull(),\n  featuredImage: text(\"featured_image\"), // WebP version for website\n  jpegFeaturedImage: text(\"jpeg_featured_image\"), // JPEG version for RSS/social media\n  imageId: varchar(\"image_id\"), // Links to companyCamPhotos\n  focalPointX: integer(\"focal_point_x\"), // AI-determined focal point X (0-100 percentage from left)\n  focalPointY: integer(\"focal_point_y\"), // AI-determined focal point Y (0-100 percentage from top)\n  metaDescription: text(\"meta_description\"),\n  published: boolean(\"published\").notNull().default(true),\n  isScheduled: boolean(\"is_scheduled\").notNull().default(false), // Auto-scheduled vs manual\n  scheduledFor: timestamp(\"scheduled_for\"), // Future publish date for scheduled posts\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(false), // Track AI-generated posts\n}, (table) => ({\n  publishDateIdx: index(\"blog_posts_publish_date_idx\").on(table.publishDate),\n  categoryIdx: index(\"blog_posts_category_idx\").on(table.category),\n  publishedIdx: index(\"blog_posts_published_idx\").on(table.published),\n  imageIdIdx: index(\"blog_posts_image_id_idx\").on(table.imageId),\n  scheduledIdx: index(\"blog_posts_scheduled_idx\").on(table.isScheduled, table.scheduledFor),\n}));\n\nexport const products = pgTable(\"products\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  description: text(\"description\").notNull(),\n  price: integer(\"price\").notNull(), // in cents\n  category: text(\"category\").notNull(), // 'membership' or 'product'\n  sku: text(\"sku\"), // Product SKU for Zapier/ServiceTitan integration\n  image: text(\"image\"),\n  stripeProductId: text(\"stripe_product_id\"),\n  stripePriceId: text(\"stripe_price_id\"),\n  features: text(\"features\").array(),\n  active: boolean(\"active\").notNull().default(true),\n  \n  // ServiceTitan integration fields (for memberships)\n  serviceTitanMembershipTypeId: text(\"service_titan_membership_type_id\"), // Maps product to ST membership type\n  durationBillingId: text(\"duration_billing_id\"), // ServiceTitan duration/billing ID for membership\n  serviceTitanEnabled: boolean(\"service_titan_enabled\").notNull().default(false), // Enable ST sync for this product\n}, (table) => ({\n  categoryIdx: index(\"products_category_idx\").on(table.category),\n  activeIdx: index(\"products_active_idx\").on(table.active),\n}));\n\nexport const contactSubmissions = pgTable(\"contact_submissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  phone: text(\"phone\").notNull(),\n  email: text(\"email\"),\n  service: text(\"service\"),\n  location: text(\"location\"),\n  urgency: text(\"urgency\"),\n  message: text(\"message\"),\n  pageContext: text(\"page_context\"),\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n}, (table) => ({\n  submittedAtIdx: index(\"contact_submissions_submitted_at_idx\").on(table.submittedAt),\n}));\n\n// Referral code mapping (code â†’ customer ID)\nexport const referralCodes = pgTable(\"referral_codes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  code: text(\"code\").notNull().unique(), // e.g., \"JOHN-SMITH\"\n  customerId: integer(\"customer_id\").notNull(), // ServiceTitan customer ID\n  customerName: text(\"customer_name\").notNull(),\n  customerPhone: text(\"customer_phone\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  codeIdx: index(\"referral_codes_code_idx\").on(table.code),\n  customerIdIdx: index(\"referral_codes_customer_id_idx\").on(table.customerId),\n}));\n\n// Referral tracking system\n// Chatbot conversations\nexport const chatbotConversations = pgTable(\"chatbot_conversations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sessionId: varchar(\"session_id\").notNull(), // Browser session ID\n  customerEmail: varchar(\"customer_email\"),\n  customerPhone: varchar(\"customer_phone\"),\n  startedAt: timestamp(\"started_at\").notNull().defaultNow(),\n  endedAt: timestamp(\"ended_at\"),\n  pageContext: varchar(\"page_context\"), // Which page they started on\n  handoffRequested: boolean(\"handoff_requested\").notNull().default(false),\n  handoffReason: text(\"handoff_reason\"),\n  emailSent: boolean(\"email_sent\").notNull().default(false),\n  archived: boolean(\"archived\").notNull().default(false),\n  notes: text(\"notes\"), // Admin notes\n  rating: integer(\"rating\"), // 1-5 star rating\n  feedbackPositive: integer(\"feedback_positive\").notNull().default(0), // Count of thumbs up\n  feedbackNegative: integer(\"feedback_negative\").notNull().default(0), // Count of thumbs down\n}, (table) => ({\n  sessionIdIdx: index(\"chatbot_conversations_session_id_idx\").on(table.sessionId),\n  startedAtIdx: index(\"chatbot_conversations_started_at_idx\").on(table.startedAt),\n  handoffIdx: index(\"chatbot_conversations_handoff_idx\").on(table.handoffRequested),\n  archivedIdx: index(\"chatbot_conversations_archived_idx\").on(table.archived),\n}));\n\n// Individual messages within a conversation\nexport const chatbotMessages = pgTable(\"chatbot_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  conversationId: varchar(\"conversation_id\").notNull().references(() => chatbotConversations.id, { onDelete: \"cascade\" }),\n  role: varchar(\"role\").notNull(), // 'user', 'assistant', 'system'\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"), // For uploaded images\n  feedback: varchar(\"feedback\"), // 'positive' or 'negative'\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  conversationIdIdx: index(\"chatbot_messages_conversation_id_idx\").on(table.conversationId),\n  createdAtIdx: index(\"chatbot_messages_created_at_idx\").on(table.createdAt),\n}));\n\n// Chatbot analytics and common questions\nexport const chatbotAnalytics = pgTable(\"chatbot_analytics\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  question: text(\"question\").notNull(),\n  category: varchar(\"category\"), // 'pricing', 'emergency', 'scheduling', etc.\n  count: integer(\"count\").notNull().default(1),\n  lastAsked: timestamp(\"last_asked\").notNull().defaultNow(),\n  suggestedAnswer: text(\"suggested_answer\"), // Admin-provided answer\n  isCommon: boolean(\"is_common\").notNull().default(false),\n}, (table) => ({\n  categoryIdx: index(\"chatbot_analytics_category_idx\").on(table.category),\n  countIdx: index(\"chatbot_analytics_count_idx\").on(table.count),\n  isCommonIdx: index(\"chatbot_analytics_is_common_idx\").on(table.isCommon),\n}));\n\n// Quick response templates for the chatbot\nexport const chatbotQuickResponses = pgTable(\"chatbot_quick_responses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  label: varchar(\"label\").notNull(), // Button text\n  message: text(\"message\").notNull(), // What to send when clicked\n  category: varchar(\"category\"), // 'greeting', 'emergency', 'pricing', etc.\n  sortOrder: integer(\"sort_order\").notNull().default(0),\n  active: boolean(\"active\").notNull().default(true),\n  icon: varchar(\"icon\"), // Lucide icon name\n}, (table) => ({\n  categoryIdx: index(\"chatbot_quick_responses_category_idx\").on(table.category),\n  activeIdx: index(\"chatbot_quick_responses_active_idx\").on(table.active),\n  sortOrderIdx: index(\"chatbot_quick_responses_sort_order_idx\").on(table.sortOrder),\n}));\n\nexport const referrals = pgTable(\"referrals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Referrer info (existing customer)\n  referralCode: text(\"referral_code\"), // The code used (e.g., \"JOHN-SMITH\") - links to referralCodes table\n  referrerName: text(\"referrer_name\").notNull(),\n  referrerPhone: text(\"referrer_phone\").notNull(),\n  referrerCustomerId: integer(\"referrer_customer_id\"), // ServiceTitan customer ID (null if not found yet)\n  \n  // Referee info (person being referred)\n  refereeName: text(\"referee_name\").notNull(),\n  refereePhone: text(\"referee_phone\").notNull(),\n  refereeEmail: text(\"referee_email\"),\n  refereeCustomerId: integer(\"referee_customer_id\"), // ServiceTitan customer ID (null until they become a customer)\n  \n  // Status tracking\n  status: text(\"status\").notNull().default('pending'), // 'pending', 'contacted', 'job_completed', 'credited'\n  creditAmount: integer(\"credit_amount\").notNull().default(2500), // Amount in cents ($25.00)\n  \n  // Job completion tracking\n  firstJobId: text(\"first_job_id\"), // ServiceTitan job ID when referee completes first job\n  firstJobDate: timestamp(\"first_job_date\"), // Date when referee completed first job\n  firstJobAmount: integer(\"first_job_amount\"), // Job amount in cents\n  \n  // Credit tracking\n  creditedAt: timestamp(\"credited_at\"), // When credit was applied to referrer's account\n  creditedBy: varchar(\"credited_by\"), // Admin user who applied the credit\n  creditNotes: text(\"credit_notes\"), // Notes about credit application\n  expiresAt: timestamp(\"expires_at\"), // When credit expires (creditedAt + 180 days)\n  \n  // Timestamps\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n  contactedAt: timestamp(\"contacted_at\"), // When business contacted the referee\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n}, (table) => ({\n  referrerCustomerIdIdx: index(\"referrals_referrer_customer_id_idx\").on(table.referrerCustomerId),\n  refereeCustomerIdIdx: index(\"referrals_referee_customer_id_idx\").on(table.refereeCustomerId),\n  statusIdx: index(\"referrals_status_idx\").on(table.status),\n  submittedAtIdx: index(\"referrals_submitted_at_idx\").on(table.submittedAt),\n}));\n\n// Referral credit usage tracking\n// Tracks when customers use their referral credits on jobs\nexport const referralCreditUsage = pgTable(\"referral_credit_usage\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerId: integer(\"customer_id\").notNull(), // ServiceTitan customer ID\n  jobId: text(\"job_id\").notNull(), // ServiceTitan job ID where credit was used\n  jobNumber: text(\"job_number\").notNull(), // Human-readable job number\n  amountUsed: integer(\"amount_used\").notNull(), // Amount in cents\n  usedAt: timestamp(\"used_at\").notNull(), // When the credit was used (job completion date)\n  processedAt: timestamp(\"processed_at\").notNull().defaultNow(), // When we detected and logged this usage\n}, (table) => ({\n  customerIdIdx: index(\"referral_credit_usage_customer_id_idx\").on(table.customerId),\n  jobIdIdx: uniqueIndex(\"referral_credit_usage_job_id_idx\").on(table.jobId), // Prevent duplicate processing\n  usedAtIdx: index(\"referral_credit_usage_used_at_idx\").on(table.usedAt),\n}));\n\n// Referee welcome emails - sent immediately when someone is referred\nexport const refereeWelcomeEmails = pgTable(\"referee_welcome_emails\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to referral\n  referralId: varchar(\"referral_id\").notNull(),\n  \n  // Referee info (who receives the email)\n  refereeName: text(\"referee_name\").notNull(),\n  refereeEmail: text(\"referee_email\").notNull(),\n  referrerName: text(\"referrer_name\").notNull(), // Name of person who referred them\n  \n  // Email content and tracking\n  subject: text(\"subject\").notNull(),\n  htmlContent: text(\"html_content\").notNull(),\n  plainTextContent: text(\"plain_text_content\").notNull(),\n  \n  // Status\n  status: text(\"status\").notNull().default('queued'), // 'queued', 'sent', 'failed'\n  sentAt: timestamp(\"sent_at\"),\n  failureReason: text(\"failure_reason\"),\n  \n  // Engagement tracking\n  emailOpens: integer(\"email_opens\").notNull().default(0),\n  linkClicks: integer(\"link_clicks\").notNull().default(0),\n  \n  // AI generation metadata\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(true),\n  aiPrompt: text(\"ai_prompt\"),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  referralIdIdx: index(\"referee_welcome_emails_referral_id_idx\").on(table.referralId),\n  statusIdx: index(\"referee_welcome_emails_status_idx\").on(table.status),\n  sentAtIdx: index(\"referee_welcome_emails_sent_at_idx\").on(table.sentAt),\n  refereeEmailIdx: index(\"referee_welcome_emails_referee_email_idx\").on(table.refereeEmail),\n}));\n\n// Referrer thank you emails - sent when someone submits a referral\nexport const referrerThankYouEmails = pgTable(\"referrer_thank_you_emails\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to referral\n  referralId: varchar(\"referral_id\").notNull(),\n  \n  // Referrer info (who receives the email)\n  referrerName: text(\"referrer_name\").notNull(),\n  referrerEmail: text(\"referrer_email\").notNull(),\n  referrerCustomerId: integer(\"referrer_customer_id\").notNull(),\n  refereeName: text(\"referee_name\").notNull(), // Who they referred\n  \n  // Email content and tracking\n  subject: text(\"subject\").notNull(),\n  htmlContent: text(\"html_content\").notNull(),\n  plainTextContent: text(\"plain_text_content\").notNull(),\n  \n  // Status\n  status: text(\"status\").notNull().default('queued'), // 'queued', 'approved', 'sent', 'failed'\n  approvedAt: timestamp(\"approved_at\"),\n  approvedBy: varchar(\"approved_by\"), // Admin who approved\n  sentAt: timestamp(\"sent_at\"),\n  failureReason: text(\"failure_reason\"),\n  \n  // Engagement tracking\n  emailOpens: integer(\"email_opens\").notNull().default(0),\n  linkClicks: integer(\"link_clicks\").notNull().default(0),\n  \n  // AI generation metadata\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(true),\n  aiPrompt: text(\"ai_prompt\"),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  referralIdIdx: index(\"referrer_thank_you_emails_referral_id_idx\").on(table.referralId),\n  statusIdx: index(\"referrer_thank_you_emails_status_idx\").on(table.status),\n  sentAtIdx: index(\"referrer_thank_you_emails_sent_at_idx\").on(table.sentAt),\n  referrerEmailIdx: index(\"referrer_thank_you_emails_referrer_email_idx\").on(table.referrerEmail),\n  referrerCustomerIdIdx: index(\"referrer_thank_you_emails_referrer_customer_id_idx\").on(table.referrerCustomerId),\n}));\n\n// Referrer success notification emails - sent when referred customer completes first job\nexport const referrerSuccessEmails = pgTable(\"referrer_success_emails\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to referral\n  referralId: varchar(\"referral_id\").notNull(),\n  \n  // Referrer info (who receives the email)\n  referrerName: text(\"referrer_name\").notNull(),\n  referrerEmail: text(\"referrer_email\").notNull(),\n  referrerCustomerId: integer(\"referrer_customer_id\").notNull(),\n  refereeName: text(\"referee_name\").notNull(), // Who completed the job\n  \n  // Credit details\n  creditAmount: integer(\"credit_amount\").notNull(), // Amount in cents ($25 = 2500)\n  creditExpiresAt: timestamp(\"credit_expires_at\").notNull(),\n  currentBalance: integer(\"current_balance\"), // Total available credits in cents\n  \n  // Email content and tracking\n  subject: text(\"subject\").notNull(),\n  htmlContent: text(\"html_content\").notNull(),\n  plainTextContent: text(\"plain_text_content\").notNull(),\n  \n  // Status\n  status: text(\"status\").notNull().default('queued'), // 'queued', 'approved', 'sent', 'failed'\n  approvedAt: timestamp(\"approved_at\"),\n  approvedBy: varchar(\"approved_by\"), // Admin who approved\n  sentAt: timestamp(\"sent_at\"),\n  failureReason: text(\"failure_reason\"),\n  \n  // Engagement tracking\n  emailOpens: integer(\"email_opens\").notNull().default(0),\n  linkClicks: integer(\"link_clicks\").notNull().default(0),\n  \n  // AI generation metadata\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(true),\n  aiPrompt: text(\"ai_prompt\"),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  referralIdIdx: index(\"referrer_success_emails_referral_id_idx\").on(table.referralId),\n  statusIdx: index(\"referrer_success_emails_status_idx\").on(table.status),\n  sentAtIdx: index(\"referrer_success_emails_sent_at_idx\").on(table.sentAt),\n  referrerEmailIdx: index(\"referrer_success_emails_referrer_email_idx\").on(table.referrerEmail),\n  referrerCustomerIdIdx: index(\"referrer_success_emails_referrer_customer_id_idx\").on(table.referrerCustomerId),\n}));\n\n// Email Preferences - Granular opt-out controls for customers\nexport const emailPreferences = pgTable(\"email_preferences\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Customer identification (email is primary lookup)\n  email: text(\"email\").notNull().unique(),\n  customerId: integer(\"customer_id\"), // ServiceTitan customer ID (if known)\n  \n  // Granular opt-out preferences\n  marketingEmails: boolean(\"marketing_emails\").notNull().default(true), // Newsletters, promotions, segments\n  reviewRequests: boolean(\"review_requests\").notNull().default(true), // Review request drip campaigns\n  referralEmails: boolean(\"referral_emails\").notNull().default(true), // Referral nurture, referee welcome\n  serviceReminders: boolean(\"service_reminders\").notNull().default(true), // Maintenance reminders, follow-ups\n  transactionalOnly: boolean(\"transactional_only\").notNull().default(false), // Receipts, confirmations only\n  \n  // Unsubscribe token for secure one-click unsubscribe\n  unsubscribeToken: text(\"unsubscribe_token\").notNull().unique(),\n  \n  // Tracking\n  optedOutAt: timestamp(\"opted_out_at\"), // When they first opted out of anything\n  fullyUnsubscribedAt: timestamp(\"fully_unsubscribed_at\"), // When they opted out of everything\n  lastUpdated: timestamp(\"last_updated\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  emailIdx: index(\"email_preferences_email_idx\").on(table.email),\n  customerIdIdx: index(\"email_preferences_customer_id_idx\").on(table.customerId),\n  tokenIdx: index(\"email_preferences_token_idx\").on(table.unsubscribeToken),\n}));\n\n// Pending Referrals - Track contact info from referral landing page before job booking\nexport const pendingReferrals = pgTable(\"pending_referrals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Referrer info (from link)\n  referrerCustomerId: integer(\"referrer_customer_id\").notNull(), // ServiceTitan customer ID\n  referrerName: text(\"referrer_name\").notNull(),\n  \n  // Referee info (captured from landing page)\n  refereeName: text(\"referee_name\").notNull(),\n  refereeEmail: text(\"referee_email\"),\n  refereePhone: text(\"referee_phone\"),\n  \n  // Tracking\n  trackingCookie: text(\"tracking_cookie\").unique(), // 30-day cookie for backup tracking\n  convertedToReferral: boolean(\"converted_to_referral\").notNull().default(false),\n  referralId: varchar(\"referral_id\"), // Links to referrals table when they book\n  \n  // Timestamps\n  capturedAt: timestamp(\"captured_at\").notNull().defaultNow(),\n  convertedAt: timestamp(\"converted_at\"), // When they actually booked/became customer\n  expiresAt: timestamp(\"expires_at\").notNull(), // capturedAt + 30 days\n}, (table) => ({\n  referrerIdIdx: index(\"pending_referrals_referrer_id_idx\").on(table.referrerCustomerId),\n  emailIdx: index(\"pending_referrals_email_idx\").on(table.refereeEmail),\n  phoneIdx: index(\"pending_referrals_phone_idx\").on(table.refereePhone),\n  cookieIdx: index(\"pending_referrals_cookie_idx\").on(table.trackingCookie),\n  convertedIdx: index(\"pending_referrals_converted_idx\").on(table.convertedToReferral),\n}));\n\n// Conversion Events - Track key conversion actions on the website\nexport const conversionEvents = pgTable(\"conversion_events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Event type\n  eventType: text(\"event_type\").notNull(), // 'scheduler_open', 'phone_click', 'form_submission'\n  \n  // Source information\n  source: text(\"source\"), // Where the event happened (page URL, email campaign, etc.)\n  utmSource: text(\"utm_source\"),\n  utmMedium: text(\"utm_medium\"),\n  utmCampaign: text(\"utm_campaign\"),\n  utmContent: text(\"utm_content\"),\n  \n  // Additional context\n  metadata: jsonb(\"metadata\"), // Additional event data (form type, phone number clicked, etc.)\n  \n  // User identification (optional)\n  customerId: integer(\"customer_id\"), // ServiceTitan customer ID if known\n  email: text(\"email\"), // Email if provided\n  \n  // Timestamp\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  eventTypeIdx: index(\"conversion_events_event_type_idx\").on(table.eventType),\n  createdAtIdx: index(\"conversion_events_created_at_idx\").on(table.createdAt),\n  customerIdIdx: index(\"conversion_events_customer_id_idx\").on(table.customerId),\n}));\n\n// =====================================================\n// CUSTOM EMAIL CAMPAIGN SYSTEM (5 TABLES)\n// Complete system for custom one-time blasts and drip campaigns\n// AI-powered content generation, audience segmentation, tracking\n// =====================================================\n\n// Customer Segments - Target audiences for campaigns\nexport const customerSegments = pgTable(\"customer_segments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Segment identification\n  name: text(\"name\").notNull().unique(), // \"VIP Customers\", \"Recent Water Heater Installs\", etc.\n  description: text(\"description\"),\n  \n  // Segment type\n  segmentType: text(\"segment_type\").notNull(), // 'static' (manual), 'dynamic' (auto-updated), 'ai_generated'\n  \n  // AI-generated segments\n  aiPrompt: text(\"ai_prompt\"), // \"Customers who spent >$5000 in last 6 months\"\n  aiCriteria: jsonb(\"ai_criteria\"), // Parsed criteria from AI\n  \n  // Static criteria (for manual/dynamic segments)\n  criteria: jsonb(\"criteria\"), // {minLifetimeValue: 5000, lastServiceWithin: 180, tags: ['VIP']}\n  \n  // Statistics\n  customerCount: integer(\"customer_count\").notNull().default(0),\n  lastRefreshedAt: timestamp(\"last_refreshed_at\"), // When dynamic segment was last recalculated\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n}, (table) => ({\n  nameIdx: index(\"customer_segments_name_idx\").on(table.name),\n  typeIdx: index(\"customer_segments_type_idx\").on(table.segmentType),\n}));\n\n// Segment Membership - Links customers to segments\nexport const segmentMembership = pgTable(\"segment_membership\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  segmentId: varchar(\"segment_id\").notNull().references(() => customerSegments.id, { onDelete: 'cascade' }),\n  customerId: integer(\"customer_id\").notNull(), // ServiceTitan customer ID\n  \n  // Metadata\n  addedAt: timestamp(\"added_at\").notNull().defaultNow(),\n  addedBy: varchar(\"added_by\"), // 'manual', 'ai', 'dynamic_refresh'\n}, (table) => ({\n  segmentCustomerIdx: uniqueIndex(\"segment_membership_segment_customer_idx\").on(table.segmentId, table.customerId),\n  customerIdIdx: index(\"segment_membership_customer_id_idx\").on(table.customerId),\n}));\n\n// Custom Email Campaigns - Campaign definitions\nexport const customEmailCampaigns = pgTable(\"custom_email_campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Campaign identification\n  name: text(\"name\").notNull().unique(),\n  description: text(\"description\"),\n  \n  // Campaign type\n  campaignType: text(\"campaign_type\").notNull(), // 'one_time' (single blast), 'drip' (multi-email sequence)\n  \n  // Target audience\n  segmentId: varchar(\"segment_id\").references(() => customerSegments.id, { onDelete: 'set null' }),\n  targetCustomerIds: integer(\"target_customer_ids\").array(), // Manual customer selection (overrides segment)\n  \n  // Tracking & Attribution\n  trackingPhoneNumber: text(\"tracking_phone_number\"), // Campaign-specific phone number\n  utmCampaign: text(\"utm_campaign\"), // Auto-generated from campaign name\n  utmSource: text(\"utm_source\").default('email'),\n  utmMedium: text(\"utm_medium\").default('campaign'),\n  \n  // Status & Approval\n  status: text(\"status\").notNull().default('draft'), // 'draft', 'pending_approval', 'scheduled', 'sending', 'completed', 'paused', 'cancelled'\n  approvedBy: varchar(\"approved_by\"), // Admin user who approved\n  approvedAt: timestamp(\"approved_at\"),\n  \n  // Scheduling (for one-time campaigns)\n  scheduledFor: timestamp(\"scheduled_for\"), // When to send (null = send immediately)\n  \n  // Drip sequence settings (for drip campaigns)\n  dripIntervalDays: integer(\"drip_interval_days\").array(), // [1, 7, 14, 21] - days between emails\n  pauseOnEngagement: boolean(\"pause_on_engagement\").notNull().default(false), // Stop if customer engages\n  \n  // AI generation metadata\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(false),\n  aiPrompt: text(\"ai_prompt\"),\n  aiGoal: text(\"ai_goal\"), // \"Promote spring maintenance\", \"Water heater replacement offers\"\n  \n  // Performance metrics\n  totalSent: integer(\"total_sent\").notNull().default(0),\n  totalDelivered: integer(\"total_delivered\").notNull().default(0),\n  totalOpened: integer(\"total_opened\").notNull().default(0),\n  totalClicked: integer(\"total_clicked\").notNull().default(0),\n  totalUnsubscribed: integer(\"total_unsubscribed\").notNull().default(0),\n  totalBounced: integer(\"total_bounced\").notNull().default(0),\n  \n  // Attribution\n  totalCalls: integer(\"total_calls\").notNull().default(0), // Tracking phone clicks\n  totalJobsBooked: integer(\"total_jobs_booked\").notNull().default(0),\n  totalRevenue: integer(\"total_revenue\").notNull().default(0), // In cents\n  \n  // Send limits & safety\n  dailySendLimit: integer(\"daily_send_limit\").notNull().default(500),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n  startedAt: timestamp(\"started_at\"), // When campaign started sending\n  completedAt: timestamp(\"completed_at\"), // When all emails sent\n}, (table) => ({\n  nameIdx: index(\"custom_campaigns_name_idx\").on(table.name),\n  statusIdx: index(\"custom_campaigns_status_idx\").on(table.status),\n  segmentIdIdx: index(\"custom_campaigns_segment_id_idx\").on(table.segmentId),\n  scheduledForIdx: index(\"custom_campaigns_scheduled_for_idx\").on(table.scheduledFor),\n}));\n\n// Campaign Emails - Individual emails in a campaign\nexport const customCampaignEmails = pgTable(\"custom_campaign_emails\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").notNull().references(() => customEmailCampaigns.id, { onDelete: 'cascade' }),\n  \n  // Email position in sequence (for drip campaigns)\n  sequenceNumber: integer(\"sequence_number\").notNull().default(1), // 1, 2, 3, 4...\n  daysAfterStart: integer(\"days_after_start\").notNull().default(0), // Days after campaign start to send this email (for drip)\n  \n  // Email content\n  subject: text(\"subject\").notNull(),\n  preheader: text(\"preheader\"), // Preview text\n  htmlContent: text(\"html_content\").notNull(), // HTML email body\n  plainTextContent: text(\"plain_text_content\").notNull(), // Plain text fallback\n  \n  // AI generation metadata\n  generatedByAI: boolean(\"generated_by_ai\").notNull().default(false),\n  aiStrategy: text(\"ai_strategy\"), // 'value', 'urgency', 'social_proof', 'seasonal'\n  aiPrompt: text(\"ai_prompt\"),\n  \n  // A/B testing\n  isVariant: boolean(\"is_variant\").notNull().default(false),\n  variantOf: varchar(\"variant_of\"), // ID of email this is a variant of\n  testPercentage: integer(\"test_percentage\"), // 50 = send to 50% of audience\n  \n  // Performance metrics\n  totalSent: integer(\"total_sent\").notNull().default(0),\n  totalOpened: integer(\"total_opened\").notNull().default(0),\n  totalClicked: integer(\"total_clicked\").notNull().default(0),\n  \n  // Status\n  enabled: boolean(\"enabled\").notNull().default(true),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n}, (table) => ({\n  campaignSequenceIdx: index(\"custom_campaign_emails_campaign_sequence_idx\").on(table.campaignId, table.sequenceNumber),\n  variantOfIdx: index(\"custom_campaign_emails_variant_of_idx\").on(table.variantOf),\n}));\n\n// Campaign Send Log - Track every email sent in custom campaigns\nexport const customCampaignSendLog = pgTable(\"custom_campaign_send_log\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Campaign and email references\n  campaignId: varchar(\"campaign_id\").notNull().references(() => customEmailCampaigns.id, { onDelete: 'cascade' }),\n  campaignEmailId: varchar(\"campaign_email_id\").notNull().references(() => customCampaignEmails.id, { onDelete: 'cascade' }),\n  \n  // Recipient\n  customerId: integer(\"customer_id\").notNull(), // ServiceTitan customer ID\n  recipientEmail: text(\"recipient_email\").notNull(),\n  recipientName: text(\"recipient_name\").notNull(),\n  \n  // Email provider tracking\n  resendEmailId: text(\"resend_email_id\"), // Resend's email ID for tracking\n  resendStatus: text(\"resend_status\"), // 'queued', 'sent', 'delivered', 'bounced', 'complained'\n  \n  // Tracking events (timestamps)\n  sentAt: timestamp(\"sent_at\").notNull().defaultNow(),\n  deliveredAt: timestamp(\"delivered_at\"),\n  openedAt: timestamp(\"opened_at\"),\n  clickedAt: timestamp(\"clicked_at\"),\n  bouncedAt: timestamp(\"bounced_at\"),\n  complainedAt: timestamp(\"complained_at\"),\n  unsubscribedAt: timestamp(\"unsubscribed_at\"),\n  \n  // Engagement counters (for webhooks that fire multiple times)\n  openCount: integer(\"open_count\").notNull().default(0),\n  clickCount: integer(\"click_count\").notNull().default(0),\n  \n  // Attribution\n  leadToJobBooking: boolean(\"lead_to_job_booking\").notNull().default(false),\n  jobId: bigint(\"job_id\", { mode: 'number' }), // ServiceTitan job ID if booked\n  revenueAttributed: integer(\"revenue_attributed\").notNull().default(0), // In cents\n  \n  // Error tracking\n  errorMessage: text(\"error_message\"),\n}, (table) => ({\n  campaignCustomerIdx: index(\"custom_send_log_campaign_customer_idx\").on(table.campaignId, table.customerId),\n  campaignEmailIdx: index(\"custom_send_log_campaign_email_idx\").on(table.campaignEmailId),\n  sentAtIdx: index(\"custom_send_log_sent_at_idx\").on(table.sentAt),\n  resendEmailIdIdx: index(\"custom_send_log_resend_id_idx\").on(table.resendEmailId),\n  openedAtIdx: index(\"custom_send_log_opened_at_idx\").on(table.openedAt),\n  clickedAtIdx: index(\"custom_send_log_clicked_at_idx\").on(table.clickedAt),\n}));\n\nexport const customerSuccessStories = pgTable(\"customer_success_stories\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerName: text(\"customer_name\").notNull(),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  story: text(\"story\").notNull(),\n  beforePhotoUrl: text(\"before_photo_url\").notNull(),\n  afterPhotoUrl: text(\"after_photo_url\").notNull(),\n  collagePhotoUrl: text(\"collage_photo_url\"), // AI-generated before/after composite image (WebP)\n  jpegCollagePhotoUrl: text(\"jpeg_collage_photo_url\"), // JPEG version for RSS/social media\n  beforeFocalX: integer(\"before_focal_x\"), // Manual focal point override (0-100 from left)\n  beforeFocalY: integer(\"before_focal_y\"), // Manual focal point override (0-100 from top)\n  afterFocalX: integer(\"after_focal_x\"), // Manual focal point override (0-100 from left)\n  afterFocalY: integer(\"after_focal_y\"), // Manual focal point override (0-100 from top)\n  serviceCategory: text(\"service_category\").notNull(), // water-heater, drain-cleaning, etc.\n  location: text(\"location\").notNull(),\n  approved: boolean(\"approved\").notNull().default(false), // Moderation flag\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n}, (table) => ({\n  submittedAtIdx: index(\"customer_success_stories_submitted_at_idx\").on(table.submittedAt),\n  approvedIdx: index(\"customer_success_stories_approved_idx\").on(table.approved),\n  categoryIdx: index(\"customer_success_stories_category_idx\").on(table.serviceCategory),\n}));\n\nexport const serviceAreas = pgTable(\"service_areas\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  cityName: text(\"city_name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  region: text(\"region\").notNull(), // 'austin' or 'marble-falls'\n  metaDescription: text(\"meta_description\").notNull(),\n  introContent: text(\"intro_content\").notNull(),\n  neighborhoods: text(\"neighborhoods\").array(),\n  landmarks: text(\"landmarks\").array(),\n  localPainPoints: text(\"local_pain_points\").array(),\n  seasonalIssues: text(\"seasonal_issues\").array(),\n  uniqueFaqs: text(\"unique_faqs\").array(), // JSON stringified FAQ objects\n  testimonials: text(\"testimonials\").array(), // JSON stringified testimonial objects\n  population: text(\"population\"),\n  zipCodes: text(\"zip_codes\").array(),\n  latitude: text(\"latitude\"),\n  longitude: text(\"longitude\"),\n}, (table) => ({\n  regionIdx: index(\"service_areas_region_idx\").on(table.region),\n}));\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport const insertBlogPostSchema = createInsertSchema(blogPosts).omit({\n  id: true,\n  publishDate: true,\n});\n\nexport const insertProductSchema = createInsertSchema(products).omit({\n  id: true,\n});\n\nexport const insertContactSubmissionSchema = createInsertSchema(contactSubmissions).omit({\n  id: true,\n  submittedAt: true,\n});\n\nexport const insertCustomerSuccessStorySchema = createInsertSchema(customerSuccessStories).omit({\n  id: true,\n  submittedAt: true,\n  approved: true, // Will be set to false by default, requires admin approval\n});\n\nexport const googleReviews = pgTable(\"google_reviews\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  authorName: text(\"author_name\").notNull(),\n  authorUrl: text(\"author_url\"),\n  profilePhotoUrl: text(\"profile_photo_url\"),\n  rating: integer(\"rating\").notNull(),\n  text: text(\"text\").notNull(),\n  relativeTime: text(\"relative_time\").notNull(),\n  timestamp: integer(\"timestamp\").notNull(),\n  fetchedAt: timestamp(\"fetched_at\").notNull().defaultNow(),\n  categories: text(\"categories\").array().notNull().default(sql`ARRAY[]::text[]`),\n  source: text(\"source\").notNull().default('places_api'), // 'places_api', 'dataforseo', 'facebook', 'gmb_api', 'yelp'\n  reviewId: text(\"review_id\"), // External review ID for deduplication and API posting\n  \n  // Reply tracking\n  replyText: text(\"reply_text\"), // Our posted reply\n  repliedAt: timestamp(\"replied_at\"), // When we replied\n  canReply: boolean(\"can_reply\").notNull().default(false), // Can we reply via API?\n}, (table) => ({\n  ratingIdx: index(\"google_reviews_rating_idx\").on(table.rating),\n  timestampIdx: index(\"google_reviews_timestamp_idx\").on(table.timestamp),\n  sourceIdx: index(\"google_reviews_source_idx\").on(table.source),\n  repliedIdx: index(\"google_reviews_replied_idx\").on(table.repliedAt),\n}));\n\nexport const googleOAuthTokens = pgTable(\"google_oauth_tokens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  service: text(\"service\").notNull().default('google_my_business'), // future-proof for other Google services\n  accessToken: text(\"access_token\").notNull(),\n  refreshToken: text(\"refresh_token\").notNull(),\n  expiryDate: timestamp(\"expiry_date\").notNull(),\n  accountId: text(\"account_id\"), // Google My Business account ID\n  locationId: text(\"location_id\"), // Google My Business location ID\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const zoomOAuthTokens = pgTable(\"zoom_oauth_tokens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  accessToken: text(\"access_token\").notNull(),\n  refreshToken: text(\"refresh_token\").notNull(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  scope: text(\"scope\"),\n  tokenType: text(\"token_type\").notNull().default('bearer'),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const pendingPurchases = pgTable(\"pending_purchases\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  paymentIntentId: text(\"payment_intent_id\").notNull().unique(),\n  productId: varchar(\"product_id\").notNull(),\n  customerType: text(\"customer_type\").notNull(), // 'residential' or 'commercial'\n  \n  // Residential fields\n  customerName: text(\"customer_name\"), // Residential: customer name / Commercial: not used\n  \n  // Commercial fields\n  companyName: text(\"company_name\"), // Commercial only\n  contactPersonName: text(\"contact_person_name\"), // Commercial only\n  locationPhone: text(\"location_phone\"), // Commercial only\n  extension: text(\"extension\"), // Commercial only\n  \n  // Location address (both types)\n  locationName: text(\"location_name\"), // Residential: same as customerName / Commercial: business location name\n  street: text(\"street\").notNull(),\n  city: text(\"city\").notNull(),\n  state: text(\"state\").notNull(),\n  zip: text(\"zip\").notNull(),\n  \n  // Billing address (both types)\n  billingName: text(\"billing_name\"), // Person/company name for billing\n  billingStreet: text(\"billing_street\"),\n  billingCity: text(\"billing_city\"),\n  billingState: text(\"billing_state\"),\n  billingZip: text(\"billing_zip\"),\n  \n  // Contact info (both types)\n  phone: text(\"phone\").notNull(),\n  email: text(\"email\").notNull(),\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  paymentIntentIdIdx: index(\"pending_purchases_payment_intent_id_idx\").on(table.paymentIntentId),\n}));\n\nexport const serviceTitanMemberships = pgTable(\"service_titan_memberships\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerType: text(\"customer_type\").notNull(), // 'residential' or 'commercial'\n  \n  // Residential customer fields\n  customerName: text(\"customer_name\"),\n  \n  // Commercial customer fields\n  companyName: text(\"company_name\"),\n  contactPersonName: text(\"contact_person_name\"),\n  locationPhone: text(\"location_phone\"),\n  extension: text(\"extension\"),\n  \n  // Location address (both types)\n  locationName: text(\"location_name\"),\n  street: text(\"street\").notNull(),\n  city: text(\"city\").notNull(),\n  state: text(\"state\").notNull(),\n  zip: text(\"zip\").notNull(),\n  \n  // Billing address (both types)\n  billingName: text(\"billing_name\"),\n  billingStreet: text(\"billing_street\"),\n  billingCity: text(\"billing_city\"),\n  billingState: text(\"billing_state\"),\n  billingZip: text(\"billing_zip\"),\n  \n  // Contact info\n  phone: text(\"phone\").notNull(),\n  email: text(\"email\").notNull(),\n  \n  // ServiceTitan configuration\n  serviceTitanMembershipTypeId: text(\"service_titan_membership_type_id\").notNull(), // ST membership type from product\n  \n  // ServiceTitan IDs (populated after sync)\n  serviceTitanCustomerId: text(\"service_titan_customer_id\"), // ST customer ID\n  serviceTitanMembershipId: text(\"service_titan_membership_id\"), // ST membership ID\n  serviceTitanInvoiceId: text(\"service_titan_invoice_id\"), // ST invoice ID\n  \n  // Product and payment info\n  productId: varchar(\"product_id\").notNull(), // Links to products table\n  stripePaymentIntentId: text(\"stripe_payment_intent_id\"),\n  stripeCustomerId: text(\"stripe_customer_id\"),\n  amount: integer(\"amount\").notNull(), // Amount in cents\n  \n  // Sync status\n  syncStatus: text(\"sync_status\").notNull().default('pending'), // 'pending', 'syncing', 'synced', 'failed'\n  syncError: text(\"sync_error\"),\n  lastSyncAttempt: timestamp(\"last_sync_attempt\"),\n  syncedAt: timestamp(\"synced_at\"),\n  \n  // Timestamps\n  purchasedAt: timestamp(\"purchased_at\").notNull().defaultNow(),\n}, (table) => ({\n  customerTypeIdx: index(\"st_memberships_customer_type_idx\").on(table.customerType),\n  syncStatusIdx: index(\"st_memberships_sync_status_idx\").on(table.syncStatus),\n  serviceTitanCustomerIdIdx: index(\"st_memberships_st_customer_id_idx\").on(table.serviceTitanCustomerId),\n  productIdIdx: index(\"st_memberships_product_id_idx\").on(table.productId),\n}));\n\n// ServiceTitan Customers Cache - synced from ServiceTitan API for fast local search\nexport const serviceTitanCustomers = pgTable(\"service_titan_customers\", {\n  id: integer(\"id\").primaryKey(), // ServiceTitan customer ID (not UUID, this is the actual ST ID)\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull(), // 'Residential' or 'Commercial'\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  mobilePhone: text(\"mobile_phone\"),\n  street: text(\"street\"),\n  city: text(\"city\"),\n  state: text(\"state\"),\n  zip: text(\"zip\"),\n  active: boolean(\"active\").notNull().default(true),\n  balance: text(\"balance\"), // Stored as text (ServiceTitan format)\n  jobCount: integer(\"job_count\").notNull().default(0), // Total completed jobs for leaderboard\n  \n  // Marketing automation personalization fields\n  lastServiceDate: timestamp(\"last_service_date\"), // Most recent completed job date\n  lastServiceType: text(\"last_service_type\"), // Most recent service category\n  lifetimeValue: integer(\"lifetime_value\").notNull().default(0), // Total revenue in cents\n  customerTags: text(\"customer_tags\").array(), // ['VIP', 'Commercial', 'Seasonal']\n  preferredContactMethod: text(\"preferred_contact_method\"), // 'email', 'sms', 'phone'\n  \n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  activeIdx: index(\"st_customers_active_idx\").on(table.active),\n  emailIdx: index(\"st_customers_email_idx\").on(table.email),\n  phoneIdx: index(\"st_customers_phone_idx\").on(table.phone),\n  mobilePhoneIdx: index(\"st_customers_mobile_phone_idx\").on(table.mobilePhone),\n  typeIdx: index(\"st_customers_type_idx\").on(table.type),\n  jobCountIdx: index(\"st_customers_job_count_idx\").on(table.jobCount),\n  lastSyncedIdx: index(\"st_customers_last_synced_idx\").on(table.lastSyncedAt),\n  lastServiceDateIdx: index(\"st_customers_last_service_date_idx\").on(table.lastServiceDate),\n  lifetimeValueIdx: index(\"st_customers_lifetime_value_idx\").on(table.lifetimeValue),\n  preferredContactIdx: index(\"st_customers_preferred_contact_idx\").on(table.preferredContactMethod),\n}));\n\n// ServiceTitan Customer Contacts - stores all contact methods with normalization\n// This allows searching by any phone/email format and handles number changes\nexport const serviceTitanContacts = pgTable(\"service_titan_contacts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerId: integer(\"customer_id\").notNull(), // References service_titan_customers.id\n  contactType: text(\"contact_type\").notNull(), // 'Phone', 'MobilePhone', 'Email', etc.\n  value: text(\"value\").notNull(), // Raw value from ServiceTitan\n  normalizedValue: text(\"normalized_value\").notNull(), // Normalized for searching (digits only for phones, lowercase for emails)\n  isPrimary: boolean(\"is_primary\").notNull().default(false),\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  customerIdIdx: index(\"st_contacts_customer_id_idx\").on(table.customerId),\n  // Critical: Fast O(1) lookup by normalized phone/email\n  normalizedValueIdx: index(\"st_contacts_normalized_value_idx\").on(table.normalizedValue),\n  contactTypeIdx: index(\"st_contacts_contact_type_idx\").on(table.contactType),\n}));\n\n// NEW XLSX-BASED TABLES - These are the primary tables for customer data\n// The old serviceTitanCustomers/Contacts tables will continue to be synced by the API (which we can't stop)\n// but all application code will use these XLSX-based tables instead\n\n// XLSX Customers - Primary customer data source (replaces serviceTitanCustomers for application use)\nexport const customersXlsx = pgTable(\"customers_xlsx\", {\n  id: integer(\"id\").primaryKey(), // ServiceTitan customer ID from XLSX\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull(), // 'Residential' or 'Commercial'\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  mobilePhone: text(\"mobile_phone\"),\n  street: text(\"street\"),\n  city: text(\"city\"),\n  state: text(\"state\"),\n  zip: text(\"zip\"),\n  active: boolean(\"active\").notNull().default(true),\n  balance: text(\"balance\"),\n  jobCount: integer(\"job_count\").notNull().default(0),\n  \n  // Marketing automation personalization fields\n  lastServiceDate: timestamp(\"last_service_date\"),\n  lastServiceType: text(\"last_service_type\"),\n  lifetimeValue: integer(\"lifetime_value\").notNull().default(0), // Total revenue in cents\n  customerTags: text(\"customer_tags\").array(),\n  preferredContactMethod: text(\"preferred_contact_method\"),\n  \n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  activeIdx: index(\"customers_xlsx_active_idx\").on(table.active),\n  emailIdx: index(\"customers_xlsx_email_idx\").on(table.email),\n  phoneIdx: index(\"customers_xlsx_phone_idx\").on(table.phone),\n  mobilePhoneIdx: index(\"customers_xlsx_mobile_phone_idx\").on(table.mobilePhone),\n  typeIdx: index(\"customers_xlsx_type_idx\").on(table.type),\n  jobCountIdx: index(\"customers_xlsx_job_count_idx\").on(table.jobCount),\n  lastSyncedIdx: index(\"customers_xlsx_last_synced_idx\").on(table.lastSyncedAt),\n  lastServiceDateIdx: index(\"customers_xlsx_last_service_date_idx\").on(table.lastServiceDate),\n  lifetimeValueIdx: index(\"customers_xlsx_lifetime_value_idx\").on(table.lifetimeValue),\n  preferredContactIdx: index(\"customers_xlsx_preferred_contact_idx\").on(table.preferredContactMethod),\n}));\n\n// XLSX Customer Contacts - Primary contact data source (replaces serviceTitanContacts for application use)\nexport const contactsXlsx = pgTable(\"contacts_xlsx\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerId: integer(\"customer_id\").notNull(), // References customers_xlsx.id\n  contactType: text(\"contact_type\").notNull(), // 'Phone', 'MobilePhone', 'Email', etc.\n  value: text(\"value\").notNull(), // Raw value from XLSX\n  normalizedValue: text(\"normalized_value\").notNull(), // Normalized for searching (digits only for phones, lowercase for emails)\n  isPrimary: boolean(\"is_primary\").notNull().default(false),\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  customerIdIdx: index(\"contacts_xlsx_customer_id_idx\").on(table.customerId),\n  normalizedValueIdx: index(\"contacts_xlsx_normalized_value_idx\").on(table.normalizedValue),\n  contactTypeIdx: index(\"contacts_xlsx_contact_type_idx\").on(table.contactType),\n}));\n\n// Customer Data Import History - Tracks XLSX imports from ServiceTitan\n// Mailgun webhook attempt logging - tracks EVERY webhook hit (success or failure)\nexport const mailgunWebhookLogs = pgTable(\"mailgun_webhook_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Webhook metadata\n  receivedAt: timestamp(\"received_at\").notNull().defaultNow(),\n  messageId: text(\"message_id\"), // Mailgun message ID\n  sender: text(\"sender\"), // From address\n  recipient: text(\"recipient\"), // To address\n  subject: text(\"subject\"),\n  \n  // Signature verification\n  signatureVerified: boolean(\"signature_verified\").notNull().default(false),\n  timestampAge: integer(\"timestamp_age\"), // Seconds old when received\n  \n  // Attachment detection\n  attachmentCount: integer(\"attachment_count\").notNull().default(0),\n  xlsxFound: boolean(\"xlsx_found\").notNull().default(false),\n  xlsxFileName: text(\"xlsx_file_name\"),\n  xlsxSize: integer(\"xlsx_size\"), // Bytes\n  \n  // Processing result\n  status: text(\"status\").notNull(), // 'success', 'failed', 'rejected'\n  errorMessage: text(\"error_message\"),\n  importId: varchar(\"import_id\"), // Links to customerDataImports if successful\n  \n  // Timing\n  processingTime: integer(\"processing_time\"), // Milliseconds\n}, (table) => ({\n  receivedAtIdx: index(\"mailgun_webhook_logs_received_at_idx\").on(table.receivedAt),\n  statusIdx: index(\"mailgun_webhook_logs_status_idx\").on(table.status),\n  messageIdIdx: index(\"mailgun_webhook_logs_message_id_idx\").on(table.messageId),\n}));\n\nexport const customerDataImports = pgTable(\"customer_data_imports\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Import metadata\n  fileName: text(\"file_name\").notNull(), // Original XLSX filename\n  importedBy: text(\"imported_by\"), // Email of admin who triggered import (if manual)\n  importSource: text(\"import_source\").notNull().default('manual'), // 'manual', 'email', 'scheduled'\n  \n  // Import statistics\n  totalRows: integer(\"total_rows\").notNull().default(0),\n  customersImported: integer(\"customers_imported\").notNull().default(0),\n  contactsImported: integer(\"contacts_imported\").notNull().default(0),\n  errors: integer(\"errors\").notNull().default(0),\n  \n  // Metrics snapshot (at time of import)\n  totalLifetimeRevenue: integer(\"total_lifetime_revenue\").notNull().default(0), // In cents\n  customersWithRevenue: integer(\"customers_with_revenue\").notNull().default(0),\n  avgLifetimeRevenue: integer(\"avg_lifetime_revenue\").notNull().default(0), // In cents\n  maxLifetimeRevenue: integer(\"max_lifetime_revenue\").notNull().default(0), // In cents\n  \n  // Significant changes detection\n  newCustomers: integer(\"new_customers\").notNull().default(0), // Customers added since last import\n  revenueChange: integer(\"revenue_change\").notNull().default(0), // Revenue delta in cents\n  \n  // Import status\n  status: text(\"status\").notNull().default('processing'), // 'processing', 'completed', 'failed'\n  errorMessage: text(\"error_message\"),\n  \n  // Timestamps\n  startedAt: timestamp(\"started_at\").notNull().defaultNow(),\n  completedAt: timestamp(\"completed_at\"),\n  processingTime: integer(\"processing_time\"), // Milliseconds\n}, (table) => ({\n  importSourceIdx: index(\"customer_imports_source_idx\").on(table.importSource),\n  statusIdx: index(\"customer_imports_status_idx\").on(table.status),\n  startedAtIdx: index(\"customer_imports_started_at_idx\").on(table.startedAt),\n}));\n\nexport const trackingNumbers = pgTable(\"tracking_numbers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  channelKey: text(\"channel_key\").notNull().unique(), // e.g., 'google', 'facebook', 'yelp'\n  channelName: text(\"channel_name\").notNull(), // Display name, e.g., 'Google Ads'\n  displayNumber: text(\"display_number\").notNull(), // (512) 368-9159\n  rawNumber: text(\"raw_number\").notNull(), // 5123689159\n  telLink: text(\"tel_link\").notNull(), // tel:+15123689159\n  detectionRules: text(\"detection_rules\").notNull(), // JSON string of detection rules\n  isActive: boolean(\"is_active\").notNull().default(true),\n  isDefault: boolean(\"is_default\").notNull().default(false), // One channel should be default\n  sortOrder: integer(\"sort_order\").notNull().default(0), // For ordering in admin panel\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n}, (table) => ({\n  channelKeyIdx: index(\"tracking_numbers_channel_key_idx\").on(table.channelKey),\n  isActiveIdx: index(\"tracking_numbers_is_active_idx\").on(table.isActive),\n  isDefaultIdx: index(\"tracking_numbers_is_default_idx\").on(table.isDefault),\n}));\n\nexport const insertServiceAreaSchema = createInsertSchema(serviceAreas).omit({\n  id: true,\n});\n\nexport const insertTrackingNumberSchema = createInsertSchema(trackingNumbers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertGoogleReviewSchema = createInsertSchema(googleReviews).omit({\n  id: true,\n  fetchedAt: true,\n});\n\nexport const insertGoogleOAuthTokenSchema = createInsertSchema(googleOAuthTokens).omit({\n  id: true,\n  updatedAt: true,\n});\n\nexport const insertZoomOAuthTokenSchema = createInsertSchema(zoomOAuthTokens).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPendingPurchaseSchema = createInsertSchema(pendingPurchases).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertServiceTitanMembershipSchema = createInsertSchema(serviceTitanMemberships).omit({\n  id: true,\n  purchasedAt: true,\n  lastSyncAttempt: true,\n  syncedAt: true,\n});\n\nexport const companyCamPhotos = pgTable(\"companycam_photos\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  companyCamPhotoId: text(\"companycam_photo_id\").unique(), // Nullable for non-CompanyCam sources\n  companyCamProjectId: text(\"companycam_project_id\"), // Nullable for non-CompanyCam sources\n  photoUrl: text(\"photo_url\").notNull(),\n  thumbnailUrl: text(\"thumbnail_url\"),\n  source: text(\"source\").notNull().default('companycam'), // 'companycam', 'gdrive', 'servicetitan'\n  \n  // AI-generated categorization\n  category: text(\"category\").notNull(), // 'water_heater', 'drain', 'leak', 'toilet', 'faucet', 'gas', 'backflow', 'commercial', 'general'\n  aiDescription: text(\"ai_description\"), // What the AI sees in the photo\n  tags: text(\"tags\").array(), // Additional tags from AI analysis\n  \n  // AI quality analysis (OpenAI Vision)\n  qualityAnalyzed: boolean(\"quality_analyzed\").notNull().default(false),\n  isGoodQuality: boolean(\"is_good_quality\"),\n  shouldKeep: boolean(\"should_keep\"),\n  qualityScore: integer(\"quality_score\"), // 1-10\n  qualityReasoning: text(\"quality_reasoning\"),\n  analyzedAt: timestamp(\"analyzed_at\"),\n  \n  // Focal Point (for image positioning in blogs/pages)\n  focalPointX: integer(\"focal_point_x\"), // 0-100 percentage from left\n  focalPointY: integer(\"focal_point_y\"), // 0-100 percentage from top\n  focalPointReason: text(\"focal_point_reason\"), // Why this focal point was chosen\n  \n  // Blog topic suggestion (for auto-generation)\n  suggestedBlogTopic: text(\"suggested_blog_topic\"), // AI-suggested blog post topic\n  blogTopicAnalyzed: boolean(\"blog_topic_analyzed\").notNull().default(false),\n  blogTopicAnalyzedAt: timestamp(\"blog_topic_analyzed_at\"),\n  \n  // Metadata\n  uploadedAt: timestamp(\"uploaded_at\"),\n  fetchedAt: timestamp(\"fetched_at\").notNull().defaultNow(),\n  \n  // Usage tracking\n  usedInBlogPostId: varchar(\"used_in_blog_post_id\"),\n  usedInPageUrl: text(\"used_in_page_url\"),\n}, (table) => ({\n  categoryIdx: index(\"companycam_photos_category_idx\").on(table.category),\n  projectIdIdx: index(\"companycam_photos_project_id_idx\").on(table.companyCamProjectId),\n  qualityIdx: index(\"companycam_photos_quality_idx\").on(table.shouldKeep),\n  blogTopicIdx: index(\"companycam_photos_blog_topic_idx\").on(table.blogTopicAnalyzed, table.usedInBlogPostId),\n}));\n\nexport const insertCompanyCamPhotoSchema = createInsertSchema(companyCamPhotos).omit({\n  id: true,\n  fetchedAt: true,\n});\n\nexport const beforeAfterComposites = pgTable(\"before_after_composites\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Source photos\n  beforePhotoId: varchar(\"before_photo_id\").notNull(),\n  afterPhotoId: varchar(\"after_photo_id\").notNull(),\n  \n  // Composite images (WebP for web, JPEG for RSS/social)\n  compositeUrl: text(\"composite_url\").notNull(),\n  jpegCompositeUrl: text(\"jpeg_composite_url\"),\n  \n  // AI-generated content\n  caption: text(\"caption\"), // AI-generated caption for social media\n  category: text(\"category\").notNull(), // Inherited from photos\n  \n  // Metadata\n  jobId: text(\"job_id\"), // ServiceTitan job ID\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  \n  // Social media tracking\n  postedToFacebook: boolean(\"posted_to_facebook\").notNull().default(false),\n  postedToInstagram: boolean(\"posted_to_instagram\").notNull().default(false),\n  facebookPostId: text(\"facebook_post_id\"),\n  instagramPostId: text(\"instagram_post_id\"),\n  postedAt: timestamp(\"posted_at\"),\n}, (table) => ({\n  categoryIdx: index(\"before_after_composites_category_idx\").on(table.category),\n  postedIdx: index(\"before_after_composites_posted_idx\").on(table.postedToFacebook, table.postedToInstagram),\n}));\n\nexport const insertBeforeAfterCompositeSchema = createInsertSchema(beforeAfterComposites).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const systemSettings = pgTable(\"system_settings\", {\n  key: text(\"key\").primaryKey(),\n  value: text(\"value\"),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const notFoundErrors = pgTable(\"not_found_errors\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  requestedUrl: text(\"requested_url\").notNull(),\n  referrer: text(\"referrer\"),\n  userAgent: text(\"user_agent\"),\n  ipAddress: text(\"ip_address\"),\n  timestamp: timestamp(\"timestamp\").notNull().defaultNow(),\n  emailSent: boolean(\"email_sent\").notNull().default(false),\n}, (table) => ({\n  timestampIdx: index(\"not_found_errors_timestamp_idx\").on(table.timestamp),\n  urlIdx: index(\"not_found_errors_url_idx\").on(table.requestedUrl),\n}));\n\nexport const importedPhotos = pgTable(\"imported_photos\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  url: text(\"url\").notNull(), // Object Storage URL\n  category: text(\"category\").notNull(), // 'drain-cleaning', 'water-heater', etc.\n  \n  // AI Analysis\n  isProductionQuality: boolean(\"is_production_quality\").notNull().default(true), // Whether photo is good enough for customer-facing use\n  aiQuality: integer(\"ai_quality\"), // 0-100 quality score\n  aiQualityScore: integer(\"ai_quality_score\"), // Alias for compatibility\n  qualityReason: text(\"quality_reason\"), // Why it passed/failed quality check\n  aiDescription: text(\"ai_description\"),\n  aiTags: text(\"ai_tags\").array(),\n  \n  // Focal Point (for image positioning)\n  focalPointX: integer(\"focal_point_x\"), // 0-100 percentage from left\n  focalPointY: integer(\"focal_point_y\"), // 0-100 percentage from top\n  \n  // Metadata\n  gdriveFileId: text(\"gdrive_file_id\").unique(), // Google Drive file ID for deduplication\n  usedInBlog: boolean(\"used_in_blog\").notNull().default(false),\n  usedInBlogPostId: text(\"used_in_blog_post_id\"), // Track which blog post uses this photo\n  usedInPageUrl: text(\"used_in_page_url\"), // Track which page uses this photo\n  uploadDate: timestamp(\"upload_date\"), // When photo was uploaded\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(), // When record was created\n  fetchedAt: timestamp(\"fetched_at\").notNull().defaultNow(),\n}, (table) => ({\n  categoryIdx: index(\"imported_photos_category_idx\").on(table.category),\n  usedIdx: index(\"imported_photos_used_idx\").on(table.usedInBlog),\n  qualityIdx: index(\"imported_photos_quality_idx\").on(table.isProductionQuality),\n  gdriveIdx: index(\"imported_photos_gdrive_idx\").on(table.gdriveFileId),\n}));\n\nexport const insertSystemSettingSchema = createInsertSchema(systemSettings);\nexport const insertNotFoundErrorSchema = createInsertSchema(notFoundErrors).omit({\n  id: true,\n  timestamp: true,\n});\n\nexport const insertImportedPhotoSchema = createInsertSchema(importedPhotos).omit({\n  id: true,\n  fetchedAt: true,\n});\n\n// Commercial customers/clients for trust signal display\nexport const commercialCustomers = pgTable(\"commercial_customers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  logoUrl: text(\"logo_url\").notNull(),\n  websiteUrl: text(\"website_url\"),\n  location: text(\"location\"), // Austin, Marble Falls, Liberty Hill, Leander, etc.\n  industry: text(\"industry\"), // Restaurant, Auto Services, Coworking, etc.\n  customerSince: integer(\"customer_since\"), // Year they became a customer\n  displayOrder: integer(\"display_order\").notNull().default(0), // For manual ordering\n  active: boolean(\"active\").notNull().default(true), // Show/hide without deleting\n  addedAt: timestamp(\"added_at\").notNull().defaultNow(),\n}, (table) => ({\n  activeIdx: index(\"commercial_customers_active_idx\").on(table.active),\n  displayOrderIdx: index(\"commercial_customers_display_order_idx\").on(table.displayOrder),\n}));\n\nexport const insertCommercialCustomerSchema = createInsertSchema(commercialCustomers).omit({\n  id: true,\n  addedAt: true,\n});\n\n// Page metadata for SEO management\n// Customer Portal Analytics (track search attempts)\nexport const portalAnalytics = pgTable(\"portal_analytics\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  searchType: text(\"search_type\").notNull(), // 'phone' or 'email'\n  searchValue: text(\"search_value\").notNull(), // The phone/email searched for\n  found: boolean(\"found\").notNull(), // Whether customer was found\n  customerId: integer(\"customer_id\"), // ServiceTitan customer ID if found\n  timestamp: timestamp(\"timestamp\").notNull().defaultNow(),\n}, (table) => ({\n  timestampIdx: index(\"portal_analytics_timestamp_idx\").on(table.timestamp),\n  foundIdx: index(\"portal_analytics_found_idx\").on(table.found),\n}));\n\n// Phone-based login temporary lookups (prevents email harvesting)\nexport const phoneLoginLookups = pgTable(\"phone_login_lookups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  lookupToken: text(\"lookup_token\").notNull().unique(),\n  phone: text(\"phone\").notNull(),\n  email: text(\"email\").notNull(),\n  customerId: integer(\"customer_id\").notNull(),\n  expiresAt: timestamp(\"expires_at\", { withTimezone: true }).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  tokenIdx: index(\"phone_login_lookups_token_idx\").on(table.lookupToken),\n  expiresIdx: index(\"phone_login_lookups_expires_idx\").on(table.expiresAt),\n}));\n\n// Customer Portal Authentication (SMS codes and email magic links)\nexport const portalVerifications = pgTable(\"portal_verifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Verification details\n  verificationType: text(\"verification_type\").notNull(), // 'sms' or 'email'\n  contactValue: text(\"contact_value\").notNull(), // Phone number or email address\n  \n  // Code/token\n  code: text(\"code\").notNull(), // 6-digit code for SMS, UUID token for email\n  \n  // Customer info (array to support multiple accounts with shared email/phone)\n  customerIds: integer(\"customer_ids\").array().notNull(), // ServiceTitan customer IDs\n  \n  // Verification status\n  verified: boolean(\"verified\").notNull().default(false),\n  verifiedAt: timestamp(\"verified_at\", { withTimezone: true }),\n  \n  // Security & expiry\n  expiresAt: timestamp(\"expires_at\", { withTimezone: true }).notNull(), // 10 min for SMS, 1 hour for email\n  attempts: integer(\"attempts\").notNull().default(0), // Track failed attempts\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).notNull().defaultNow(),\n}, (table) => ({\n  codeIdx: index(\"portal_verifications_code_idx\").on(table.code),\n  contactIdx: index(\"portal_verifications_contact_idx\").on(table.contactValue),\n  expiresIdx: index(\"portal_verifications_expires_idx\").on(table.expiresAt),\n}));\n\nexport const pageMetadata = pgTable(\"page_metadata\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  path: text(\"path\").notNull().unique(), // URL path like '/commercial-plumbing' or '/about'\n  title: text(\"title\").notNull(), // SEO title tag\n  description: text(\"description\").notNull(), // Meta description\n  keywords: text(\"keywords\"), // Optional meta keywords\n  canonicalUrl: text(\"canonical_url\"), // Optional custom canonical URL\n  ogImage: text(\"og_image\"), // Optional custom OG image\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  pathIdx: index(\"page_metadata_path_idx\").on(table.path),\n}));\n\nexport const insertPageMetadataSchema = createInsertSchema(pageMetadata).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertServiceTitanCustomerSchema = createInsertSchema(serviceTitanCustomers).omit({\n  lastSyncedAt: true,\n});\n\nexport const insertServiceTitanContactSchema = createInsertSchema(serviceTitanContacts).omit({\n  id: true,\n  lastSyncedAt: true,\n});\n\nexport const insertMailgunWebhookLogSchema = createInsertSchema(mailgunWebhookLogs).omit({\n  id: true,\n  receivedAt: true,\n});\n\nexport const insertCustomerDataImportSchema = createInsertSchema(customerDataImports).omit({\n  id: true,\n  startedAt: true,\n  completedAt: true,\n});\n\nexport const otpVerifications = pgTable(\"otp_verifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  phoneNumber: text(\"phone_number\").notNull(),\n  otp: text(\"otp\").notNull(),\n  verified: boolean(\"verified\").notNull().default(false),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  phoneNumberIdx: index(\"otp_verifications_phone_number_idx\").on(table.phoneNumber),\n  expiresAtIdx: index(\"otp_verifications_expires_at_idx\").on(table.expiresAt),\n}));\n\nexport const insertOtpVerificationSchema = createInsertSchema(otpVerifications).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Custom review submissions (direct from website, not Google/Facebook)\nexport const customReviews = pgTable(\"custom_reviews\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Customer info\n  customerName: text(\"customer_name\").notNull(),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  serviceTitanCustomerId: integer(\"service_titan_customer_id\"), // Link to ServiceTitan if available\n  \n  // Review content\n  rating: integer(\"rating\").notNull(), // 1-5 stars\n  title: text(\"title\"), // Optional review title/headline\n  text: text(\"text\").notNull(),\n  serviceType: text(\"service_type\"), // What service they received\n  jobDate: timestamp(\"job_date\"), // When was the service performed\n  \n  // Photos (optional - customers can upload photos)\n  photoUrls: text(\"photo_urls\").array().default(sql`ARRAY[]::text[]`),\n  \n  // Moderation workflow\n  status: text(\"status\").notNull().default('pending'), // 'pending', 'approved', 'rejected', 'spam'\n  \n  // Reply tracking (custom reviews can be replied to on our website)\n  replyText: text(\"reply_text\"), // Our posted reply\n  repliedAt: timestamp(\"replied_at\"), // When we replied\n  moderatedBy: varchar(\"moderated_by\"), // Admin user ID who approved/rejected\n  moderatedAt: timestamp(\"moderated_at\"),\n  moderationNotes: text(\"moderation_notes\"), // Internal notes from moderator\n  \n  // Display settings\n  featured: boolean(\"featured\").notNull().default(false), // Highlight on homepage\n  displayOnWebsite: boolean(\"display_on_website\").notNull().default(true), // Show publicly\n  \n  // Metadata\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n  ipAddress: text(\"ip_address\"), // For spam prevention\n  userAgent: text(\"user_agent\"), // For analytics\n  source: text(\"source\").notNull().default('website'), // 'website', 'email_link', 'sms_link'\n  requestId: varchar(\"request_id\"), // Links to review_requests table\n}, (table) => ({\n  statusIdx: index(\"custom_reviews_status_idx\").on(table.status),\n  ratingIdx: index(\"custom_reviews_rating_idx\").on(table.rating),\n  submittedAtIdx: index(\"custom_reviews_submitted_at_idx\").on(table.submittedAt),\n  featuredIdx: index(\"custom_reviews_featured_idx\").on(table.featured),\n  customerIdIdx: index(\"custom_reviews_customer_id_idx\").on(table.serviceTitanCustomerId),\n}));\n\nexport const insertCustomReviewSchema = createInsertSchema(customReviews).omit({\n  id: true,\n  submittedAt: true,\n  moderatedBy: true,\n  moderatedAt: true,\n});\n\n// Review platform links (Google, Facebook, BBB, Yelp)\nexport const reviewPlatforms = pgTable(\"review_platforms\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  platform: text(\"platform\").notNull().unique(), // 'google', 'facebook', 'bbb', 'yelp'\n  displayName: text(\"display_name\").notNull(), // 'Google', 'Facebook', 'Better Business Bureau', 'Yelp'\n  url: text(\"url\").notNull(), // Direct link to review page\n  enabled: boolean(\"enabled\").notNull().default(true),\n  sortOrder: integer(\"sort_order\").notNull().default(0), // Display order\n  icon: text(\"icon\"), // Icon name or emoji\n  description: text(\"description\"), // Optional description\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\n// ServiceTitan Jobs Staging - Raw API responses for safe processing\nexport const serviceTitanJobsStaging = pgTable(\"service_titan_jobs_staging\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  jobId: bigint(\"job_id\", { mode: 'number' }).notNull(), // ServiceTitan job ID\n  rawData: jsonb(\"raw_data\").notNull(), // Complete job object from API\n  fetchedAt: timestamp(\"fetched_at\").notNull().defaultNow(),\n  processedAt: timestamp(\"processed_at\"), // When it was normalized to serviceTitanJobs\n  processingError: text(\"processing_error\"),\n}, (table) => ({\n  jobIdIdx: index(\"st_jobs_staging_job_id_idx\").on(table.jobId),\n  fetchedAtIdx: index(\"st_jobs_staging_fetched_at_idx\").on(table.fetchedAt),\n  processedAtIdx: index(\"st_jobs_staging_processed_at_idx\").on(table.processedAt),\n}));\n\n// ServiceTitan Jobs - Normalized job data for fast queries (kept for customer portal)\nexport const serviceTitanJobs = pgTable(\"service_titan_jobs\", {\n  id: bigint(\"id\", { mode: 'number' }).primaryKey(), // ServiceTitan job ID\n  jobNumber: varchar(\"job_number\").notNull(),\n  customerId: integer(\"customer_id\").notNull(), // References serviceTitanCustomers.id\n  jobType: varchar(\"job_type\"),\n  businessUnitId: bigint(\"business_unit_id\", { mode: 'number' }),\n  \n  // Job status\n  jobStatus: varchar(\"job_status\").notNull(), // 'Completed', 'Canceled', 'InProgress', etc.\n  completedOn: timestamp(\"completed_on\"),\n  \n  // Financial data\n  total: integer(\"total\").notNull().default(0), // Total amount in cents\n  invoice: integer(\"invoice\").notNull().default(0), // Invoice amount in cents\n  \n  // Service info (kept for customer portal display)\n  serviceCategory: varchar(\"service_category\"), // 'Plumbing', 'Water Heater', 'Drain Cleaning', etc.\n  equipmentInstalled: text(\"equipment_installed\").array(), // ['Tankless Water Heater', 'Water Softener']\n  customerSatisfaction: integer(\"customer_satisfaction\"), // 1-5 rating\n  \n  // Timestamps\n  createdOn: timestamp(\"created_on\").notNull(),\n  modifiedOn: timestamp(\"modified_on\").notNull(),\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  customerIdIdx: index(\"st_jobs_customer_id_idx\").on(table.customerId),\n  jobStatusIdx: index(\"st_jobs_job_status_idx\").on(table.jobStatus),\n  completedOnIdx: index(\"st_jobs_completed_on_idx\").on(table.completedOn),\n  modifiedOnIdx: index(\"st_jobs_modified_on_idx\").on(table.modifiedOn),\n  jobNumberIdx: index(\"st_jobs_job_number_idx\").on(table.jobNumber),\n  serviceCategoryIdx: index(\"st_jobs_service_category_idx\").on(table.serviceCategory),\n  customerSatisfactionIdx: index(\"st_jobs_customer_satisfaction_idx\").on(table.customerSatisfaction),\n}));\n\n// Sync Watermarks - Tracks incremental sync progress for ServiceTitan API\nexport const syncWatermarks = pgTable(\"sync_watermarks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  syncType: varchar(\"sync_type\").notNull(), // 'customers', 'jobs', etc.\n  lastSuccessfulSyncAt: timestamp(\"last_successful_sync_at\"),\n  lastModifiedOnFetched: timestamp(\"last_modified_on_fetched\"), // Watermark timestamp\n  recordsProcessed: integer(\"records_processed\").notNull().default(0),\n  syncDuration: integer(\"sync_duration\"), // Milliseconds\n  lastError: text(\"last_error\"),\n  lastErrorAt: timestamp(\"last_error_at\"),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\n// ServiceTitan Job Forms - Form submissions from jobs (for customer portal)\nexport const serviceTitanJobForms = pgTable(\"service_titan_job_forms\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  formId: bigint(\"form_id\", { mode: 'number' }).notNull(), // ServiceTitan form ID\n  jobId: bigint(\"job_id\", { mode: 'number' }).notNull(), // References serviceTitanJobs.id\n  customerId: integer(\"customer_id\").notNull(), // References serviceTitanCustomers.id\n  formTemplateId: bigint(\"form_template_id\", { mode: 'number' }),\n  formTemplateName: text(\"form_template_name\"),\n  rawFormData: jsonb(\"raw_form_data\").notNull(), // Complete form JSON\n  parsedFields: jsonb(\"parsed_fields\").notNull(), // Normalized key-value pairs\n  technicianNotes: text(\"technician_notes\"),\n  customerConcerns: text(\"customer_concerns\").array(),\n  recommendationsMade: text(\"recommendations_made\").array(),\n  equipmentCondition: text(\"equipment_condition\"),\n  submittedOn: timestamp(\"submitted_on\").notNull(),\n  submittedBy: text(\"submitted_by\"),\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  jobIdIdx: index(\"st_job_forms_job_id_idx\").on(table.jobId),\n  customerIdIdx: index(\"st_job_forms_customer_id_idx\").on(table.customerId),\n  formIdIdx: index(\"st_job_forms_form_id_idx\").on(table.formId),\n}));\n\n// ServiceTitan Estimates - Quotes/estimates from jobs (enhanced for AI analytics)\nexport const serviceTitanEstimates = pgTable(\"service_titan_estimates\", {\n  id: bigint(\"id\", { mode: 'number' }).primaryKey(), // ServiceTitan estimate ID\n  jobId: bigint(\"job_id\", { mode: 'number' }), // Optional: linked job ID\n  customerId: integer(\"customer_id\").notNull(), // References serviceTitanCustomers.id\n  \n  // Estimate details\n  name: text(\"name\"),\n  summary: text(\"summary\"),\n  status: varchar(\"status\").notNull(), // 'Open', 'Sold', 'Dismissed'\n  soldBy: text(\"sold_by\"), // Salesperson name\n  soldOn: timestamp(\"sold_on\"), // When estimate was sold\n  dismissedBy: text(\"dismissed_by\"),\n  dismissedOn: timestamp(\"dismissed_on\"),\n  \n  // Financial data\n  subtotal: integer(\"subtotal\").notNull().default(0), // Subtotal in cents\n  tax: integer(\"tax\").notNull().default(0), // Tax amount in cents\n  total: integer(\"total\").notNull().default(0), // Total amount in cents\n  \n  // Metadata\n  createdBy: text(\"created_by\"), // Who created the estimate\n  createdOn: timestamp(\"created_on\").notNull(),\n  modifiedOn: timestamp(\"modified_on\"),\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  jobIdIdx: index(\"st_estimates_job_id_idx\").on(table.jobId),\n  customerIdIdx: index(\"st_estimates_customer_id_idx\").on(table.customerId),\n  statusIdx: index(\"st_estimates_status_idx\").on(table.status),\n  soldOnIdx: index(\"st_estimates_sold_on_idx\").on(table.soldOn),\n  createdOnIdx: index(\"st_estimates_created_on_idx\").on(table.createdOn),\n}));\n\n// ServiceTitan Line Items - Individual services, materials, equipment from estimates\nexport const serviceTitanLineItems = pgTable(\"service_titan_line_items\", {\n  id: bigint(\"id\", { mode: 'number' }).primaryKey(), // ServiceTitan line item ID\n  estimateId: bigint(\"estimate_id\", { mode: 'number' }).notNull(), // References serviceTitanEstimates.id\n  jobId: bigint(\"job_id\", { mode: 'number' }), // Optional: job ID if booked\n  customerId: integer(\"customer_id\").notNull(), // References serviceTitanCustomers.id\n  \n  // Line item details\n  itemType: varchar(\"item_type\").notNull(), // 'Service', 'Material', 'Equipment'\n  skuId: bigint(\"sku_id\", { mode: 'number' }), // Pricebook SKU ID\n  skuName: text(\"sku_name\"), // SKU display name\n  description: text(\"description\"),\n  \n  // Equipment-specific fields (for water heater analytics)\n  equipmentManufacturer: text(\"equipment_manufacturer\"), // e.g., 'Rheem', 'Bradford White'\n  equipmentModel: text(\"equipment_model\"), // Model number\n  equipmentSize: text(\"equipment_size\"), // e.g., '50 gallon', '75,000 BTU'\n  equipmentType: text(\"equipment_type\"), // e.g., 'Tankless', 'Tank', 'Heat Pump'\n  \n  // Pricing\n  quantity: integer(\"quantity\").notNull().default(1),\n  unitPrice: integer(\"unit_price\").notNull().default(0), // Price per unit in cents\n  totalPrice: integer(\"total_price\").notNull().default(0), // Total price in cents\n  cost: integer(\"cost\").notNull().default(0), // Cost to business in cents\n  memberPrice: integer(\"member_price\"), // Member discount price in cents\n  \n  // Status\n  sold: boolean(\"sold\").notNull().default(false),\n  soldBy: text(\"sold_by\"),\n  soldOn: timestamp(\"sold_on\"),\n  \n  // Metadata\n  lastSyncedAt: timestamp(\"last_synced_at\").notNull().defaultNow(),\n}, (table) => ({\n  estimateIdIdx: index(\"st_line_items_estimate_id_idx\").on(table.estimateId),\n  jobIdIdx: index(\"st_line_items_job_id_idx\").on(table.jobId),\n  customerIdIdx: index(\"st_line_items_customer_id_idx\").on(table.customerId),\n  itemTypeIdx: index(\"st_line_items_item_type_idx\").on(table.itemType),\n  skuIdIdx: index(\"st_line_items_sku_id_idx\").on(table.skuId),\n  equipmentTypeIdx: index(\"st_line_items_equipment_type_idx\").on(table.equipmentType),\n  soldIdx: index(\"st_line_items_sold_idx\").on(table.sold),\n  soldOnIdx: index(\"st_line_items_sold_on_idx\").on(table.soldOn),\n}));\n\n// Marketing tables removed - all marketing infrastructure has been removed from the system\n\nexport const insertServiceTitanEstimateSchema = createInsertSchema(serviceTitanEstimates).omit({\n  lastSyncedAt: true,\n});\n\nexport const insertServiceTitanLineItemSchema = createInsertSchema(serviceTitanLineItems).omit({\n  lastSyncedAt: true,\n});\n\nexport const insertReviewPlatformSchema = createInsertSchema(reviewPlatforms).omit({\n  id: true,\n  updatedAt: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type ImportedPhoto = typeof importedPhotos.$inferSelect;\nexport type InsertImportedPhoto = z.infer<typeof insertImportedPhotoSchema>;\nexport type User = typeof users.$inferSelect;\nexport type BlogPost = typeof blogPosts.$inferSelect;\nexport type InsertBlogPost = z.infer<typeof insertBlogPostSchema>;\nexport type Product = typeof products.$inferSelect;\nexport type InsertProduct = z.infer<typeof insertProductSchema>;\nexport type ContactSubmission = typeof contactSubmissions.$inferSelect;\nexport type InsertContactSubmission = z.infer<typeof insertContactSubmissionSchema>;\nexport type CustomerSuccessStory = typeof customerSuccessStories.$inferSelect;\nexport type InsertCustomerSuccessStory = z.infer<typeof insertCustomerSuccessStorySchema>;\nexport type ServiceArea = typeof serviceAreas.$inferSelect;\nexport type InsertServiceArea = z.infer<typeof insertServiceAreaSchema>;\nexport type GoogleReview = typeof googleReviews.$inferSelect;\nexport type InsertGoogleReview = z.infer<typeof insertGoogleReviewSchema>;\nexport type GoogleOAuthToken = typeof googleOAuthTokens.$inferSelect;\nexport type InsertGoogleOAuthToken = z.infer<typeof insertGoogleOAuthTokenSchema>;\nexport type ZoomOAuthToken = typeof zoomOAuthTokens.$inferSelect;\nexport type InsertZoomOAuthToken = z.infer<typeof insertZoomOAuthTokenSchema>;\nexport type PendingPurchase = typeof pendingPurchases.$inferSelect;\nexport type InsertPendingPurchase = z.infer<typeof insertPendingPurchaseSchema>;\nexport type ServiceTitanMembership = typeof serviceTitanMemberships.$inferSelect;\nexport type InsertServiceTitanMembership = z.infer<typeof insertServiceTitanMembershipSchema>;\nexport type CompanyCamPhoto = typeof companyCamPhotos.$inferSelect;\nexport type InsertCompanyCamPhoto = z.infer<typeof insertCompanyCamPhotoSchema>;\nexport type BeforeAfterComposite = typeof beforeAfterComposites.$inferSelect;\nexport type InsertBeforeAfterComposite = z.infer<typeof insertBeforeAfterCompositeSchema>;\nexport type SystemSetting = typeof systemSettings.$inferSelect;\nexport type InsertSystemSetting = z.infer<typeof insertSystemSettingSchema>;\nexport type NotFoundError = typeof notFoundErrors.$inferSelect;\nexport type InsertNotFoundError = z.infer<typeof insertNotFoundErrorSchema>;\nexport type TrackingNumber = typeof trackingNumbers.$inferSelect;\nexport type InsertTrackingNumber = z.infer<typeof insertTrackingNumberSchema>;\nexport type CommercialCustomer = typeof commercialCustomers.$inferSelect;\nexport type InsertCommercialCustomer = z.infer<typeof insertCommercialCustomerSchema>;\nexport type PageMetadata = typeof pageMetadata.$inferSelect;\nexport type InsertPageMetadata = z.infer<typeof insertPageMetadataSchema>;\nexport type ServiceTitanCustomer = typeof serviceTitanCustomers.$inferSelect;\nexport type InsertServiceTitanCustomer = z.infer<typeof insertServiceTitanCustomerSchema>;\nexport type ServiceTitanContact = typeof serviceTitanContacts.$inferSelect;\nexport type InsertServiceTitanContact = z.infer<typeof insertServiceTitanContactSchema>;\nexport type ServiceTitanEstimate = typeof serviceTitanEstimates.$inferSelect;\nexport type InsertServiceTitanEstimate = z.infer<typeof insertServiceTitanEstimateSchema>;\nexport type ServiceTitanLineItem = typeof serviceTitanLineItems.$inferSelect;\nexport type InsertServiceTitanLineItem = z.infer<typeof insertServiceTitanLineItemSchema>;\nexport type MailgunWebhookLog = typeof mailgunWebhookLogs.$inferSelect;\nexport type InsertMailgunWebhookLog = z.infer<typeof insertMailgunWebhookLogSchema>;\nexport type CustomerDataImport = typeof customerDataImports.$inferSelect;\nexport type InsertCustomerDataImport = z.infer<typeof insertCustomerDataImportSchema>;\nexport type OAuthUser = typeof oauthUsers.$inferSelect;\nexport type UpsertOAuthUser = typeof oauthUsers.$inferInsert;\nexport type AdminWhitelist = typeof adminWhitelist.$inferSelect;\nexport type InsertAdminWhitelist = typeof adminWhitelist.$inferInsert;\nexport type OtpVerification = typeof otpVerifications.$inferSelect;\nexport type InsertOtpVerification = z.infer<typeof insertOtpVerificationSchema>;\nexport type CustomReview = typeof customReviews.$inferSelect;\nexport type InsertCustomReview = z.infer<typeof insertCustomReviewSchema>;\n// Review request types removed - will be rebuilt\nexport type ReviewPlatform = typeof reviewPlatforms.$inferSelect;\nexport type InsertReviewPlatform = z.infer<typeof insertReviewPlatformSchema>;\nexport type ServiceTitanJob = typeof serviceTitanJobs.$inferSelect;\nexport type ServiceTitanJobStaging = typeof serviceTitanJobsStaging.$inferSelect;\nexport type SyncWatermark = typeof syncWatermarks.$inferSelect;\n\n\n// Marketing schemas removed - will be rebuilt\n\n// Review link click schema removed - will be rebuilt\n\n// ServiceTitan job form schema removed - will be rebuilt\n\n// Audience movement and marketing system settings schemas removed - will be rebuilt\n\n\n// Review Email Preferences - SEPARATE from marketing preferences (transactional)\n\n// =====================================================\n// SMS MARKETING SYSTEM (5 TABLES)\n// Complete SMS infrastructure for marketing, promotions, and review requests\n// TCPA-compliant with explicit opt-in/opt-out management\n// =====================================================\n\n// SMS Marketing Preferences - TCPA-compliant opt-in/opt-out tracking\n\n// Review request campaign schema removed - will be rebuilt\n\n// Review drip email schema removed - will be rebuilt\n\n\n\n// Reputation management schemas removed - will be rebuilt\n\n// ============================================================================\n// REVIEW & REFERRAL DRIP CAMPAIGN SYSTEM\n// ============================================================================\n\n// Job Completions - Track recently completed jobs eligible for review requests\nexport const jobCompletions = pgTable(\"job_completions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // ServiceTitan job details\n  jobId: integer(\"job_id\").notNull().unique(),\n  customerId: integer(\"customer_id\").notNull(),\n  customerName: text(\"customer_name\").notNull(),\n  customerEmail: text(\"customer_email\"),\n  customerPhone: text(\"customer_phone\"),\n  \n  // Job metadata\n  completionDate: timestamp(\"completion_date\").notNull(),\n  serviceName: text(\"service_name\"),\n  technicianName: text(\"technician_name\"),\n  invoiceTotal: integer(\"invoice_total\"), // In cents\n  jobNotes: text(\"job_notes\"),\n  \n  // Marketing flags\n  marketingOptedOut: boolean(\"marketing_opted_out\").notNull().default(false),\n  isQuoteOnly: boolean(\"is_quote_only\").notNull().default(false), // $0 jobs - quotes/estimates without completed work\n  \n  // Tracking\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  completionDateIdx: index(\"job_completions_completion_date_idx\").on(table.completionDate),\n  customerIdIdx: index(\"job_completions_customer_id_idx\").on(table.customerId),\n}));\n\n// Review Requests - 4-email drip campaign over 21 days\nexport const reviewRequests = pgTable(\"review_requests\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to job\n  jobCompletionId: varchar(\"job_completion_id\").notNull(),\n  customerId: integer(\"customer_id\").notNull(),\n  customerEmail: text(\"customer_email\").notNull(),\n  \n  // Campaign status\n  status: text(\"status\").notNull().default('queued'), // 'queued', 'email1_sent', 'email2_sent', 'email3_sent', 'email4_sent', 'completed', 'stopped'\n  stopReason: text(\"stop_reason\"), // 'review_submitted', 'opted_out', 'email_bounced'\n  \n  // Email tracking (4 emails in drip)\n  email1SentAt: timestamp(\"email1_sent_at\"),\n  email2SentAt: timestamp(\"email2_sent_at\"),\n  email3SentAt: timestamp(\"email3_sent_at\"),\n  email4SentAt: timestamp(\"email4_sent_at\"),\n  \n  // Response tracking\n  reviewSubmitted: boolean(\"review_submitted\").notNull().default(false),\n  reviewSubmittedAt: timestamp(\"review_submitted_at\"),\n  reviewRating: integer(\"review_rating\"), // 1-5 stars\n  reviewPlatform: text(\"review_platform\"), // 'google', 'facebook', 'internal'\n  \n  // Engagement\n  emailOpens: integer(\"email_opens\").notNull().default(0),\n  linkClicks: integer(\"link_clicks\").notNull().default(0),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  completedAt: timestamp(\"completed_at\"),\n}, (table) => ({\n  statusIdx: index(\"review_requests_status_idx\").on(table.status),\n  customerIdIdx: index(\"review_requests_customer_id_idx\").on(table.customerId),\n  createdAtIdx: index(\"review_requests_created_at_idx\").on(table.createdAt),\n}));\n\n// Review Feedback - Internal feedback from <4 star reviews\nexport const reviewFeedback = pgTable(\"review_feedback\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to review request\n  reviewRequestId: varchar(\"review_request_id\").notNull(),\n  customerId: integer(\"customer_id\").notNull(),\n  \n  // Feedback details\n  rating: integer(\"rating\").notNull(), // 1-5 stars (typically <4)\n  feedbackText: text(\"feedback_text\"),\n  wouldRecommend: boolean(\"would_recommend\"),\n  \n  // Admin follow-up\n  followedUp: boolean(\"followed_up\").notNull().default(false),\n  followedUpAt: timestamp(\"followed_up_at\"),\n  followUpNotes: text(\"follow_up_notes\"),\n  resolved: boolean(\"resolved\").notNull().default(false),\n  \n  // Timestamps\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n}, (table) => ({\n  reviewRequestIdIdx: index(\"review_feedback_review_request_idx\").on(table.reviewRequestId),\n  followedUpIdx: index(\"review_feedback_followed_up_idx\").on(table.followedUp),\n  ratingIdx: index(\"review_feedback_rating_idx\").on(table.rating),\n}));\n\n// Referral Nurture Campaigns - 4-email drip over 6 months for happy reviewers\nexport const referralNurtureCampaigns = pgTable(\"referral_nurture_campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Links to customer\n  customerId: integer(\"customer_id\").notNull().unique(), // One campaign per customer\n  customerEmail: text(\"customer_email\").notNull(),\n  originalReviewId: varchar(\"original_review_id\"), // The review that triggered this campaign\n  \n  // Campaign status\n  status: text(\"status\").notNull().default('queued'), // 'queued', 'email1_sent', 'email2_sent', 'email3_sent', 'email4_sent', 'completed', 'paused'\n  pauseReason: text(\"pause_reason\"), // 'referral_submitted', 'opted_out', 'low_engagement'\n  \n  // Email tracking (4 emails over 6 months)\n  email1SentAt: timestamp(\"email1_sent_at\"), // Day 14\n  email2SentAt: timestamp(\"email2_sent_at\"), // Day 60\n  email3SentAt: timestamp(\"email3_sent_at\"), // Day 150\n  email4SentAt: timestamp(\"email4_sent_at\"), // Day 210\n  \n  // Engagement tracking\n  consecutiveUnopened: integer(\"consecutive_unopened\").notNull().default(0), // Auto-pause after 2\n  totalOpens: integer(\"total_opens\").notNull().default(0),\n  totalClicks: integer(\"total_clicks\").notNull().default(0),\n  \n  // Referral tracking\n  referralsSubmitted: integer(\"referrals_submitted\").notNull().default(0),\n  lastReferralAt: timestamp(\"last_referral_at\"),\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  pausedAt: timestamp(\"paused_at\"),\n  completedAt: timestamp(\"completed_at\"),\n}, (table) => ({\n  statusIdx: index(\"referral_nurture_status_idx\").on(table.status),\n  customerIdIdx: index(\"referral_nurture_customer_id_idx\").on(table.customerId),\n  createdAtIdx: index(\"referral_nurture_created_at_idx\").on(table.createdAt),\n}));\n\n// Review Email Templates - Customizable templates for campaign emails\nexport const reviewEmailTemplates = pgTable(\"review_email_templates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Template identification\n  campaignType: text(\"campaign_type\").notNull(), // 'review_request', 'referral_nurture', 'quote_followup'\n  emailNumber: integer(\"email_number\").notNull(), // 1-4\n  \n  // Template content\n  subject: text(\"subject\").notNull(),\n  htmlContent: text(\"html_content\").notNull(),\n  plainTextContent: text(\"plain_text_content\").notNull(),\n  \n  // Dynamic merge fields used (for reference)\n  mergeFields: text(\"merge_fields\").array(), // ['customerName', 'technicianName', 'serviceName', etc.]\n  \n  // Admin customization\n  isDefault: boolean(\"is_default\").notNull().default(false),\n  customized: boolean(\"customized\").notNull().default(false),\n  lastEditedBy: varchar(\"last_edited_by\"),\n  lastEditedAt: timestamp(\"last_edited_at\"),\n  \n  // AI generation metadata\n  aiGenerated: boolean(\"ai_generated\").notNull().default(false),\n  aiPrompt: text(\"ai_prompt\"), // The prompt used to generate this template\n  \n  // Timestamps\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n}, (table) => ({\n  campaignTypeIdx: index(\"review_email_templates_campaign_type_idx\").on(table.campaignType),\n  emailNumberIdx: index(\"review_email_templates_email_number_idx\").on(table.emailNumber),\n  uniqueCampaignEmail: uniqueIndex(\"review_email_templates_campaign_email_unique\").on(table.campaignType, table.emailNumber),\n}));\n\n// Email Send Log - Tracks all campaign email sends for engagement tracking\nexport const emailSendLog = pgTable(\"email_send_log\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Campaign identification\n  campaignType: text(\"campaign_type\").notNull(), // 'review_request', 'referral_nurture', 'quote_followup'\n  campaignRecordId: varchar(\"campaign_record_id\").notNull(), // ID of reviewRequest or referralNurtureCampaign\n  emailNumber: integer(\"email_number\").notNull(), // 1-4\n  \n  // Recipient info\n  recipientEmail: text(\"recipient_email\").notNull(),\n  recipientName: text(\"recipient_name\"),\n  customerId: integer(\"customer_id\").notNull(),\n  \n  // Email provider details\n  resendEmailId: text(\"resend_email_id\").unique(), // Resend's email ID for webhook tracking\n  resendStatus: text(\"resend_status\"), // 'queued', 'sent', 'delivered', 'bounced', 'complained'\n  \n  // Tracking events\n  sentAt: timestamp(\"sent_at\").notNull().defaultNow(),\n  deliveredAt: timestamp(\"delivered_at\"),\n  openedAt: timestamp(\"opened_at\"),\n  clickedAt: timestamp(\"clicked_at\"),\n  bouncedAt: timestamp(\"bounced_at\"),\n  complainedAt: timestamp(\"complained_at\"),\n  \n  // Error tracking\n  errorMessage: text(\"error_message\"),\n}, (table) => ({\n  resendEmailIdIdx: index(\"email_send_log_resend_email_id_idx\").on(table.resendEmailId),\n  campaignTypeIdx: index(\"email_send_log_campaign_type_idx\").on(table.campaignType),\n  campaignRecordIdx: index(\"email_send_log_campaign_record_idx\").on(table.campaignRecordId),\n  recipientEmailIdx: index(\"email_send_log_recipient_email_idx\").on(table.recipientEmail),\n}));\n\n// Email Suppression List - Hard bounces, spam complaints (NEVER email these)\nexport const emailSuppressionList = pgTable(\"email_suppression_list\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  \n  // Suppression reason\n  reason: text(\"reason\").notNull(), // 'hard_bounce', 'spam_complaint', 'manual_suppression'\n  reasonDetails: text(\"reason_details\"),\n  \n  // Source tracking\n  resendEmailId: text(\"resend_email_id\"),\n  campaignRecordId: varchar(\"campaign_record_id\"),\n  \n  // Timestamps\n  addedAt: timestamp(\"added_at\").notNull().defaultNow(),\n}, (table) => ({\n  emailIdx: index(\"email_suppression_list_email_idx\").on(table.email),\n  reasonIdx: index(\"email_suppression_list_reason_idx\").on(table.reason),\n}));\n\n// ============================================================================\n// SYSTEM RELIABILITY & MONITORING\n// ============================================================================\n\n// Webhook Failure Queue - Stores failed webhook events for retry\nexport const webhookFailureQueue = pgTable(\"webhook_failure_queue\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  \n  // Webhook details\n  webhookType: text(\"webhook_type\").notNull(), // 'resend', 'stripe', 'twilio', etc.\n  webhookEvent: text(\"webhook_event\").notNull(), // 'email.delivered', 'email.bounced', etc.\n  rawPayload: jsonb(\"raw_payload\").notNull(), // Complete webhook payload\n  \n  // HTTP request details\n  headers: jsonb(\"headers\").notNull(), // Webhook headers for verification\n  signature: text(\"signature\"), // Original signature for retry verification\n  \n  // Retry tracking\n  attemptCount: integer(\"attempt_count\").notNull().default(0),\n  maxAttempts: integer(\"max_attempts\").notNull().default(5),\n  nextRetryAt: timestamp(\"next_retry_at\"), // When to retry next\n  lastAttemptAt: timestamp(\"last_attempt_at\"),\n  lastError: text(\"last_error\"), // Error message from last attempt\n  \n  // Status\n  status: text(\"status\").notNull().default('pending'), // 'pending', 'retrying', 'succeeded', 'dead_letter'\n  processedAt: timestamp(\"processed_at\"), // When successfully processed\n  movedToDeadLetterAt: timestamp(\"moved_to_dead_letter_at\"), // When moved to dead letter queue\n  \n  // Timestamps\n  receivedAt: timestamp(\"received_at\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n}, (table) => ({\n  statusIdx: index(\"webhook_failure_queue_status_idx\").on(table.status),\n  nextRetryAtIdx: index(\"webhook_failure_queue_next_retry_at_idx\").on(table.nextRetryAt),\n  webhookTypeIdx: index(\"webhook_failure_queue_type_idx\").on(table.webhookType),\n}));\n\n// Campaign Send Idempotency - Prevents duplicate email/SMS sends\n\n// SMS Marketing insert schemas\n// SMS marketing schemas removed - will be rebuilt\n\n// SMS campaign schema removed - will be rebuilt\n\n// SMS campaign message schema removed - will be rebuilt\n\n// SMS send log schema removed - will be rebuilt\n\n// SMS keyword schema removed - will be rebuilt\n\n// System Reliability & Monitoring insert schemas\nexport const insertWebhookFailureQueueSchema = createInsertSchema(webhookFailureQueue).omit({\n  id: true,\n  receivedAt: true,\n  createdAt: true,\n  processedAt: true,\n  movedToDeadLetterAt: true,\n  lastAttemptAt: true,\n});\n\n\n// System health check schema removed - will be rebuilt\n\n// Marketing type exports removed - will be rebuilt\nexport type WebhookFailureQueue = typeof webhookFailureQueue.$inferSelect;\nexport type InsertWebhookFailureQueue = z.infer<typeof insertWebhookFailureQueueSchema>;\n// System health check types removed - will be rebuilt\n\n// Chatbot types and schemas\nexport const insertChatbotConversationSchema = createInsertSchema(chatbotConversations).omit({\n  id: true,\n  startedAt: true,\n  feedbackPositive: true,\n  feedbackNegative: true,\n});\n\nexport const insertChatbotMessageSchema = createInsertSchema(chatbotMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertChatbotAnalyticsSchema = createInsertSchema(chatbotAnalytics).omit({\n  id: true,\n  lastAsked: true,\n  count: true,\n});\n\nexport const insertChatbotQuickResponseSchema = createInsertSchema(chatbotQuickResponses).omit({\n  id: true,\n});\n\nexport type ChatbotConversation = typeof chatbotConversations.$inferSelect;\nexport type InsertChatbotConversation = z.infer<typeof insertChatbotConversationSchema>;\nexport type ChatbotMessage = typeof chatbotMessages.$inferSelect;\nexport type InsertChatbotMessage = z.infer<typeof insertChatbotMessageSchema>;\nexport type ChatbotAnalytics = typeof chatbotAnalytics.$inferSelect;\nexport type InsertChatbotAnalytics = z.infer<typeof insertChatbotAnalyticsSchema>;\nexport type ChatbotQuickResponse = typeof chatbotQuickResponses.$inferSelect;\nexport type InsertChatbotQuickResponse = z.infer<typeof insertChatbotQuickResponseSchema>;\n\n// Review & Referral Drip Campaign Schemas\nexport const insertJobCompletionSchema = createInsertSchema(jobCompletions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertReviewRequestSchema = createInsertSchema(reviewRequests).omit({\n  id: true,\n  createdAt: true,\n  completedAt: true,\n});\n\nexport const insertReviewFeedbackSchema = createInsertSchema(reviewFeedback).omit({\n  id: true,\n  submittedAt: true,\n  followedUpAt: true,\n});\n\nexport const insertReferralNurtureCampaignSchema = createInsertSchema(referralNurtureCampaigns).omit({\n  id: true,\n  createdAt: true,\n  pausedAt: true,\n  completedAt: true,\n});\n\nexport const insertReviewEmailTemplateSchema = createInsertSchema(reviewEmailTemplates).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertEmailSendLogSchema = createInsertSchema(emailSendLog).omit({\n  id: true,\n  sentAt: true,\n});\n\nexport const insertEmailSuppressionListSchema = createInsertSchema(emailSuppressionList).omit({\n  id: true,\n  addedAt: true,\n});\n\nexport const insertReferralCreditUsageSchema = createInsertSchema(referralCreditUsage).omit({\n  id: true,\n  processedAt: true,\n});\n\nexport const insertRefereeWelcomeEmailSchema = createInsertSchema(refereeWelcomeEmails).omit({\n  id: true,\n  createdAt: true,\n  sentAt: true,\n});\n\nexport const insertReferrerThankYouEmailSchema = createInsertSchema(referrerThankYouEmails).omit({\n  id: true,\n  createdAt: true,\n  approvedAt: true,\n  sentAt: true,\n});\n\nexport const insertReferrerSuccessEmailSchema = createInsertSchema(referrerSuccessEmails).omit({\n  id: true,\n  createdAt: true,\n  approvedAt: true,\n  sentAt: true,\n});\n\nexport const insertEmailPreferencesSchema = createInsertSchema(emailPreferences).omit({\n  id: true,\n  createdAt: true,\n  lastUpdated: true,\n});\n\nexport const insertPendingReferralSchema = createInsertSchema(pendingReferrals).omit({\n  id: true,\n  capturedAt: true,\n  convertedAt: true,\n});\n\nexport const insertConversionEventSchema = createInsertSchema(conversionEvents).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCustomerSegmentSchema = createInsertSchema(customerSegments).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertSegmentMembershipSchema = createInsertSchema(segmentMembership).omit({\n  id: true,\n  addedAt: true,\n});\n\nexport const insertCustomEmailCampaignSchema = createInsertSchema(customEmailCampaigns).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertCustomCampaignEmailSchema = createInsertSchema(customCampaignEmails).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertCustomCampaignSendLogSchema = createInsertSchema(customCampaignSendLog).omit({\n  id: true,\n  sentAt: true,\n});\n\nexport type JobCompletion = typeof jobCompletions.$inferSelect;\nexport type InsertJobCompletion = z.infer<typeof insertJobCompletionSchema>;\nexport type ReviewRequest = typeof reviewRequests.$inferSelect;\nexport type InsertReviewRequest = z.infer<typeof insertReviewRequestSchema>;\nexport type ReviewFeedback = typeof reviewFeedback.$inferSelect;\nexport type InsertReviewFeedback = z.infer<typeof insertReviewFeedbackSchema>;\nexport type ReferralNurtureCampaign = typeof referralNurtureCampaigns.$inferSelect;\nexport type InsertReferralNurtureCampaign = z.infer<typeof insertReferralNurtureCampaignSchema>;\nexport type ReviewEmailTemplate = typeof reviewEmailTemplates.$inferSelect;\nexport type InsertReviewEmailTemplate = z.infer<typeof insertReviewEmailTemplateSchema>;\nexport type EmailSendLog = typeof emailSendLog.$inferSelect;\nexport type InsertEmailSendLog = z.infer<typeof insertEmailSendLogSchema>;\nexport type EmailSuppressionList = typeof emailSuppressionList.$inferSelect;\nexport type InsertEmailSuppressionList = z.infer<typeof insertEmailSuppressionListSchema>;\nexport type ReferralCreditUsage = typeof referralCreditUsage.$inferSelect;\nexport type InsertReferralCreditUsage = z.infer<typeof insertReferralCreditUsageSchema>;\nexport type RefereeWelcomeEmail = typeof refereeWelcomeEmails.$inferSelect;\nexport type InsertRefereeWelcomeEmail = z.infer<typeof insertRefereeWelcomeEmailSchema>;\nexport type ReferrerThankYouEmail = typeof referrerThankYouEmails.$inferSelect;\nexport type InsertReferrerThankYouEmail = z.infer<typeof insertReferrerThankYouEmailSchema>;\nexport type ReferrerSuccessEmail = typeof referrerSuccessEmails.$inferSelect;\nexport type InsertReferrerSuccessEmail = z.infer<typeof insertReferrerSuccessEmailSchema>;\nexport type EmailPreference = typeof emailPreferences.$inferSelect;\nexport type InsertEmailPreference = z.infer<typeof insertEmailPreferencesSchema>;\nexport type PendingReferral = typeof pendingReferrals.$inferSelect;\nexport type InsertPendingReferral = z.infer<typeof insertPendingReferralSchema>;\nexport type ConversionEvent = typeof conversionEvents.$inferSelect;\nexport type InsertConversionEvent = z.infer<typeof insertConversionEventSchema>;\nexport type CustomerSegment = typeof customerSegments.$inferSelect;\nexport type InsertCustomerSegment = z.infer<typeof insertCustomerSegmentSchema>;\nexport type SegmentMembership = typeof segmentMembership.$inferSelect;\nexport type InsertSegmentMembership = z.infer<typeof insertSegmentMembershipSchema>;\nexport type CustomEmailCampaign = typeof customEmailCampaigns.$inferSelect;\nexport type InsertCustomEmailCampaign = z.infer<typeof insertCustomEmailCampaignSchema>;\nexport type CustomCampaignEmail = typeof customCampaignEmails.$inferSelect;\nexport type InsertCustomCampaignEmail = z.infer<typeof insertCustomCampaignEmailSchema>;\nexport type CustomCampaignSendLog = typeof customCampaignSendLog.$inferSelect;\nexport type InsertCustomCampaignSendLog = z.infer<typeof insertCustomCampaignSendLogSchema>;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2062, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/server/db.ts"],"sourcesContent":["import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,sKAAU,CAAC,oBAAoB,GAAG,2JAAE;AAEpC,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MACR;AAEJ;AAEO,MAAM,OAAO,IAAI,gKAAI,CAAC;IAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAAC;AACnE,MAAM,KAAK,IAAA,2KAAO,EAAC;IAAE,QAAQ;IAAM,QAAA;AAAO","debugId":null}},
    {"offset": {"line": 2091, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/server/lib/serviceTitan.ts"],"sourcesContent":["import type { InsertServiceTitanMembership, InsertServiceTitanCustomer, InsertServiceTitanContact } from \"@shared/schema\";\nimport { db } from \"../db\";\n\ninterface ServiceTitanConfig {\n  clientId: string;\n  clientSecret: string;\n  tenantId: string;\n  appKey: string;\n}\n\ninterface ServiceTitanContact {\n  id: number;\n  type: string;\n  value: string;\n  memo?: string;\n  phoneSettings?: {\n    phoneNumber: string;\n    doNotText: boolean;\n  };\n}\n\ninterface ServiceTitanCustomer {\n  id: number;\n  name?: string;\n  email?: string;\n  phoneNumber?: string;\n  contacts?: ServiceTitanContact[];\n  address?: {\n    street: string;\n    city: string;\n    state: string;\n    zip: string;\n  };\n}\n\ninterface ServiceTitanMembership {\n  id: number;\n  customerId: number;\n  membershipTypeId: number;\n  status: string;\n}\n\ninterface ServiceTitanInvoice {\n  id: number;\n  customerId: number;\n  total: number;\n  status: string;\n}\n\nclass ServiceTitanAPI {\n  private config: ServiceTitanConfig;\n  private baseUrl: string;\n  private accessToken: string | null = null;\n  private tokenExpiry: number = 0;\n\n  constructor(config: ServiceTitanConfig) {\n    this.config = config;\n    this.baseUrl = `https://api.servicetitan.io/crm/v2/tenant/${config.tenantId}`;\n  }\n\n  /**\n   * Authenticate with ServiceTitan OAuth 2.0\n   */\n  private async authenticate(): Promise<void> {\n    if (this.accessToken && Date.now() < this.tokenExpiry) {\n      return; // Token still valid\n    }\n\n    const tokenUrl = 'https://auth.servicetitan.io/connect/token';\n    const credentials = Buffer.from(`${this.config.clientId}:${this.config.clientSecret}`).toString('base64');\n\n    try {\n      const response = await fetch(tokenUrl, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Basic ${credentials}`,\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: 'grant_type=client_credentials',\n      });\n\n      if (!response.ok) {\n        throw new Error(`Authentication failed: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      this.accessToken = data.access_token;\n      this.tokenExpiry = Date.now() + (data.expires_in * 1000) - 60000; // Refresh 1 min before expiry\n    } catch (error) {\n      console.error('[ServiceTitan] Authentication error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Make authenticated API request\n   * @param endpoint - Either a relative endpoint (e.g., \"/customers\") or a full URL\n   * @param options - Fetch options\n   * @param useFullUrl - If true, endpoint is treated as a full URL instead of appending to baseUrl\n   */\n  private async request<T>(endpoint: string, options: RequestInit = {}, useFullUrl: boolean = false): Promise<T> {\n    await this.authenticate();\n\n    const url = useFullUrl ? endpoint : `${this.baseUrl}${endpoint}`;\n    const headers = {\n      'Authorization': `Bearer ${this.accessToken}`,\n      'ST-App-Key': this.config.appKey,\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    console.log('[ServiceTitan] API Request:', {\n      url,\n      method: options.method || 'GET',\n      hasToken: !!this.accessToken,\n      hasAppKey: !!this.config.appKey\n    });\n\n    try {\n      const response = await fetch(url, { ...options, headers });\n\n      console.log('[ServiceTitan] API Response:', {\n        status: response.status,\n        statusText: response.statusText,\n        ok: response.ok\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('[ServiceTitan] API Error Response:', errorText);\n        throw new Error(`ServiceTitan API error: ${response.status} - ${errorText}`);\n      }\n\n      // Read the response body (ServiceTitan uses chunked encoding, so no content-length header)\n      const responseText = await response.text();\n      \n      // Handle empty responses\n      if (!responseText || responseText.trim() === '') {\n        console.log('[ServiceTitan] Empty response body');\n        return {} as T;\n      }\n\n      console.log('[ServiceTitan] Raw response text (first 1000 chars):', responseText.substring(0, 1000));\n      \n      try {\n        const jsonData = JSON.parse(responseText);\n        console.log('[ServiceTitan] Parsed JSON keys:', Object.keys(jsonData));\n        console.log('[ServiceTitan] Has data property:', 'data' in jsonData);\n        console.log('[ServiceTitan] Data length:', Array.isArray(jsonData?.data) ? jsonData.data.length : 'not an array');\n        \n        return jsonData;\n      } catch (parseError) {\n        console.error('[ServiceTitan] JSON parse error:', parseError);\n        console.error('[ServiceTitan] Response text was:', responseText);\n        throw new Error(`Failed to parse ServiceTitan response: ${parseError}`);\n      }\n    } catch (error) {\n      console.error('[ServiceTitan] API request error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Normalize phone number to digits only for comparison\n   */\n  private normalizePhone(phone: string): string {\n    // Remove all non-digits\n    const digits = phone.replace(/\\D/g, '');\n    // Remove leading 1 for US numbers\n    if (digits.length === 11 && digits.startsWith('1')) {\n      return digits.substring(1);\n    }\n    return digits;\n  }\n\n  /**\n   * Search for ALL customers by email or phone via live API (for multi-account support)\n   * Returns array of all matching customers, not just the first one\n   */\n  async searchAllCustomersLive(emailOrPhone: string): Promise<ServiceTitanCustomer[]> {\n    try {\n      const isEmail = emailOrPhone.includes('@');\n      console.log(`[ServiceTitan] Live API search for ALL customers with ${isEmail ? 'email' : 'phone'}: \"${emailOrPhone}\"`);\n      \n      if (isEmail) {\n        // Email search - returns all customers with this email\n        const emailResults = await this.request<{ data: ServiceTitanCustomer[] }>(\n          `/customers?email=${encodeURIComponent(emailOrPhone.trim())}`\n        );\n\n        if (emailResults.data && emailResults.data.length > 0) {\n          console.log(`[ServiceTitan] Found ${emailResults.data.length} customer(s) with email ${emailOrPhone}`);\n          return emailResults.data;\n        }\n      } else {\n        // Phone search - use contacts search API\n        const normalizedPhone = this.normalizePhone(emailOrPhone);\n        console.log(`[ServiceTitan] Searching for phone: ${normalizedPhone}`);\n        \n        try {\n          const contactsSearchUrl = `https://api.servicetitan.io/crm/v2/tenant/${this.config.tenantId}/contacts/search`;\n          const searchResults = await this.request<{ data: any[] }>(\n            contactsSearchUrl,\n            {\n              method: 'POST',\n              body: JSON.stringify({\n                value: normalizedPhone,\n                page: 1,\n                pageSize: 50 // Get up to 50 matching contacts\n              })\n            },\n            true\n          );\n\n          if (searchResults.data && searchResults.data.length > 0) {\n            // Get unique customer IDs\n            const customerIds = Array.from(new Set(searchResults.data.map((c: any) => c.customerId)));\n            console.log(`[ServiceTitan] Found ${customerIds.length} customer(s) with phone ${emailOrPhone}`);\n            \n            // Fetch full customer details for each ID\n            const customers: ServiceTitanCustomer[] = [];\n            for (const customerId of customerIds) {\n              try {\n                const customer = await this.request<ServiceTitanCustomer>(`/customers/${customerId}`);\n                customers.push(customer);\n              } catch (error) {\n                console.error(`[ServiceTitan] Failed to fetch customer ${customerId}:`, error);\n              }\n            }\n            return customers;\n          }\n        } catch (error: any) {\n          console.error('[ServiceTitan] Contacts search error:', error);\n        }\n      }\n      \n      console.log('[ServiceTitan] No customers found via live API');\n      return [];\n    } catch (error) {\n      console.error('[ServiceTitan] Live API search error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Search for customer by email or phone (trying multiple approaches)\n   * Returns FIRST matching customer only\n   */\n  async searchCustomer(email: string, phone: string): Promise<ServiceTitanCustomer | null> {\n    try {\n      console.log(`[ServiceTitan] Searching for customer - email: \"${email}\", phone: \"${phone}\"`);\n      \n      let customerId: number | null = null;\n\n      // Strategy 1: Try email search first if provided (most reliable)\n      if (email && email.trim()) {\n        console.log('[ServiceTitan] Strategy 1: Searching by email...');\n        \n        try {\n          const emailResults = await this.request<{ data: ServiceTitanCustomer[] }>(\n            `/customers?email=${encodeURIComponent(email.trim())}`\n          );\n\n          if (emailResults.data && emailResults.data.length > 0) {\n            console.log(`[ServiceTitan] Found customer by email: ${emailResults.data[0].id}`);\n            return emailResults.data[0];\n          }\n          console.log('[ServiceTitan] No customer found by email');\n        } catch (error: any) {\n          console.error('[ServiceTitan] Email search error:', error.message);\n        }\n      }\n\n      // Strategy 2: Try Contacts Search API for phone (if available)\n      if (!customerId && phone && phone.trim()) {\n        console.log('[ServiceTitan] Strategy 2: Trying Contacts Search API for phone...');\n        \n        const normalizedPhone = this.normalizePhone(phone);\n        console.log(`[ServiceTitan] Normalized phone: \"${normalizedPhone}\"`);\n        \n        try {\n          const contactsSearchUrl = `https://api.servicetitan.io/crm/v2/tenant/${this.config.tenantId}/contacts/search`;\n          const searchResults = await this.request<{ data: any[] }>(\n            contactsSearchUrl,\n            {\n              method: 'POST',\n              body: JSON.stringify({\n                value: normalizedPhone,\n                page: 1,\n                pageSize: 10\n              })\n            },\n            true\n          );\n\n          if (searchResults.data && searchResults.data.length > 0) {\n            customerId = searchResults.data[0].customerId;\n            console.log(`[ServiceTitan] Contacts Search found customerId: ${customerId}`);\n          }\n        } catch (error: any) {\n          console.log('[ServiceTitan] Contacts Search API not available, trying alternative methods...');\n        }\n      }\n\n      // Strategy 3: Optimized pagination search (check first 250 customers in 5 pages)\n      if (!customerId && phone && phone.trim()) {\n        console.log('[ServiceTitan] Strategy 3: Fast pagination search (250 customers max)...');\n        \n        const normalizedPhone = this.normalizePhone(phone);\n        const MAX_PAGES = 5; // Only check 5 pages (250 customers) for speed\n        const PAGE_SIZE = 50;\n        const BATCH_SIZE = 10; // Check 10 customers at a time\n        \n        for (let page = 1; page <= MAX_PAGES; page++) {\n          console.log(`[ServiceTitan] Checking page ${page}/${MAX_PAGES}...`);\n          \n          const pageResults = await this.request<{ data: ServiceTitanCustomer[], hasMore?: boolean }>(\n            `/customers?page=${page}&pageSize=${PAGE_SIZE}`\n          );\n          \n          if (!pageResults.data || pageResults.data.length === 0) {\n            break;\n          }\n\n          // Check customers in batches\n          for (let i = 0; i < pageResults.data.length; i += BATCH_SIZE) {\n            const batch = pageResults.data.slice(i, i + BATCH_SIZE);\n            \n            const results = await Promise.allSettled(\n              batch.map(async (customer) => {\n                try {\n                  const contacts = await this.getCustomerContacts(customer.id);\n                  \n                  for (const contact of contacts) {\n                    const phoneValue = contact.value || contact.phoneSettings?.phoneNumber;\n                    if (phoneValue && (contact.type === 'Phone' || contact.type === 'MobilePhone')) {\n                      if (this.normalizePhone(phoneValue) === normalizedPhone) {\n                        console.log(`[ServiceTitan] MATCH FOUND! Customer ${customer.id} (${customer.name})`);\n                        return customer;\n                      }\n                    }\n                  }\n                  return null;\n                } catch (error) {\n                  return null;\n                }\n              })\n            );\n            \n            // Check for match\n            for (const result of results) {\n              if (result.status === 'fulfilled' && result.value) {\n                return result.value;\n              }\n            }\n          }\n          \n          // Stop if no more pages\n          if (pageResults.hasMore === false || pageResults.data.length < PAGE_SIZE) {\n            break;\n          }\n        }\n        \n        console.log(`[ServiceTitan] No match found in first ${MAX_PAGES * PAGE_SIZE} customers`);\n      }\n\n      // If we found a customer ID from Contacts Search, fetch full details\n      if (customerId) {\n        console.log(`[ServiceTitan] Fetching customer details for ID: ${customerId}`);\n        const customer = await this.request<ServiceTitanCustomer>(`/customers/${customerId}`);\n        return customer;\n      }\n\n      console.log('[ServiceTitan] Customer not found by any method');\n      return null;\n    } catch (error: any) {\n      console.error('[ServiceTitan] Search customer error:', error.message || error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create new customer (residential or commercial)\n   */\n  async createCustomer(data: {\n    type: 'residential' | 'commercial';\n    name?: string;\n    companyName?: string;\n    contactName?: string;\n    email: string;\n    phone: string;\n    street: string;\n    city: string;\n    state: string;\n    zip: string;\n  }): Promise<ServiceTitanCustomer> {\n    const address = {\n      street: data.street,\n      city: data.city,\n      state: data.state,\n      zip: data.zip,\n      country: 'USA',\n    };\n\n    // Create contacts array for customer\n    const customerContacts = [\n      { type: 'Phone', value: data.phone, isPrimary: true },\n      { type: 'Email', value: data.email, isPrimary: true }\n    ];\n\n    // Create location contacts array\n    const locationContacts = [\n      { type: 'Phone', value: data.phone, isPrimary: true },\n      { type: 'Email', value: data.email, isPrimary: true }\n    ];\n\n    // Build the request payload according to ServiceTitan API v2 format\n    const customerData = data.type === 'residential' \n      ? {\n          request: {\n            type: 'Residential',\n            name: data.name,\n            contacts: customerContacts,\n            locations: [{\n              name: 'Primary Residence',\n              address: address,\n              contacts: locationContacts\n            }]\n          }\n        }\n      : {\n          request: {\n            type: 'Commercial',\n            companyName: data.companyName,\n            contacts: customerContacts,\n            locations: [{\n              name: data.companyName || 'Primary Location',\n              address: address,\n              contacts: locationContacts\n            }]\n          }\n        };\n\n    try {\n      const result = await this.request<{ data: ServiceTitanCustomer }>(\n        '/customers',\n        {\n          method: 'POST',\n          body: JSON.stringify(customerData),\n        }\n      );\n\n      return result.data;\n    } catch (error) {\n      console.error('[ServiceTitan] Create customer error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create invoice with membership pricebook item\n   * This creates the membership and activates it for the customer\n   */\n  async createMembershipInvoice(\n    customerId: number, \n    membershipTypeId: number,\n    amount: number\n  ): Promise<ServiceTitanInvoice> {\n    try {\n      const invoiceData = {\n        customerId,\n        items: [{\n          skuId: membershipTypeId, // The membership pricebook item\n          quantity: 1,\n          price: amount,\n        }],\n        // Add other required invoice fields\n      };\n\n      const result = await this.request<{ data: ServiceTitanInvoice }>(\n        '/accounting/v2/invoices',\n        {\n          method: 'POST',\n          body: JSON.stringify(invoiceData),\n        }\n      );\n\n      return result.data;\n    } catch (error) {\n      console.error('[ServiceTitan] Create membership invoice error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Mark invoice as paid\n   */\n  async markInvoicePaid(invoiceId: number, amount: number, paymentMethod: string = 'Credit Card'): Promise<void> {\n    try {\n      await this.request(\n        `/invoices/${invoiceId}/payments`,\n        {\n          method: 'POST',\n          body: JSON.stringify({\n            amount,\n            paymentMethod,\n            status: 'Paid',\n          }),\n        }\n      );\n    } catch (error) {\n      console.error('[ServiceTitan] Mark invoice paid error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Complete membership purchase workflow\n   * 1. Search for customer\n   * 2. Create customer if not found\n   * 3. Create invoice with membership item (activates membership)\n   * 4. Mark invoice as paid\n   */\n  async processMembershipPurchase(\n    purchaseData: InsertServiceTitanMembership\n  ): Promise<{\n    customerId: number;\n    membershipId: number;\n    invoiceId: number;\n  }> {\n    try {\n      // Validate membershipTypeId\n      if (!purchaseData.serviceTitanMembershipTypeId) {\n        throw new Error('ServiceTitan membership type ID is required but missing. Please configure the product with a valid ServiceTitan membership type ID.');\n      }\n      \n      const membershipTypeId = parseInt(purchaseData.serviceTitanMembershipTypeId);\n      if (isNaN(membershipTypeId)) {\n        throw new Error(`Invalid ServiceTitan membership type ID: \"${purchaseData.serviceTitanMembershipTypeId}\". Must be a numeric ID.`);\n      }\n      \n      // Step 1: Search for existing customer\n      let customer = await this.searchCustomer(purchaseData.email, purchaseData.phone);\n\n      // Step 2: Create customer if not found\n      if (!customer) {\n        console.log('[ServiceTitan] Customer not found, creating new customer...');\n        customer = await this.createCustomer({\n          type: purchaseData.customerType as 'residential' | 'commercial',\n          name: purchaseData.customerName || undefined,\n          companyName: purchaseData.companyName || undefined,\n          contactName: purchaseData.contactPersonName || undefined,\n          email: purchaseData.email,\n          phone: purchaseData.phone,\n          street: purchaseData.street,\n          city: purchaseData.city,\n          state: purchaseData.state,\n          zip: purchaseData.zip,\n        });\n        console.log(`[ServiceTitan] Created customer with ID: ${customer.id}`);\n      } else {\n        console.log(`[ServiceTitan] Found existing customer with ID: ${customer.id}`);\n      }\n\n      // Step 3: Create invoice with membership pricebook item\n      // This creates AND activates the membership\n      console.log('[ServiceTitan] Creating membership invoice...');\n      const invoice = await this.createMembershipInvoice(\n        customer.id, \n        membershipTypeId,\n        purchaseData.amount / 100 // Convert cents to dollars\n      );\n      console.log(`[ServiceTitan] Created invoice with ID: ${invoice.id}`);\n\n      // Step 4: Mark invoice as paid\n      console.log('[ServiceTitan] Marking invoice as paid...');\n      await this.markInvoicePaid(invoice.id, purchaseData.amount / 100); // Convert cents to dollars\n      console.log('[ServiceTitan] Invoice marked as paid');\n\n      return {\n        customerId: customer.id,\n        membershipId: invoice.id, // The invoice ID serves as membership reference\n        invoiceId: invoice.id,\n      };\n    } catch (error) {\n      console.error('[ServiceTitan] Process membership purchase error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get customer contacts (phone/email)\n   */\n  async getCustomerContacts(customerId: number): Promise<any[]> {\n    try {\n      const result = await this.request<{ data: any[] }>(\n        `/customers/${customerId}/contacts`\n      );\n      return result.data || [];\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer contacts error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get customer by ID\n   */\n  async getCustomer(customerId: number): Promise<ServiceTitanCustomer> {\n    try {\n      // Customer endpoint returns object directly, not wrapped in {data: ...}\n      const customerData: any = await this.request<any>(\n        `/customers/${customerId}`\n      );\n      \n      // Fetch customer contacts to get phone/email\n      const contacts = await this.getCustomerContacts(customerId);\n      \n      // ServiceTitan returns contacts with type 'Email', 'Phone', 'MobilePhone', etc.\n      // Each contact has a 'value' field with the actual data\n      const emailContact = contacts.find((c: any) => c.type === 'Email');\n      const phoneContact = contacts.find((c: any) => c.type === 'Phone' || c.type === 'MobilePhone') || contacts.find((c: any) => c.phoneSettings);\n      \n      console.log(`[Portal Debug] Customer ${customerId} - Found ${contacts.length} contacts`);\n      console.log(`[Portal Debug] Email contact:`, emailContact?.value || 'NONE');\n      console.log(`[Portal Debug] Phone contact:`, phoneContact?.value || phoneContact?.phoneSettings?.phoneNumber || 'NONE');\n      console.log(`[Portal Debug] Customer record email:`, customerData.email || 'NONE');\n      console.log(`[Portal Debug] Customer record phoneNumber:`, customerData.phoneNumber || 'NONE');\n      \n      // Use contacts first, fall back to customer record fields if contacts are empty\n      const result = {\n        ...customerData,\n        email: emailContact?.value || customerData.email || '',\n        phoneNumber: phoneContact?.value || phoneContact?.phoneSettings?.phoneNumber || customerData.phoneNumber || '',\n        contacts: contacts.map((c: any) => ({\n          id: c.id,\n          type: c.type,\n          value: c.value || c.phoneSettings?.phoneNumber || '',\n          memo: c.memo,\n          phoneSettings: c.phoneSettings\n        }))\n      };\n      \n      console.log(`[Portal Debug] Final email field:`, result.email || 'EMPTY STRING');\n      console.log(`[Portal Debug] Final phoneNumber field:`, result.phoneNumber || 'EMPTY STRING');\n      console.log(`[Portal Debug] Returning ${result.contacts.length} contacts`);\n      \n      return result;\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update customer contact information\n   */\n  async updateCustomerContacts(\n    customerId: number,\n    data: {\n      email?: string;\n      phone?: string;\n    }\n  ): Promise<void> {\n    try {\n      console.log(`[ServiceTitan] Updating customer ${customerId} contacts...`);\n      \n      // Get existing contacts\n      const existingContacts = await this.getCustomerContacts(customerId);\n      \n      // Update or add email contact\n      if (data.email) {\n        const emailContact = existingContacts.find((c: any) => c.type === 'Email');\n        if (emailContact) {\n          // Update existing email\n          await this.request(\n            `/customers/${customerId}/contacts/${emailContact.id}`,\n            {\n              method: 'PUT',\n              body: JSON.stringify({\n                type: 'Email',\n                value: data.email,\n                memo: 'email'\n              }),\n            }\n          );\n        } else {\n          // Create new email contact\n          await this.request(\n            `/customers/${customerId}/contacts`,\n            {\n              method: 'POST',\n              body: JSON.stringify({\n                type: 'Email',\n                value: data.email,\n                memo: 'email'\n              }),\n            }\n          );\n        }\n      }\n      \n      // Update or add phone contact\n      if (data.phone) {\n        const phoneContact = existingContacts.find((c: any) => c.type === 'Phone' || c.type === 'MobilePhone');\n        if (phoneContact) {\n          // Update existing phone\n          await this.request(\n            `/customers/${customerId}/contacts/${phoneContact.id}`,\n            {\n              method: 'PUT',\n              body: JSON.stringify({\n                type: phoneContact.type,\n                value: data.phone,\n                memo: phoneContact.memo || 'Phone',\n                phoneSettings: {\n                  phoneNumber: data.phone,\n                  doNotText: phoneContact.phoneSettings?.doNotText || false\n                }\n              }),\n            }\n          );\n        } else {\n          // Create new phone contact\n          await this.request(\n            `/customers/${customerId}/contacts`,\n            {\n              method: 'POST',\n              body: JSON.stringify({\n                type: 'Phone',\n                value: data.phone,\n                memo: 'Phone',\n                phoneSettings: {\n                  phoneNumber: data.phone,\n                  doNotText: false\n                }\n              }),\n            }\n          );\n        }\n      }\n      \n      console.log('[ServiceTitan] Customer contacts updated successfully');\n    } catch (error) {\n      console.error('[ServiceTitan] Update customer contacts error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete a customer contact by ID\n   */\n  async deleteCustomerContact(customerId: number, contactId: number): Promise<void> {\n    try {\n      console.log(`[ServiceTitan] Deleting contact ${contactId} for customer ${customerId}...`);\n      \n      await this.request(\n        `/customers/${customerId}/contacts/${contactId}`,\n        {\n          method: 'DELETE',\n        }\n      );\n      \n      console.log('[ServiceTitan] Contact deleted successfully');\n    } catch (error) {\n      console.error('[ServiceTitan] Delete contact error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update location address\n   */\n  async updateLocation(\n    locationId: number,\n    data: {\n      street: string;\n      city: string;\n      state: string;\n      zip: string;\n    }\n  ): Promise<void> {\n    try {\n      console.log(`[ServiceTitan] Updating location ${locationId}...`);\n      \n      const address = {\n        street: data.street,\n        city: data.city,\n        state: data.state,\n        zip: data.zip,\n        country: 'USA',\n      };\n      \n      await this.request(\n        `/locations/${locationId}`,\n        {\n          method: 'PUT',\n          body: JSON.stringify({\n            address: address\n          }),\n        }\n      );\n      \n      console.log('[ServiceTitan] Location updated successfully');\n    } catch (error) {\n      console.error('[ServiceTitan] Update location error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get customer's primary location\n   */\n  async getCustomerPrimaryLocation(customerId: number): Promise<any> {\n    try {\n      const locationsUrl = `https://api.servicetitan.io/crm/v2/tenant/${this.config.tenantId}/locations?customerId=${customerId}`;\n      const result = await this.request<{ data: any[] }>(locationsUrl, {}, true);\n      \n      // Return first location (primary)\n      return result.data && result.data.length > 0 ? result.data[0] : null;\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer primary location error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get ALL locations for a customer (not just primary)\n   */\n  async getAllCustomerLocations(customerId: number): Promise<any[]> {\n    try {\n      const locationsUrl = `https://api.servicetitan.io/crm/v2/tenant/${this.config.tenantId}/locations?customerId=${customerId}`;\n      const result = await this.request<{ data: any[] }>(locationsUrl, {}, true);\n      \n      console.log(`[ServiceTitan] Found ${result.data?.length || 0} locations for customer ${customerId}`);\n      \n      // Return all locations\n      return result.data || [];\n    } catch (error) {\n      console.error('[ServiceTitan] Get all customer locations error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get available arrival windows from ServiceTitan\n   * This fetches recent appointments and extracts unique arrival windows\n   */\n  async getArrivalWindows(): Promise<Array<{ start: string; end: string; label: string }>> {\n    try {\n      // Fetch recent appointments to see what windows are being used\n      const jpmUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}/appointments?pageSize=100`;\n      const result = await this.request<{ data: any[] }>(jpmUrl, {}, true);\n      \n      const appointments = result.data || [];\n      \n      // Extract unique arrival windows\n      const windowsMap = new Map<string, { start: string; end: string }>();\n      \n      appointments.forEach((apt: any) => {\n        if (apt.arrivalWindowStart && apt.arrivalWindowEnd) {\n          const startTime = new Date(apt.arrivalWindowStart);\n          const endTime = new Date(apt.arrivalWindowEnd);\n          \n          // Format as HH:MM\n          const startStr = `${startTime.getUTCHours().toString().padStart(2, '0')}:${startTime.getUTCMinutes().toString().padStart(2, '0')}`;\n          const endStr = `${endTime.getUTCHours().toString().padStart(2, '0')}:${endTime.getUTCMinutes().toString().padStart(2, '0')}`;\n          \n          const key = `${startStr}-${endStr}`;\n          if (!windowsMap.has(key)) {\n            windowsMap.set(key, { start: startStr, end: endStr });\n          }\n        }\n      });\n      \n      // Convert to array and sort by start time\n      const windows = Array.from(windowsMap.values()).sort((a, b) => {\n        return a.start.localeCompare(b.start);\n      });\n      \n      // Format with labels\n      return windows.map(w => {\n        const formatTime = (timeStr: string) => {\n          const [hours, minutes] = timeStr.split(':').map(Number);\n          const period = hours >= 12 ? 'PM' : 'AM';\n          const displayHours = hours === 0 ? 12 : hours > 12 ? hours - 12 : hours;\n          return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n        };\n        \n        return {\n          start: w.start,\n          end: w.end,\n          label: `${formatTime(w.start)} - ${formatTime(w.end)}`\n        };\n      });\n    } catch (error) {\n      console.error('[ServiceTitan] Get arrival windows error:', error);\n      // Return default windows if API fails\n      return [\n        { start: \"08:00\", end: \"12:00\", label: \"8:00 AM - 12:00 PM\" },\n        { start: \"12:00\", end: \"16:00\", label: \"12:00 PM - 4:00 PM\" },\n        { start: \"16:00\", end: \"20:00\", label: \"4:00 PM - 8:00 PM\" }\n      ];\n    }\n  }\n\n  /**\n   * Reschedule an appointment\n   */\n  async rescheduleAppointment(appointmentId: number, newStart: string, newEnd: string): Promise<any> {\n    try {\n      const jpmUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}/appointments/${appointmentId}`;\n      \n      const payload = {\n        start: newStart,\n        end: newEnd,\n        arrivalWindowStart: newStart,\n        arrivalWindowEnd: newEnd,\n      };\n\n      console.log(`[ServiceTitan] Rescheduling appointment ${appointmentId} to ${newStart}`);\n      \n      const result = await this.request<{ data: any }>(jpmUrl, {\n        method: 'PUT',\n        body: JSON.stringify(payload),\n      }, true);\n\n      console.log('[ServiceTitan] Appointment rescheduled successfully');\n      return result.data;\n    } catch (error) {\n      console.error('[ServiceTitan] Reschedule appointment error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get customer appointments (actual scheduled visits)\n   */\n  async getCustomerAppointments(customerId: number): Promise<any[]> {\n    try {\n      // First, get all jobs for this customer\n      const jpmUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}/jobs?customerId=${customerId}&pageSize=50`;\n      const jobsResult = await this.request<{ data: any[] }>(jpmUrl, {}, true);\n      \n      const jobs = jobsResult.data || [];\n      \n      // Then fetch appointments for each job\n      const appointmentPromises = jobs.map(async (job: any) => {\n        try {\n          if (!job.firstAppointmentId && !job.lastAppointmentId) {\n            return [];\n          }\n          \n          // Try to fetch appointments from the appointments API\n          const appointmentsUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}/appointments?jobId=${job.id}&pageSize=50`;\n          const appointmentsResult = await this.request<{ data: any[] }>(appointmentsUrl, {}, true);\n          \n          return (appointmentsResult.data || []).map((apt: any) => ({\n            id: apt.id,\n            start: apt.start || apt.scheduledOn || apt.arrivalWindowStart,\n            end: apt.end || apt.arrivalWindowEnd,\n            status: apt.appointmentStatus || apt.status || 'Scheduled',\n            arrivalWindowStart: apt.arrivalWindowStart,\n            arrivalWindowEnd: apt.arrivalWindowEnd,\n            jobType: job.jobType || 'Service Call',\n            jobNumber: job.jobNumber,\n            summary: job.summary || apt.summary || `Appointment for Job #${job.jobNumber}`,\n          }));\n        } catch (error) {\n          // If appointments API fails, fall back to job data\n          console.log(`[ServiceTitan] Could not fetch appointments for job ${job.id}, using job data`);\n          return [{\n            id: job.id,\n            start: job.createdOn,\n            end: job.completedOn,\n            status: job.jobStatus || 'Unknown',\n            arrivalWindowStart: null,\n            arrivalWindowEnd: null,\n            jobType: 'Service Call',\n            jobNumber: job.jobNumber,\n            summary: job.summary || `Job #${job.jobNumber}`,\n          }];\n        }\n      });\n      \n      const allAppointments = await Promise.all(appointmentPromises);\n      return allAppointments.flat();\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer appointments error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get customer invoices\n   */\n  async getCustomerInvoices(customerId: number): Promise<any[]> {\n    try {\n      // Use accounting API for invoices\n      const accountingUrl = `https://api.servicetitan.io/accounting/v2/tenant/${this.config.tenantId}/invoices?customerId=${customerId}&pageSize=50`;\n      const result = await this.request<{ data: any[] }>(accountingUrl, {}, true);\n      \n      console.log('[ServiceTitan] Invoices response structure:', JSON.stringify(result, null, 2).substring(0, 500));\n      \n      // Map invoices to display format based on actual ServiceTitan response\n      const invoices = result.data || [];\n      return invoices.map((invoice: any) => ({\n        id: invoice.id,\n        invoiceNumber: invoice.referenceNumber || invoice.id?.toString(),\n        total: parseFloat(invoice.total || '0'),\n        balance: parseFloat(invoice.balance || '0'),\n        status: invoice.balance === '0.00' || invoice.balance === 0 ? 'Paid' : 'Outstanding',\n        createdOn: invoice.invoiceDate || invoice.createdOn,\n        dueDate: invoice.dueDate || null,\n        jobNumber: invoice.referenceNumber || null,\n        summary: invoice.summary || `Invoice #${invoice.referenceNumber || invoice.id}`,\n      }));\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer invoices error:', error);\n      // Return empty array on error rather than throwing\n      return [];\n    }\n  }\n\n  /**\n   * Get customer memberships (VIP status, active memberships)\n   */\n  async getCustomerMemberships(customerId: number): Promise<any[]> {\n    try {\n      // ServiceTitan memberships API endpoint \n      // Using the correct /memberships endpoint with customerIds parameter\n      const membershipsUrl = `https://api.servicetitan.io/memberships/v2/tenant/${this.config.tenantId}/memberships?customerIds=${customerId}&active=Any&pageSize=50`;\n      const result = await this.request<{ data: any[] }>(membershipsUrl, {}, true);\n      \n      console.log('[ServiceTitan] Memberships API response:', {\n        totalCount: result.data?.length || 0,\n        memberships: result.data?.map((m: any) => ({\n          id: m.id,\n          status: m.status,\n          name: m.name,\n          duration: m.duration,\n          billingFrequency: m.billingFrequency,\n          createdOn: m.createdOn,\n          modifiedOn: m.modifiedOn,\n          active: m.active\n        })) || []\n      });\n      \n      // Map memberships to display format\n      const memberships = result.data || [];\n      \n      // Filter OUT deleted memberships (but keep expired/suspended ones to show history)\n      const displayableMemberships = memberships.filter((m: any) => {\n        // Skip if missing required fields\n        if (!m.name && !m.id) return false;\n        \n        // Skip deleted memberships\n        const status = (m.status || '').toLowerCase();\n        if (status === 'deleted') return false;\n        \n        return true;\n      });\n      \n      console.log('[ServiceTitan] Filtered memberships (excluding canceled):', {\n        inputCount: memberships.length,\n        displayableCount: displayableMemberships.length,\n        memberships: displayableMemberships.map((m: any) => ({\n          name: m.membershipName,\n          status: m.status,\n          expiresOn: m.to || m.expirationDate,\n          canceledOn: m.canceledOn\n        }))\n      });\n      \n      // Group by membership to avoid duplicates\n      const uniqueMemberships = new Map();\n      displayableMemberships.forEach((membership: any) => {\n        const key = membership.id;\n        \n        // Map membership status - using the actual API status values\n        // Values from API docs: Active, Suspended, Expired, Canceled, Deleted\n        const status = membership.status || 'Unknown';\n        const isActive = status === 'Active';\n        const isExpired = status === 'Expired';\n        \n        // Use duration to determine if it has an expiration\n        // duration = null means ongoing/no expiration\n        const hasExpiration = membership.duration !== null && membership.duration !== undefined;\n        \n        uniqueMemberships.set(key, {\n          id: membership.id,\n          membershipType: membership.name || 'VIP Membership',\n          status: status,\n          isExpired: isExpired || status === 'Canceled',\n          startDate: membership.createdOn,\n          expirationDate: hasExpiration ? membership.expirationDate : null,\n          renewalDate: membership.renewalDate,\n          balance: 0, // These fields may not exist in the new API\n          totalValue: 0,\n          description: membership.description || '',\n          rawStatus: membership.status,\n          billingFrequency: membership.billingFrequency,\n          duration: membership.duration,\n          active: membership.active\n        });\n      });\n      \n      return Array.from(uniqueMemberships.values());\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer memberships error:', error);\n      // Return empty array on error rather than throwing\n      return [];\n    }\n  }\n\n  /**\n   * Get customer estimates (open quotes/proposals) with full pricebook item details\n   */\n  async getCustomerEstimates(customerId: number): Promise<any[]> {\n    try {\n      // ServiceTitan Sales & Estimates API endpoint\n      const salesUrl = `https://api.servicetitan.io/sales/v2/tenant/${this.config.tenantId}/estimates?customerId=${customerId}&pageSize=50`;\n      const result = await this.request<{ data: any[] }>(salesUrl, {}, true);\n      \n      console.log('[ServiceTitan] Estimates API response received:', {\n        totalCount: result.data?.length || 0,\n        statuses: result.data?.map((e: any) => ({ id: e.id, status: e.status, soldOn: e.soldOn })) || []\n      });\n      \n      // Map estimates to display format\n      const estimates = result.data || [];\n      \n      // Filter for UNSOLD estimates only (where soldOn is null/empty)\n      const unsoldEstimates = estimates.filter((e: any) => !e.soldOn);\n      console.log(`[ServiceTitan] Filtered to ${unsoldEstimates.length} unsold estimates from ${estimates.length} total`);\n      \n      // Create memoization cache for pricebook items to avoid duplicate API calls\n      const pricebookCache = new Map<string, any>();\n      \n      // Enhance each estimate with pricebook item details\n      const enhancedEstimates = await Promise.all(\n        unsoldEstimates.map(async (estimate: any) => {\n          const items = estimate.items || [];\n          \n          // Fetch pricebook details for each item\n          const enhancedItems = await Promise.all(\n            items.map(async (item: any) => {\n              let pricebookDetails = null;\n              \n              try {\n                // Determine item type and fetch details (with memoization)\n                // ServiceTitan estimates typically have serviceId, materialId, or equipmentId\n                let cacheKey = '';\n                \n                if (item.serviceId || item.skuId) {\n                  const id = item.serviceId || item.skuId;\n                  cacheKey = `service-${id}`;\n                  \n                  if (!pricebookCache.has(cacheKey)) {\n                    const details = await this.getPricebookService(id);\n                    pricebookCache.set(cacheKey, details);\n                  }\n                  pricebookDetails = pricebookCache.get(cacheKey);\n                  \n                } else if (item.materialId) {\n                  cacheKey = `material-${item.materialId}`;\n                  \n                  if (!pricebookCache.has(cacheKey)) {\n                    const details = await this.getPricebookMaterial(item.materialId);\n                    pricebookCache.set(cacheKey, details);\n                  }\n                  pricebookDetails = pricebookCache.get(cacheKey);\n                  \n                } else if (item.equipmentId) {\n                  cacheKey = `equipment-${item.equipmentId}`;\n                  \n                  if (!pricebookCache.has(cacheKey)) {\n                    const details = await this.getPricebookEquipment(item.equipmentId);\n                    pricebookCache.set(cacheKey, details);\n                  }\n                  pricebookDetails = pricebookCache.get(cacheKey);\n                }\n              } catch (error) {\n                // Log but don't fail - missing pricebook details shouldn't break the estimate\n                console.error('[ServiceTitan] Error fetching pricebook details for item:', item, error);\n                pricebookDetails = null;\n              }\n              \n              return {\n                ...item,\n                quantity: item.qty || 1,\n                unitRate: item.unitRate || 0,\n                total: item.total || 0,\n                description: item.description || '',\n                pricebookDetails, // Add full pricebook data (name, description, imageUrl, etc.) or null if failed\n              };\n            })\n          );\n          \n          // Calculate expiration status\n          const createdDate = new Date(estimate.createdOn || estimate.createdDate);\n          const expiresDate = estimate.expiresOn || estimate.expirationDate \n            ? new Date(estimate.expiresOn || estimate.expirationDate)\n            : new Date(createdDate.getTime() + (30 * 24 * 60 * 60 * 1000)); // 30 days from creation\n          \n          const now = new Date();\n          const daysUntilExpiration = Math.ceil((expiresDate.getTime() - now.getTime()) / (24 * 60 * 60 * 1000));\n          \n          let expirationStatus = 'valid';\n          if (daysUntilExpiration < 0) {\n            expirationStatus = 'expired';\n          } else if (daysUntilExpiration <= 7) {\n            expirationStatus = 'expiring_soon';\n          }\n          \n          return {\n            id: estimate.id,\n            estimateNumber: estimate.number || estimate.estimateNumber || estimate.id?.toString(),\n            total: parseFloat(estimate.total || estimate.subtotal || '0'),\n            // Status is an object with { id, name } - extract the name string\n            status: typeof estimate.status === 'object' && estimate.status?.name \n              ? estimate.status.name \n              : (estimate.status || 'Open'),\n            createdOn: estimate.createdOn || estimate.createdDate,\n            expiresOn: expiresDate.toISOString(),\n            expirationStatus,\n            daysUntilExpiration,\n            jobId: estimate.jobId,\n            jobNumber: estimate.job?.jobNumber || null,\n            summary: estimate.name || estimate.summary || `Estimate #${estimate.number || estimate.id}`,\n            items: enhancedItems,\n          };\n        })\n      );\n      \n      return enhancedEstimates;\n    } catch (error) {\n      console.error('[ServiceTitan] Get customer estimates error:', error);\n      // Return empty array on error rather than throwing\n      return [];\n    }\n  }\n\n  /**\n   * Get pricebook service details by ID\n   */\n  async getPricebookService(serviceId: number): Promise<any> {\n    try {\n      const serviceUrl = `https://api.servicetitan.io/pricebook/v2/tenant/${this.config.tenantId}/services/${serviceId}`;\n      const result = await this.request<any>(serviceUrl, {}, true);\n      \n      return {\n        id: result.id,\n        name: result.name || result.displayName,\n        description: result.description,\n        price: parseFloat(result.price || '0'),\n        imageUrl: result.imageUrl || result.image || null,\n        category: result.category || result.categoryName,\n        type: 'service',\n      };\n    } catch (error) {\n      console.error(`[ServiceTitan] Error fetching pricebook service ${serviceId}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Get pricebook material details by ID\n   */\n  async getPricebookMaterial(materialId: number): Promise<any> {\n    try {\n      const materialUrl = `https://api.servicetitan.io/pricebook/v2/tenant/${this.config.tenantId}/materials/${materialId}`;\n      const result = await this.request<any>(materialUrl, {}, true);\n      \n      return {\n        id: result.id,\n        name: result.name || result.displayName,\n        description: result.description,\n        price: parseFloat(result.price || result.cost || '0'),\n        imageUrl: result.imageUrl || result.image || null,\n        category: result.category || result.categoryName,\n        type: 'material',\n      };\n    } catch (error) {\n      console.error(`[ServiceTitan] Error fetching pricebook material ${materialId}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Get pricebook equipment details by ID\n   */\n  async getPricebookEquipment(equipmentId: number): Promise<any> {\n    try {\n      const equipmentUrl = `https://api.servicetitan.io/pricebook/v2/tenant/${this.config.tenantId}/equipment/${equipmentId}`;\n      const result = await this.request<any>(equipmentUrl, {}, true);\n      \n      return {\n        id: result.id,\n        name: result.name || result.displayName,\n        description: result.description,\n        price: parseFloat(result.price || result.cost || '0'),\n        imageUrl: result.imageUrl || result.image || null,\n        category: result.category || result.categoryName,\n        type: 'equipment',\n      };\n    } catch (error) {\n      console.error(`[ServiceTitan] Error fetching pricebook equipment ${equipmentId}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Get pricebook item image URL\n   */\n  async getPricebookItemImage(imagePath: string): Promise<string | null> {\n    try {\n      if (!imagePath) return null;\n      \n      // ServiceTitan pricebook images endpoint\n      const imageUrl = `https://api.servicetitan.io/pricebook/v2/tenant/${this.config.tenantId}/images?path=${encodeURIComponent(imagePath)}`;\n      \n      // Return the full URL - frontend can fetch the image directly with auth headers\n      return imageUrl;\n    } catch (error) {\n      console.error(`[ServiceTitan] Error getting pricebook image ${imagePath}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Sync all customers from ServiceTitan to local database\n   * Paginates through all customers and stores them with normalized contacts\n   */\n  async syncAllCustomers(): Promise<{ customersCount: number; contactsCount: number; duration: number }> {\n    const startTime = Date.now();\n    console.log('[ServiceTitan Sync] Starting full customer sync...');\n    \n    try {\n      const { customersXlsx, contactsXlsx } = await import('@shared/schema');\n      const { eq } = await import('drizzle-orm');\n      \n      let page = 1;\n      let hasMore = true;\n      let totalCustomers = 0;\n      let totalContacts = 0;\n      let customersWithJobs = 0;\n      const pageSize = 200; // Increased from 50 to reduce API calls\n\n      // Use upsert strategy - no deletion, just update existing records\n      console.log('[ServiceTitan Sync] Using upsert strategy for zero-downtime sync...');\n      console.log('[ServiceTitan Sync] Will also fetch job counts for each customer...');\n\n      while (hasMore) {\n        console.log(`[ServiceTitan Sync] Fetching page ${page}...`);\n        \n        // Fetch customers page (use relative endpoint, request() will prepend baseUrl)\n        const result = await this.request<{ data: any[]; hasMore: boolean }>(`/customers?page=${page}&pageSize=${pageSize}`);\n        \n        const customers = result.data || [];\n        hasMore = result.hasMore || false;\n        \n        if (customers.length === 0) {\n          break;\n        }\n\n        // Process each customer\n        let customersWithJobs = 0;\n        let totalJobsProcessed = 0;\n        let highValueCustomers: { id: number; name: string; jobCount: number }[] = [];\n        let skippedInactive = 0;\n        \n        for (let idx = 0; idx < customers.length; idx++) {\n          const customer = customers[idx];\n          \n          // SKIP INACTIVE/DEACTIVATED CUSTOMERS - only sync active customers\n          if (customer.active === false) {\n            skippedInactive++;\n            continue;\n          }\n          \n          // Show progress every 10 customers\n          if ((idx + 1) % 10 === 0) {\n            console.log(`[ServiceTitan Sync] Processing customer ${idx + 1}/${customers.length}...`);\n          }\n          \n          try {\n            // Fetch ALL jobs for this customer to get accurate count\n            let jobCount = 0;\n            try {\n              // Jobs API uses different base path (jpm/v2 instead of crm/v2)\n              const jobsBaseUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}`;\n              let page = 1;\n              let hasMore = true;\n              const pageSize = 100; // ServiceTitan max page size\n              \n              while (hasMore) {\n                const response = await fetch(\n                  `${jobsBaseUrl}/jobs?customerId=${customer.id}&jobStatus=Completed&page=${page}&pageSize=${pageSize}`,\n                  {\n                    headers: {\n                      'Authorization': `Bearer ${this.accessToken}`,\n                      'ST-App-Key': this.config.appKey,\n                      'Content-Type': 'application/json',\n                    },\n                  }\n                );\n                \n                if (response.ok) {\n                  const jobsResult = await response.json();\n                  \n                  if (jobsResult.data && jobsResult.data.length > 0) {\n                    jobCount += jobsResult.data.length;\n                  }\n                  \n                  // Continue pagination if there are more pages\n                  hasMore = jobsResult.hasMore || false;\n                  page++;\n                  \n                  // Safety check to prevent infinite loops\n                  if (page > 50) { // Max 5000 jobs per customer (50 pages * 100)\n                    console.log(`[ServiceTitan Sync] âš ï¸ Customer ${customer.id} has over 5000 jobs, stopping pagination`);\n                    break;\n                  }\n                } else {\n                  // Stop on any error\n                  hasMore = false;\n                }\n              }\n              \n              // Track statistics\n              if (jobCount > 0) {\n                customersWithJobs++;\n                totalJobsProcessed += jobCount;\n              }\n              \n              // Log progress for customers with many jobs\n              if (jobCount > 100) {\n                console.log(`[ServiceTitan Sync] ðŸŒŸ High-value customer: ${customer.name} (ID: ${customer.id}) - ${jobCount} completed jobs`);\n                highValueCustomers.push({ id: customer.id, name: customer.name || 'Unknown', jobCount });\n              }\n              \n            } catch (jobError) {\n              // Silently continue with jobCount = 0 - don't log to avoid flooding logs\n              // Jobs API might not have data for all customers\n            }\n\n            // Insert customer with job count\n            await db.insert(customersXlsx).values({\n              id: customer.id,\n              name: customer.name || 'Unknown',\n              type: customer.type || 'Residential',\n              street: customer.address?.street || null,\n              city: customer.address?.city || null,\n              state: customer.address?.state || null,\n              zip: customer.address?.zip || null,\n              active: customer.active ?? true,\n              balance: customer.balance?.toString() || '0.00',\n              jobCount: jobCount,\n            }).onConflictDoUpdate({\n              target: customersXlsx.id,\n              set: {\n                name: customer.name || 'Unknown',\n                type: customer.type || 'Residential',\n                street: customer.address?.street || null,\n                city: customer.address?.city || null,\n                state: customer.address?.state || null,\n                zip: customer.address?.zip || null,\n                active: customer.active ?? true,\n                balance: customer.balance?.toString() || '0.00',\n                jobCount: jobCount,\n                lastSyncedAt: new Date(),\n              },\n            });\n            \n            totalCustomers++;\n            if (jobCount > 0) {\n              customersWithJobs++;\n            }\n\n            // Clean up old contacts for this customer before syncing new ones\n            // This ensures we don't have stale contacts if they were removed in ServiceTitan\n            await db.delete(contactsXlsx).where(eq(contactsXlsx.customerId, customer.id));\n\n            // Fetch and store customer contacts\n            const contacts = await this.getCustomerContacts(customer.id);\n            \n            for (const contact of contacts) {\n              const contactType = contact.type || 'Unknown';\n              const value = contact.value || contact.phoneNumber || contact.email || '';\n              \n              if (!value) continue;\n\n              // Normalize based on type\n              let normalizedValue = '';\n              if (contactType.toLowerCase().includes('phone') || contactType.toLowerCase().includes('mobile')) {\n                normalizedValue = normalizePhone(value);\n              } else if (contactType.toLowerCase().includes('email')) {\n                normalizedValue = normalizeEmail(value);\n              } else {\n                normalizedValue = value.toLowerCase().trim();\n              }\n\n              if (normalizedValue) {\n                await db.insert(contactsXlsx).values({\n                  customerId: customer.id,\n                  contactType,\n                  value,\n                  normalizedValue,\n                  isPrimary: false, // ServiceTitan doesn't expose primary flag clearly\n                }).onConflictDoNothing();\n                \n                totalContacts++;\n              }\n            }\n          } catch (error) {\n            console.error(`[ServiceTitan Sync] Error processing customer ${customer.id}:`, error);\n            // Continue with next customer\n          }\n        }\n\n        // Log page summary if we found high-value customers or skipped inactive\n        if (highValueCustomers.length > 0 || skippedInactive > 0) {\n          console.log(`[ServiceTitan Sync] Page ${page - 1} Summary:`);\n          console.log(`  - Customers with jobs: ${customersWithJobs}/${customers.length}`);\n          console.log(`  - Total jobs counted: ${totalJobsProcessed}`);\n          console.log(`  - High-value customers (100+ jobs): ${highValueCustomers.length}`);\n          if (skippedInactive > 0) {\n            console.log(`  - Skipped inactive/deactivated: ${skippedInactive}`);\n          }\n          \n          // Show top 3 high-value customers from this page\n          const topCustomers = highValueCustomers.slice(0, 3);\n          topCustomers.forEach(c => {\n            console.log(`    â€¢ ${c.name}: ${c.jobCount} jobs`);\n          });\n        }\n        \n        page++;\n        \n        // Update heartbeat to prevent stale lock detection\n        const { updateSyncHeartbeat } = await import('./serviceTitanSync');\n        updateSyncHeartbeat();\n        \n        // Log progress every 10 pages\n        if (page % 10 === 0) {\n          console.log(`[ServiceTitan Sync] Progress: ${totalCustomers} customers, ${totalContacts} contacts, ${customersWithJobs} with jobs`);\n        }\n      }\n\n      const duration = Date.now() - startTime;\n      console.log(`[ServiceTitan Sync] âœ… Completed! ${totalCustomers} customers, ${totalContacts} contacts in ${(duration / 1000).toFixed(1)}s`);\n      console.log(`[ServiceTitan Sync] ðŸ“Š ${customersWithJobs} customers have completed jobs`);\n      \n      return { customersCount: totalCustomers, contactsCount: totalContacts, duration };\n    } catch (error) {\n      console.error('[ServiceTitan Sync] Failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Search for ALL customer IDs by phone or email in local cache\n   * Returns array of customer IDs (supports multiple accounts per email/phone)\n   */\n  async searchLocalCustomer(phoneOrEmail: string): Promise<number[]> {\n    try {\n      const { contactsXlsx } = await import('@shared/schema');\n      const { eq, or, sql } = await import('drizzle-orm');\n      \n      // Normalize input\n      const normalized = phoneOrEmail.includes('@') \n        ? normalizeEmail(phoneOrEmail)\n        : normalizePhone(phoneOrEmail);\n      \n      if (!normalized) return [];\n\n      // Search in contacts - get ALL matching customer IDs\n      // Handle both exact matches and comma-separated values (e.g., \"email1, email2, email3\")\n      const results = await db\n        .select({ customerId: contactsXlsx.customerId })\n        .from(contactsXlsx)\n        .where(or(\n          eq(contactsXlsx.normalizedValue, normalized),\n          sql`${contactsXlsx.normalizedValue} LIKE ${'%' + normalized + '%'}`\n        ));\n\n      // Return unique customer IDs\n      const uniqueCustomerIds = Array.from(new Set(results.map(r => r.customerId)));\n      return uniqueCustomerIds;\n    } catch (error) {\n      console.error('[ServiceTitan] Local search error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Search for ALL customers matching phone or email (for multi-account support)\n   * Returns array of customer IDs with full customer details\n   */\n  async searchAllMatchingCustomers(phoneOrEmail: string): Promise<Array<{\n    id: number;\n    name: string;\n    type: string;\n    email?: string;\n    phone?: string;\n    mobilePhone?: string;\n    address?: string;\n  }>> {\n    try {\n      const { contactsXlsx, customersXlsx } = await import('@shared/schema');\n      const { eq, or, sql, inArray } = await import('drizzle-orm');\n      \n      // Normalize input\n      const normalized = phoneOrEmail.includes('@') \n        ? normalizeEmail(phoneOrEmail)\n        : normalizePhone(phoneOrEmail);\n      \n      if (!normalized) return [];\n\n      // Find all matching contact records\n      // Handle both exact matches and comma-separated values\n      const contactResults = await db\n        .select({ customerId: contactsXlsx.customerId })\n        .from(contactsXlsx)\n        .where(or(\n          eq(contactsXlsx.normalizedValue, normalized),\n          sql`${contactsXlsx.normalizedValue} LIKE ${'%' + normalized + '%'}`\n        ));\n\n      if (contactResults.length === 0) {\n        console.log('[ServiceTitan] No matching customers in cache');\n        return [];\n      }\n\n      // Get unique customer IDs\n      const customerIds = Array.from(new Set(contactResults.map(c => c.customerId)));\n      console.log(`[ServiceTitan] Found ${customerIds.length} matching customer(s) in cache`);\n\n      // Fetch full customer details\n      const customers = await db\n        .select()\n        .from(customersXlsx)\n        .where(inArray(customersXlsx.id, customerIds));\n\n      return customers.map(c => ({\n        id: c.id,\n        name: c.name || 'Unknown',\n        type: c.type || 'Residential',\n        email: c.email || undefined,\n        phone: c.phone || undefined,\n        mobilePhone: c.mobilePhone || undefined,\n        address: [c.street, c.city, c.state, c.zip].filter(Boolean).join(', ')\n      }));\n    } catch (error) {\n      console.error('[ServiceTitan] Search all matching customers error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Search with fallback: Try local cache first, then live API\n   * Caches result on-demand if found via live API\n   * Returns first matching customer ID (for backwards compatibility)\n   */\n  async searchCustomerWithFallback(phoneOrEmail: string): Promise<number | null> {\n    // Try local cache first (instant)\n    const cachedCustomerIds = await this.searchLocalCustomer(phoneOrEmail);\n    if (cachedCustomerIds.length > 0) {\n      console.log(`[ServiceTitan] âœ… Found ${cachedCustomerIds.length} customer(s) in local cache, returning first`);\n      return cachedCustomerIds[0];\n    }\n\n    // Fallback to live API search (slower)\n    console.log('[ServiceTitan] ðŸ”„ Not in cache, searching live API...');\n    \n    // Detect if input is email or phone and pass correct parameters\n    const isEmail = phoneOrEmail.includes('@');\n    const email = isEmail ? phoneOrEmail : '';\n    const phone = isEmail ? '' : phoneOrEmail;\n    \n    console.log(`[ServiceTitan] Searching with ${isEmail ? 'email' : 'phone'}: \"${phoneOrEmail}\"`);\n    const liveCustomer = await this.searchCustomer(email, phone);\n    \n    if (liveCustomer) {\n      console.log(`[ServiceTitan] âœ… Found customer ${liveCustomer.id} via live API, caching...`);\n      \n      // Cache on-demand\n      try {\n        const { customersXlsx, contactsXlsx } = await import('@shared/schema');\n        \n        // Store customer WITH email and phone from the customer record\n        await db.insert(customersXlsx).values({\n          id: liveCustomer.id,\n          name: liveCustomer.name || 'Unknown',\n          type: (liveCustomer as any).type || 'Residential',\n          email: liveCustomer.email || null,\n          phone: liveCustomer.phoneNumber || null,\n          street: liveCustomer.address?.street || null,\n          city: liveCustomer.address?.city || null,\n          state: liveCustomer.address?.state || null,\n          zip: liveCustomer.address?.zip || null,\n          active: true,\n          balance: '0.00',\n        }).onConflictDoUpdate({\n          target: customersXlsx.id,\n          set: { \n            email: liveCustomer.email || null,\n            phone: liveCustomer.phoneNumber || null,\n            lastSyncedAt: new Date() \n          },\n        });\n\n        // Store contacts from ServiceTitan contacts API\n        const contacts = await this.getCustomerContacts(liveCustomer.id);\n        for (const contact of contacts) {\n          const contactType = contact.type || 'Unknown';\n          const value = contact.value || contact.phoneNumber || contact.email || '';\n          \n          if (!value) continue;\n\n          let normalizedValue = '';\n          if (contactType.toLowerCase().includes('phone') || contactType.toLowerCase().includes('mobile')) {\n            normalizedValue = normalizePhone(value);\n          } else if (contactType.toLowerCase().includes('email')) {\n            normalizedValue = normalizeEmail(value);\n          } else {\n            normalizedValue = value.toLowerCase().trim();\n          }\n\n          if (normalizedValue) {\n            await db.insert(contactsXlsx).values({\n              customerId: liveCustomer.id,\n              contactType,\n              value,\n              normalizedValue,\n              isPrimary: false,\n            }).onConflictDoNothing();\n          }\n        }\n        \n        // ALSO store email/phone from customer record as contacts for searchability\n        // This handles customers who have email/phone on the customer record but no contacts list\n        if (liveCustomer.email) {\n          const emailNormalized = normalizeEmail(liveCustomer.email);\n          if (emailNormalized) {\n            await db.insert(contactsXlsx).values({\n              customerId: liveCustomer.id,\n              contactType: 'Email',\n              value: liveCustomer.email,\n              normalizedValue: emailNormalized,\n              isPrimary: true,\n            }).onConflictDoNothing();\n          }\n        }\n        \n        if (liveCustomer.phoneNumber) {\n          const phoneNormalized = normalizePhone(liveCustomer.phoneNumber);\n          if (phoneNormalized) {\n            await db.insert(contactsXlsx).values({\n              customerId: liveCustomer.id,\n              contactType: 'Phone',\n              value: liveCustomer.phoneNumber,\n              normalizedValue: phoneNormalized,\n              isPrimary: true,\n            }).onConflictDoNothing();\n          }\n        }\n        \n        console.log(`[ServiceTitan] âœ… Cached customer ${liveCustomer.id} with ${contacts.length} contacts from API + customer record email/phone`);\n      } catch (error) {\n        console.error('[ServiceTitan] Failed to cache customer:', error);\n        // Non-fatal, customer was still found\n      }\n      \n      return liveCustomer.id;\n    }\n\n    console.log('[ServiceTitan] âŒ Customer not found in cache or live API');\n    return null;\n  }\n\n  /**\n   * Search for completed jobs for a customer after a specific date\n   * Used to detect when a referred customer has their first qualifying job\n   */\n  async getCustomerJobs(customerId: number, completedAfter?: Date): Promise<{\n    id: number;\n    jobNumber: string;\n    customerId: number;\n    completedOn: string | null;\n    total: number;\n    status: string;\n  }[]> {\n    try {\n      // ServiceTitan Jobs API uses a different base URL\n      const jobsBaseUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}`;\n      \n      let endpoint = `${jobsBaseUrl}/jobs?customerId=${customerId}`;\n      \n      // Add date filter if provided\n      if (completedAfter) {\n        const dateStr = completedAfter.toISOString().split('T')[0]; // YYYY-MM-DD format\n        endpoint += `&completedOnOrAfter=${dateStr}`;\n      }\n\n      console.log('[ServiceTitan] Fetching jobs for customer', customerId, 'after', completedAfter);\n      \n      const response = await this.request<{\n        data: Array<{\n          id: number;\n          jobNumber: string;\n          customerId: number;\n          completedOn?: string;\n          total: number;\n          jobStatus: string;\n        }>;\n      }>(endpoint, {}, true);\n\n      return response.data.map(job => ({\n        id: job.id,\n        jobNumber: job.jobNumber,\n        customerId: job.customerId,\n        completedOn: job.completedOn || null,\n        total: job.total,\n        status: job.jobStatus\n      }));\n    } catch (error) {\n      console.error('[ServiceTitan] Error fetching customer jobs:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a customer credit adjustment (for referral rewards)\n   * Uses ServiceTitan Accounting API to issue credit to customer account\n   */\n  async createCustomerCredit(customerId: number, amount: number, memo: string): Promise<{\n    id: number;\n    customerId: number;\n    amount: number;\n    memo: string;\n  }> {\n    try {\n      // ServiceTitan Accounting API uses a different base URL\n      const accountingBaseUrl = `https://api.servicetitan.io/accounting/v2/tenant/${this.config.tenantId}`;\n      const endpoint = `${accountingBaseUrl}/customer-adjustments`;\n\n      console.log('[ServiceTitan] Creating customer credit:', {\n        customerId,\n        amount,\n        memo\n      });\n\n      const response = await this.request<{\n        id: number;\n        customerId: number;\n        amount: number;\n        memo: string;\n      }>(endpoint, {\n        method: 'POST',\n        body: JSON.stringify({\n          customerId,\n          amount: amount, // Amount in cents (2500 = $25.00)\n          type: 'Credit',\n          memo,\n          date: new Date().toISOString()\n        })\n      }, true);\n\n      console.log('[ServiceTitan] âœ… Credit created successfully:', response.id);\n      return response;\n    } catch (error) {\n      console.error('[ServiceTitan] Error creating customer credit:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a pinned note on customer account (for referral credit tracking)\n   * Uses ServiceTitan CRM API to create notes that appear at top of customer file\n   */\n  async createCustomerNote(customerId: number, noteText: string, pinToTop: boolean = true): Promise<{\n    id: number;\n    customerId: number;\n    text: string;\n  }> {\n    try {\n      const endpoint = `/customers/${customerId}/notes`;\n\n      console.log('[ServiceTitan] Creating customer note:', {\n        customerId,\n        noteText: noteText.substring(0, 50) + '...',\n        pinToTop\n      });\n\n      const response = await this.request<{\n        id: number;\n        customerId: number;\n        text: string;\n      }>(endpoint, {\n        method: 'POST',\n        body: JSON.stringify({\n          text: noteText,\n          pinToTop\n        })\n      });\n\n      console.log('[ServiceTitan] âœ… Note created successfully:', response.id);\n      return response;\n    } catch (error) {\n      console.error('[ServiceTitan] Error creating customer note:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get all notes for a customer (to check existing credit balance notes)\n   */\n  async getCustomerNotes(customerId: number): Promise<Array<{\n    id: number;\n    text: string;\n    pinToTop: boolean;\n    createdOn: string;\n  }>> {\n    try {\n      const endpoint = `/customers/${customerId}/notes`;\n\n      const response = await this.request<{\n        data: Array<{\n          id: number;\n          text: string;\n          pinToTop: boolean;\n          createdOn: string;\n        }>;\n      }>(endpoint);\n\n      return response.data || [];\n    } catch (error) {\n      console.error('[ServiceTitan] Error fetching customer notes:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Update an existing customer note (for updating credit balance)\n   */\n  async updateCustomerNote(customerId: number, noteId: number, noteText: string, pinToTop: boolean = true): Promise<void> {\n    try {\n      const endpoint = `/customers/${customerId}/notes/${noteId}`;\n\n      console.log('[ServiceTitan] Updating customer note:', {\n        customerId,\n        noteId,\n        noteText: noteText.substring(0, 50) + '...'\n      });\n\n      await this.request(endpoint, {\n        method: 'PUT',\n        body: JSON.stringify({\n          text: noteText,\n          pinToTop\n        })\n      });\n\n      console.log('[ServiceTitan] âœ… Note updated successfully');\n    } catch (error) {\n      console.error('[ServiceTitan] Error updating customer note:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Fetch jobs with incremental sync support using modifiedOnOrAfter watermark\n   * Returns jobs in batches for efficient processing\n   */\n  async fetchJobsIncremental(modifiedOnOrAfter?: Date, batchSize: number = 250): Promise<{\n    jobs: any[];\n    hasMore: boolean;\n    highestModifiedOn: Date | null;\n  }> {\n    try {\n      const jobsBaseUrl = `https://api.servicetitan.io/jpm/v2/tenant/${this.config.tenantId}`;\n      let endpoint = `${jobsBaseUrl}/jobs?pageSize=${batchSize}`;\n      \n      // Add incremental sync filter\n      if (modifiedOnOrAfter) {\n        const dateStr = modifiedOnOrAfter.toISOString();\n        endpoint += `&modifiedOnOrAfter=${dateStr}`;\n        console.log('[ServiceTitan Jobs Sync] ðŸ“¥ Fetching jobs modified after:', dateStr);\n      } else {\n        console.log('[ServiceTitan Jobs Sync] ðŸ“¥ Fetching ALL jobs (initial sync)');\n      }\n\n      const response = await this.request<{\n        data: Array<{\n          id: number;\n          jobNumber: string;\n          customerId: number;\n          jobType?: string;\n          businessUnitId?: number;\n          jobStatus: string;\n          completedOn?: string;\n          total: number;\n          invoice?: number;\n          createdOn: string;\n          modifiedOn: string;\n        }>;\n        hasMore: boolean;\n      }>(endpoint, {}, true);\n\n      // Track highest modifiedOn for next watermark\n      let highestModifiedOn: Date | null = null;\n      if (response.data && response.data.length > 0) {\n        const modifiedDates = response.data.map(j => new Date(j.modifiedOn));\n        highestModifiedOn = new Date(Math.max(...modifiedDates.map(d => d.getTime())));\n      }\n\n      console.log('[ServiceTitan Jobs Sync] âœ… Fetched', response.data?.length || 0, 'jobs');\n      \n      return {\n        jobs: response.data || [],\n        hasMore: response.hasMore || false,\n        highestModifiedOn\n      };\n    } catch (error) {\n      console.error('[ServiceTitan Jobs Sync] âŒ Error fetching jobs:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Sync all jobs to database with staging â†’ normalized table pattern\n   * Uses watermarks for incremental sync\n   */\n  async syncAllJobs(): Promise<{\n    jobsCount: number;\n    customersUpdated: number;\n    duration: number;\n  }> {\n    const startTime = Date.now();\n    const { serviceTitanJobsStaging, serviceTitanJobs, customersXlsx, syncWatermarks } = await import('@shared/schema');\n    const { eq, sql } = await import('drizzle-orm');\n\n    try {\n      console.log('[ServiceTitan Jobs Sync] ðŸš€ Starting incremental job sync...');\n\n      // Get last watermark\n      const watermark = await db\n        .select()\n        .from(syncWatermarks)\n        .where(eq(syncWatermarks.syncType, 'jobs'))\n        .limit(1);\n\n      const lastModifiedOn = watermark[0]?.lastModifiedOnFetched || null;\n      let totalJobsFetched = 0;\n      let hasMore = true;\n      let currentWatermark = lastModifiedOn;\n\n      // Fetch jobs in batches\n      while (hasMore) {\n        const { jobs, hasMore: more, highestModifiedOn } = await this.fetchJobsIncremental(\n          currentWatermark || undefined,\n          250\n        );\n\n        if (jobs.length === 0) {\n          break;\n        }\n\n        // Stage raw jobs (idempotent - upsert based on jobId)\n        for (const job of jobs) {\n          await db\n            .insert(serviceTitanJobsStaging)\n            .values({\n              jobId: job.id,\n              rawData: job,\n              fetchedAt: new Date(),\n            })\n            .onConflictDoUpdate({\n              target: serviceTitanJobsStaging.jobId,\n              set: {\n                rawData: job,\n                fetchedAt: new Date(),\n              },\n            });\n        }\n\n        // Normalize staged jobs to serviceTitanJobs table\n        const stagedJobs = await db\n          .select()\n          .from(serviceTitanJobsStaging)\n          .where(eq(serviceTitanJobsStaging.processedAt, null as any));\n\n        for (const staged of stagedJobs) {\n          try {\n            const job = staged.rawData as any;\n            \n            // Upsert to normalized jobs table\n            await db\n              .insert(serviceTitanJobs)\n              .values({\n                id: job.id,\n                jobNumber: job.jobNumber,\n                customerId: job.customerId,\n                jobType: job.jobType || null,\n                businessUnitId: job.businessUnitId || null,\n                jobStatus: job.jobStatus,\n                completedOn: job.completedOn ? new Date(job.completedOn) : null,\n                total: Math.round((job.total || 0) * 100), // Convert to cents\n                invoice: Math.round((job.invoice || 0) * 100),\n                createdOn: new Date(job.createdOn),\n                modifiedOn: new Date(job.modifiedOn),\n                lastSyncedAt: new Date(),\n              })\n              .onConflictDoUpdate({\n                target: serviceTitanJobs.id,\n                set: {\n                  jobNumber: job.jobNumber,\n                  jobType: job.jobType || null,\n                  jobStatus: job.jobStatus,\n                  completedOn: job.completedOn ? new Date(job.completedOn) : null,\n                  total: Math.round((job.total || 0) * 100),\n                  invoice: Math.round((job.invoice || 0) * 100),\n                  modifiedOn: new Date(job.modifiedOn),\n                  lastSyncedAt: new Date(),\n                },\n              });\n\n            // Mark as processed\n            await db\n              .update(serviceTitanJobsStaging)\n              .set({ processedAt: new Date() })\n              .where(eq(serviceTitanJobsStaging.id, staged.id));\n\n          } catch (error) {\n            console.error('[ServiceTitan Jobs Sync] âŒ Error processing job:', error);\n            // Mark error but continue\n            await db\n              .update(serviceTitanJobsStaging)\n              .set({ processingError: (error as Error).message })\n              .where(eq(serviceTitanJobsStaging.id, staged.id));\n          }\n        }\n\n        totalJobsFetched += jobs.length;\n        \n        // Update watermark for next batch\n        if (highestModifiedOn) {\n          currentWatermark = highestModifiedOn;\n        }\n\n        hasMore = more;\n      }\n\n      // Update customer job counts (aggregate from completed jobs)\n      console.log('[ServiceTitan Jobs Sync] ðŸ“Š Updating customer job counts...');\n      await db.execute(sql`\n        UPDATE customers_xlsx c\n        SET job_count = (\n          SELECT COUNT(*)\n          FROM service_titan_jobs j\n          WHERE j.customer_id = c.id\n            AND j.job_status = 'Completed'\n            AND j.completed_on IS NOT NULL\n        )\n      `);\n\n      const customersUpdatedResult = await db.execute(sql`\n        SELECT COUNT(*) as count \n        FROM customers_xlsx \n        WHERE job_count > 0\n      `);\n      const customersUpdated = customersUpdatedResult.rows[0]?.count || 0;\n\n      // Update watermark\n      await db\n        .update(syncWatermarks)\n        .set({\n          lastSuccessfulSyncAt: new Date(),\n          lastModifiedOnFetched: currentWatermark,\n          recordsProcessed: totalJobsFetched,\n          syncDuration: Date.now() - startTime,\n          updatedAt: new Date(),\n        })\n        .where(eq(syncWatermarks.syncType, 'jobs'));\n\n      const duration = Date.now() - startTime;\n      console.log('[ServiceTitan Jobs Sync] âœ… Sync complete!');\n      console.log(`  - Jobs synced: ${totalJobsFetched}`);\n      console.log(`  - Customers with jobs: ${customersUpdated}`);\n      console.log(`  - Duration: ${(duration / 1000).toFixed(1)}s`);\n\n      return {\n        jobsCount: totalJobsFetched,\n        customersUpdated: Number(customersUpdated),\n        duration,\n      };\n    } catch (error) {\n      const { eq } = await import('drizzle-orm');\n      \n      // Log error to watermark\n      await db\n        .update(syncWatermarks)\n        .set({\n          lastError: (error as Error).message,\n          lastErrorAt: new Date(),\n          updatedAt: new Date(),\n        })\n        .where(eq(syncWatermarks.syncType, 'jobs'));\n\n      throw error;\n    }\n  }\n\n  /**\n   * Fetch job forms for a specific job\n   * Uses Forms API: GET /forms/v2/tenant/{tenantId}/jobs/{jobId}/forms\n   */\n  async getJobForms(jobId: number): Promise<any[]> {\n    try {\n      const formsUrl = `https://api.servicetitan.io/forms/v2/tenant/${this.config.tenantId}/jobs/${jobId}/forms`;\n      \n      const response = await this.request<{ data: any[] }>(\n        formsUrl,\n        {},\n        true // Use full URL\n      );\n\n      return response.data || [];\n    } catch (error) {\n      console.error(`[ServiceTitan Forms] Error fetching forms for job ${jobId}:`, error);\n      return [];\n    }\n  }\n\n  /**\n   * Sync job forms for recently modified jobs\n   * Extracts technician notes, customer concerns, and recommendations\n   */\n  async syncJobForms(options: {\n    sinceDate?: Date;\n    jobIds?: number[];\n    batchSize?: number;\n  } = {}): Promise<{\n    formsCount: number;\n    jobsProcessed: number;\n    duration: number;\n  }> {\n    const startTime = Date.now();\n    const { serviceTitanJobForms, serviceTitanJobs } = await import('@shared/schema');\n    const { eq, sql, inArray } = await import('drizzle-orm');\n    \n    try {\n      console.log('[ServiceTitan Forms Sync] ðŸ”„ Starting forms sync...');\n      \n      let jobsToSync: any[] = [];\n      \n      // Strategy 1: Sync specific job IDs (if provided)\n      if (options.jobIds && options.jobIds.length > 0) {\n        console.log(`[ServiceTitan Forms Sync] Syncing ${options.jobIds.length} specific jobs`);\n        jobsToSync = await db\n          .select()\n          .from(serviceTitanJobs)\n          .where(inArray(serviceTitanJobs.id, options.jobIds))\n          .limit(options.batchSize || 100);\n      }\n      // Strategy 2: Sync recently modified jobs (default: last 30 days)\n      else {\n        const sinceDate = options.sinceDate || new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n        console.log(`[ServiceTitan Forms Sync] Syncing jobs modified since ${sinceDate.toISOString()}`);\n        \n        jobsToSync = await db\n          .select()\n          .from(serviceTitanJobs)\n          .where(sql`${serviceTitanJobs.modifiedOn} >= ${sinceDate}`)\n          .orderBy(sql`${serviceTitanJobs.modifiedOn} DESC`)\n          .limit(options.batchSize || 100);\n      }\n\n      console.log(`[ServiceTitan Forms Sync] ðŸ“Š Processing ${jobsToSync.length} jobs...`);\n      \n      let totalFormsSynced = 0;\n      let jobsProcessed = 0;\n\n      // Process jobs in batches of 10 to avoid rate limiting\n      const BATCH_SIZE = 10;\n      for (let i = 0; i < jobsToSync.length; i += BATCH_SIZE) {\n        const batch = jobsToSync.slice(i, i + BATCH_SIZE);\n        \n        await Promise.all(batch.map(async (job) => {\n          try {\n            const forms = await this.getJobForms(job.id);\n            \n            if (forms.length === 0) {\n              return;\n            }\n\n            // Process each form\n            for (const form of forms) {\n              try {\n                // Parse form data to extract key fields\n                const parsedFields = this.parseFormFields(form);\n                const technicianNotes = this.extractTechnicianNotes(parsedFields);\n                const customerConcerns = this.extractCustomerConcerns(parsedFields);\n                const recommendationsMade = this.extractRecommendations(parsedFields);\n                const equipmentCondition = this.extractEquipmentCondition(parsedFields);\n\n                // Upsert to database\n                await db\n                  .insert(serviceTitanJobForms)\n                  .values({\n                    formId: form.id,\n                    jobId: job.id,\n                    customerId: job.customerId,\n                    formTemplateId: form.formTemplate?.id || null,\n                    formTemplateName: form.formTemplate?.name || null,\n                    rawFormData: form,\n                    parsedFields,\n                    technicianNotes,\n                    customerConcerns,\n                    recommendationsMade,\n                    equipmentCondition,\n                    submittedOn: form.submittedOn ? new Date(form.submittedOn) : new Date(),\n                    submittedBy: form.submittedBy?.name || null,\n                    lastSyncedAt: new Date(),\n                  })\n                  .onConflictDoUpdate({\n                    target: serviceTitanJobForms.formId,\n                    set: {\n                      rawFormData: form,\n                      parsedFields,\n                      technicianNotes,\n                      customerConcerns,\n                      recommendationsMade,\n                      equipmentCondition,\n                      lastSyncedAt: new Date(),\n                    },\n                  });\n\n                totalFormsSynced++;\n              } catch (error) {\n                console.error(`[ServiceTitan Forms Sync] Error processing form ${form.id}:`, error);\n              }\n            }\n\n            jobsProcessed++;\n            \n            if (jobsProcessed % 20 === 0) {\n              console.log(`[ServiceTitan Forms Sync] Progress: ${jobsProcessed}/${jobsToSync.length} jobs processed`);\n            }\n          } catch (error) {\n            console.error(`[ServiceTitan Forms Sync] Error syncing forms for job ${job.id}:`, error);\n          }\n        }));\n      }\n\n      const duration = Date.now() - startTime;\n      console.log('[ServiceTitan Forms Sync] âœ… Sync complete!');\n      console.log(`  - Jobs processed: ${jobsProcessed}`);\n      console.log(`  - Forms synced: ${totalFormsSynced}`);\n      console.log(`  - Duration: ${(duration / 1000).toFixed(1)}s`);\n\n      return {\n        formsCount: totalFormsSynced,\n        jobsProcessed,\n        duration,\n      };\n    } catch (error) {\n      console.error('[ServiceTitan Forms Sync] âŒ Sync failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Parse form fields into key-value pairs\n   */\n  private parseFormFields(form: any): Record<string, any> {\n    const parsed: Record<string, any> = {};\n    \n    if (!form.fields || !Array.isArray(form.fields)) {\n      return parsed;\n    }\n\n    for (const field of form.fields) {\n      const key = field.name || field.label || `field_${field.id}`;\n      parsed[key] = field.value || field.text || field.selectedOption || null;\n    }\n\n    return parsed;\n  }\n\n  /**\n   * Extract technician notes from form fields\n   */\n  private extractTechnicianNotes(fields: Record<string, any>): string | null {\n    // Common field names for technician notes\n    const noteFields = [\n      'technician_notes',\n      'notes',\n      'tech_notes',\n      'comments',\n      'observations',\n      'findings',\n      'service_notes',\n      'job_notes',\n    ];\n\n    const notes: string[] = [];\n    \n    for (const [key, value] of Object.entries(fields)) {\n      const lowerKey = key.toLowerCase().replace(/[^a-z]/g, '');\n      \n      if (noteFields.some(f => lowerKey.includes(f.replace(/_/g, ''))) && value) {\n        notes.push(String(value));\n      }\n    }\n\n    return notes.length > 0 ? notes.join('\\n\\n') : null;\n  }\n\n  /**\n   * Extract customer concerns from form fields\n   */\n  private extractCustomerConcerns(fields: Record<string, any>): string[] {\n    const concerns: string[] = [];\n    const concernKeywords = [\n      'concern',\n      'issue',\n      'problem',\n      'complaint',\n      'worry',\n    ];\n\n    for (const [key, value] of Object.entries(fields)) {\n      const lowerKey = key.toLowerCase();\n      \n      if (concernKeywords.some(k => lowerKey.includes(k)) && value) {\n        concerns.push(String(value));\n      }\n    }\n\n    return concerns;\n  }\n\n  /**\n   * Extract recommendations from form fields\n   */\n  private extractRecommendations(fields: Record<string, any>): string[] {\n    const recommendations: string[] = [];\n    const recommendationKeywords = [\n      'recommend',\n      'suggestion',\n      'should replace',\n      'needs replacement',\n      'should consider',\n      'advise',\n    ];\n\n    for (const [key, value] of Object.entries(fields)) {\n      const lowerKey = key.toLowerCase();\n      const lowerValue = String(value || '').toLowerCase();\n      \n      if (recommendationKeywords.some(k => lowerKey.includes(k) || lowerValue.includes(k)) && value) {\n        recommendations.push(String(value));\n      }\n    }\n\n    return recommendations;\n  }\n\n  /**\n   * Extract equipment condition assessment\n   */\n  private extractEquipmentCondition(fields: Record<string, any>): string | null {\n    const conditionKeywords = [\n      'condition',\n      'status',\n      'quality',\n      'state',\n    ];\n\n    for (const [key, value] of Object.entries(fields)) {\n      const lowerKey = key.toLowerCase();\n      \n      if (conditionKeywords.some(k => lowerKey.includes(k)) && value) {\n        const lowerValue = String(value).toLowerCase();\n        \n        // Match common condition values\n        if (lowerValue.includes('critical') || lowerValue.includes('failure')) return 'Critical';\n        if (lowerValue.includes('poor') || lowerValue.includes('bad')) return 'Poor';\n        if (lowerValue.includes('fair') || lowerValue.includes('okay')) return 'Fair';\n        if (lowerValue.includes('good')) return 'Good';\n        if (lowerValue.includes('excellent') || lowerValue.includes('great')) return 'Excellent';\n        \n        return String(value);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Marketing API Methods\n   * NOTE: These methods use inferred API schemas based on ServiceTitan documentation patterns.\n   * Adjust request/response structures as needed once exact schemas are confirmed.\n   */\n\n  /**\n   * Get all marketing campaigns\n   */\n  async getCampaigns(): Promise<any[]> {\n    try {\n      const marketingUrl = `https://api.servicetitan.io/marketing/v2/tenant/${this.config.tenantId}/campaigns`;\n      \n      const response = await this.request<any>(marketingUrl, {}, true);\n      \n      // ServiceTitan typically returns { data: [...] }\n      return response.data || response || [];\n    } catch (error) {\n      console.error('[ServiceTitan] Get campaigns error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get a specific marketing campaign by ID\n   */\n  async getCampaign(campaignId: number): Promise<any> {\n    try {\n      const marketingUrl = `https://api.servicetitan.io/marketing/v2/tenant/${this.config.tenantId}/campaigns/${campaignId}`;\n      \n      return await this.request<any>(marketingUrl, {}, true);\n    } catch (error) {\n      console.error('[ServiceTitan] Get campaign error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new marketing campaign in ServiceTitan\n   * @param campaignData - Campaign creation data\n   * @returns The created campaign with ServiceTitan ID\n   */\n  async createCampaign(campaignData: {\n    name: string;\n    categoryId?: number;\n    active?: boolean;\n    businessUnitId?: number;\n    phoneNumber?: string;\n  }): Promise<{ id: number; name: string }> {\n    try {\n      const marketingUrl = `https://api.servicetitan.io/marketing/v2/tenant/${this.config.tenantId}/campaigns`;\n      \n      // Build request body based on ServiceTitan patterns\n      const requestBody = {\n        name: campaignData.name,\n        active: campaignData.active ?? true,\n        ...(campaignData.categoryId && { categoryId: campaignData.categoryId }),\n        ...(campaignData.businessUnitId && { businessUnitId: campaignData.businessUnitId }),\n        ...(campaignData.phoneNumber && { phoneNumber: campaignData.phoneNumber }),\n      };\n\n      console.log('[ServiceTitan] Creating campaign:', requestBody);\n\n      const response = await this.request<any>(marketingUrl, {\n        method: 'POST',\n        body: JSON.stringify(requestBody),\n      }, true);\n\n      console.log('[ServiceTitan] Campaign created:', response);\n\n      return {\n        id: response.id || response.data?.id,\n        name: response.name || response.data?.name || campaignData.name,\n      };\n    } catch (error) {\n      console.error('[ServiceTitan] Create campaign error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get campaign categories for organizing campaigns\n   */\n  async getCampaignCategories(): Promise<any[]> {\n    try {\n      const marketingUrl = `https://api.servicetitan.io/marketing/v2/tenant/${this.config.tenantId}/campaign-categories`;\n      \n      const response = await this.request<any>(marketingUrl, {}, true);\n      \n      return response.data || response || [];\n    } catch (error) {\n      console.error('[ServiceTitan] Get campaign categories error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update campaign costs for ROI tracking\n   */\n  async updateCampaignCost(campaignId: number, cost: {\n    month: string; // Format: \"YYYY-MM\"\n    amount: number;\n  }): Promise<void> {\n    try {\n      const marketingUrl = `https://api.servicetitan.io/marketing/v2/tenant/${this.config.tenantId}/campaigns/${campaignId}/costs`;\n      \n      await this.request<any>(marketingUrl, {\n        method: 'POST',\n        body: JSON.stringify(cost),\n      }, true);\n\n      console.log('[ServiceTitan] Campaign cost updated');\n    } catch (error) {\n      console.error('[ServiceTitan] Update campaign cost error:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get all customers in bulk (for creating lookup maps)\n   * Returns customer ID -> customer name mapping\n   */\n  async getAllCustomersMap(): Promise<Map<number, string>> {\n    try {\n      console.log('[ServiceTitan] Fetching all customers for lookup map...');\n      \n      const customerMap = new Map<number, string>();\n      const PAGE_SIZE = 500;\n      let page = 1;\n      let hasMore = true;\n\n      while (hasMore && page < 100) { // Max 50,000 customers\n        const customersUrl = `https://api.servicetitan.io/crm/v2/tenant/${this.config.tenantId}/customers?page=${page}&pageSize=${PAGE_SIZE}`;\n        const result = await this.request<{ data: any[]; hasMore: boolean }>(customersUrl, {}, true);\n        \n        const customers = result.data || [];\n        console.log(`[ServiceTitan] Page ${page}: Fetched ${customers.length} customers`);\n        \n        // Add to map\n        customers.forEach((customer: any) => {\n          const name = customer.name || customer.companyName || `Customer #${customer.id}`;\n          customerMap.set(customer.id, name);\n        });\n        \n        hasMore = result.hasMore || false;\n        page++;\n        \n        // Stop if we got less than a full page\n        if (customers.length < PAGE_SIZE) {\n          break;\n        }\n      }\n\n      console.log(`[ServiceTitan] Created customer lookup map with ${customerMap.size} customers`);\n      return customerMap;\n    } catch (error) {\n      console.error('[ServiceTitan] Error fetching customer map:', error);\n      // Return empty map on error rather than failing\n      return new Map();\n    }\n  }\n\n  /**\n   * Get all customer memberships from ServiceTitan\n   * Returns all recurring service events (memberships) for all customers\n   */\n  async getAllMemberships(): Promise<any[]> {\n    try {\n      console.log('[ServiceTitan Memberships] Fetching all customer memberships...');\n      \n      // First, fetch all customers to create a lookup map\n      const customerMap = await this.getAllCustomersMap();\n      \n      const membershipsUrl = `https://api.servicetitan.io/memberships/v2/tenant/${this.config.tenantId}/recurring-service-events?pageSize=500`;\n      const result = await this.request<{ data: any[]; hasMore: boolean }>(membershipsUrl, {}, true);\n      \n      let allMemberships = result.data || [];\n      let page = 1;\n      let hasMore = result.hasMore || false;\n\n      while (hasMore && page < 10) {\n        page++;\n        const nextPageUrl = `${membershipsUrl}&page=${page}`;\n        const nextResult = await this.request<{ data: any[]; hasMore: boolean }>(nextPageUrl, {}, true);\n        allMemberships = [...allMemberships, ...(nextResult.data || [])];\n        hasMore = nextResult.hasMore || false;\n      }\n\n      console.log(`[ServiceTitan Memberships] Fetched ${allMemberships.length} total memberships`);\n      \n      return allMemberships.map((m: any) => ({\n        id: m.id,\n        customerId: m.customerId,\n        customerName: customerMap.get(m.customerId) || m.customerName || 'Unknown Customer',\n        membershipId: m.membershipId,\n        membershipName: m.membershipName || m.locationRecurringServiceName || 'VIP Membership',\n        status: m.status || 'Unknown',\n        startDate: m.from || m.createdOn,\n        expirationDate: m.to || m.expirationDate,\n        renewalDate: m.date || m.nextScheduledDate,\n        balance: parseFloat(m.balance || '0'),\n        totalValue: parseFloat(m.total || '0'),\n        description: m.memo || m.description || '',\n        createdOn: m.createdOn,\n        modifiedOn: m.modifiedOn,\n        rawData: m,\n      }));\n    } catch (error) {\n      console.error('[ServiceTitan Memberships] Error fetching all memberships:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update a customer membership status (expire/cancel/suspend)\n   * Uses PATCH endpoint to edit customer membership\n   */\n  async updateMembershipStatus(membershipId: number, updates: {\n    status?: string;\n    expirationDate?: string;\n    cancellationDate?: string;\n  }): Promise<any> {\n    try {\n      console.log(`[ServiceTitan Memberships] Updating membership ${membershipId}:`, updates);\n      \n      const membershipsUrl = `https://api.servicetitan.io/memberships/v2/tenant/${this.config.tenantId}/customer-memberships/${membershipId}`;\n      \n      const requestBody: any = {};\n      \n      if (updates.status) {\n        requestBody.status = updates.status;\n      }\n      \n      if (updates.expirationDate) {\n        requestBody.to = updates.expirationDate;\n      }\n      \n      if (updates.cancellationDate) {\n        requestBody.cancellationDate = updates.cancellationDate;\n      }\n\n      const response = await this.request<any>(membershipsUrl, {\n        method: 'PATCH',\n        body: JSON.stringify(requestBody),\n      }, true);\n\n      console.log(`[ServiceTitan Memberships] Membership ${membershipId} updated successfully`);\n      \n      return response;\n    } catch (error) {\n      console.error(`[ServiceTitan Memberships] Error updating membership ${membershipId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Bulk update multiple memberships (for expiring old memberships)\n   */\n  async bulkUpdateMemberships(updates: Array<{\n    membershipId: number;\n    status?: string;\n    expirationDate?: string;\n    cancellationDate?: string;\n  }>): Promise<{ success: number; failed: number; errors: any[] }> {\n    console.log(`[ServiceTitan Memberships] Bulk updating ${updates.length} memberships...`);\n    \n    let success = 0;\n    let failed = 0;\n    const errors: any[] = [];\n\n    for (const update of updates) {\n      try {\n        await this.updateMembershipStatus(update.membershipId, {\n          status: update.status,\n          expirationDate: update.expirationDate,\n          cancellationDate: update.cancellationDate,\n        });\n        success++;\n      } catch (error) {\n        failed++;\n        errors.push({\n          membershipId: update.membershipId,\n          error: error instanceof Error ? error.message : 'Unknown error',\n        });\n      }\n    }\n\n    console.log(`[ServiceTitan Memberships] Bulk update complete: ${success} succeeded, ${failed} failed`);\n    \n    return { success, failed, errors };\n  }\n}\n\n// Singleton instance\nlet serviceTitanAPI: ServiceTitanAPI | null = null;\n\nexport function getServiceTitanAPI(): ServiceTitanAPI {\n  if (!serviceTitanAPI) {\n    const clientId = process.env.SERVICETITAN_CLIENT_ID;\n    const clientSecret = process.env.SERVICETITAN_CLIENT_SECRET;\n    const tenantId = process.env.SERVICETITAN_TENANT_ID;\n    const appKey = process.env.SERVICETITAN_APP_KEY;\n\n    if (!clientId || !clientSecret || !tenantId || !appKey) {\n      throw new Error('ServiceTitan credentials not configured');\n    }\n\n    serviceTitanAPI = new ServiceTitanAPI({\n      clientId,\n      clientSecret,\n      tenantId,\n      appKey,\n    });\n  }\n\n  return serviceTitanAPI;\n}\n\n/**\n * Normalize phone number to digits only (strip formatting, country code, extensions)\n * (512) 555-1234 â†’ 5125551234\n * +1-512-555-1234 â†’ 5125551234\n * 512-555-1234 x123 â†’ 5125551234\n * 512-555-1234 ext 123 â†’ 5125551234\n */\nexport function normalizePhone(phone: string): string {\n  if (!phone) return '';\n  \n  // Remove common extension markers before processing\n  // Match: x123, ext 123, ext. 123, extension 123, #123\n  const withoutExtension = phone.replace(/\\s*(x|ext\\.?|extension|#)\\s*\\d+/gi, '');\n  \n  // Remove all non-digits\n  const digitsOnly = withoutExtension.replace(/\\D/g, '');\n  \n  // Remove leading 1 (US country code) if present and 11 digits\n  if (digitsOnly.length === 11 && digitsOnly.startsWith('1')) {\n    return digitsOnly.substring(1);\n  }\n  \n  return digitsOnly;\n}\n\n/**\n * Normalize email to lowercase for consistent searching\n */\nexport function normalizeEmail(email: string): string {\n  if (!email) return '';\n  return email.trim().toLowerCase();\n}\n\n// Export the class for direct use\nexport { ServiceTitanAPI };\n"],"names":[],"mappings":"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","debugId":null}}]
}