{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/admin/_components/UnifiedAdminClient.tsx"],"sourcesContent":["'use client';\n\n/**\n * Unified Admin Dashboard - Client Component\n * \n * Main admin interface with all functionality consolidated in one place.\n * Uses URL search params for section navigation (replacing wouter/localStorage).\n */\n\nimport { useEffect, useState } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { useQuery } from '@tanstack/react-query';\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarProvider,\n  SidebarHeader,\n  SidebarFooter,\n  SidebarTrigger\n} from '@/components/ui/sidebar';\nimport { Button } from '@/components/ui/button';\nimport {\n  LayoutDashboard,\n  ImageIcon,\n  FileText,\n  Phone,\n  Building2,\n  LogOut,\n  Users,\n  Star,\n  Settings,\n  Mail,\n  Bot\n} from 'lucide-react';\n\ntype AdminSection = \n  | 'dashboard'\n  | 'photos'\n  | 'success-stories'\n  | 'commercial-customers'\n  | 'page-metadata'\n  | 'tracking-numbers'\n  | 'products'\n  | 'referrals'\n  | 'reviews'\n  | 'review-platforms'\n  | 'customer-data'\n  | 'marketing-campaigns'\n  | 'custom-campaigns'\n  | 'chatbot';\n\nexport default function UnifiedAdminClient() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  \n  // Initialize section from URL\n  const urlSection = searchParams.get('section') || 'dashboard';\n  const [activeSection, setActiveSection] = useState<AdminSection>(() => {\n    return isValidSection(urlSection) ? (urlSection as AdminSection) : 'dashboard';\n  });\n\n  // Check auth status\n  const { data: authData } = useQuery<{ isAdmin: boolean }>({\n    queryKey: ['/api/admin/check'],\n  });\n\n  // Fetch stats\n  const { data: statsData } = useQuery<{ stats: any }>({\n    queryKey: ['/api/admin/stats'],\n  });\n\n  // Sync activeSection when URL changes (back/forward navigation, external links)\n  useEffect(() => {\n    const currentSection = searchParams.get('section') || 'dashboard';\n    if (isValidSection(currentSection) && currentSection !== activeSection) {\n      setActiveSection(currentSection as AdminSection);\n    }\n  }, [searchParams]); // Only depend on searchParams\n\n  // Update URL when section changes programmatically (use push for history)\n  useEffect(() => {\n    const urlParam = searchParams.get('section') || 'dashboard';\n    if (activeSection !== urlParam) {\n      const params = new URLSearchParams(searchParams.toString());\n      if (activeSection !== 'dashboard') {\n        params.set('section', activeSection);\n      } else {\n        params.delete('section');\n      }\n      router.push(`/admin?${params.toString()}`, { scroll: false });\n    }\n  }, [activeSection]); // Only depend on activeSection\n\n  // Redirect if not admin\n  useEffect(() => {\n    if (authData && !authData.isAdmin) {\n      router.push('/admin-login');\n    }\n  }, [authData, router]);\n\n  // Show nothing while checking auth\n  if (!authData?.isAdmin) {\n    return null;\n  }\n\n  const stats = statsData?.stats || {};\n\n  const sidebarStyle = {\n    '--sidebar-width': '280px',\n  };\n\n  const renderContent = () => {\n    switch (activeSection) {\n      case 'dashboard':\n        return <DashboardPlaceholder stats={stats} />;\n      case 'photos':\n        return <SectionPlaceholder title=\"Photo Management\" />;\n      case 'success-stories':\n        return <SectionPlaceholder title=\"Success Stories\" />;\n      case 'reviews':\n        return <SectionPlaceholder title=\"Reviews\" />;\n      case 'commercial-customers':\n        return <SectionPlaceholder title=\"Commercial Customers\" />;\n      case 'page-metadata':\n        return <SectionPlaceholder title=\"Page Metadata\" />;\n      case 'tracking-numbers':\n        return <SectionPlaceholder title=\"Tracking Numbers\" />;\n      case 'products':\n        return <SectionPlaceholder title=\"Products & Memberships\" />;\n      case 'review-platforms':\n        return <SectionPlaceholder title=\"Review Platforms\" />;\n      case 'referrals':\n        return <SectionPlaceholder title=\"Referral System\" />;\n      case 'marketing-campaigns':\n        return <SectionPlaceholder title=\"Marketing Campaigns\" />;\n      case 'custom-campaigns':\n        return <SectionPlaceholder title=\"Custom Campaigns\" />;\n      case 'customer-data':\n        return <SectionPlaceholder title=\"Customer Data\" />;\n      case 'chatbot':\n        return <SectionPlaceholder title=\"AI Chatbot\" />;\n      default:\n        return <DashboardPlaceholder stats={stats} />;\n    }\n  };\n\n  const getSectionTitle = () => {\n    const titles: Record<AdminSection, string> = {\n      dashboard: 'Dashboard',\n      photos: 'Photo Management',\n      'success-stories': 'Success Stories',\n      reviews: 'Reviews',\n      'review-platforms': 'Review Platforms',\n      'commercial-customers': 'Commercial Customers',\n      'page-metadata': 'Page Metadata',\n      'tracking-numbers': 'Tracking Numbers',\n      products: 'Products & Memberships',\n      referrals: 'Referral System',\n      'marketing-campaigns': 'Marketing Campaigns',\n      'custom-campaigns': 'Custom Campaigns',\n      'customer-data': 'Customer Data',\n      chatbot: 'AI Chatbot',\n    };\n    return titles[activeSection];\n  };\n\n  return (\n    <SidebarProvider style={sidebarStyle as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <AdminSidebar activeSection={activeSection} setActiveSection={setActiveSection} />\n\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          {/* Header */}\n          <header className=\"flex items-center justify-between border-b px-6 py-4\">\n            <div className=\"flex items-center gap-4\">\n              <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n              <div>\n                <h1 className=\"text-2xl font-bold\" data-testid=\"heading-section-title\">\n                  {getSectionTitle()}\n                </h1>\n                <p className=\"text-sm text-muted-foreground\">\n                  {activeSection === 'dashboard'\n                    ? 'Welcome to the admin portal'\n                    : `Manage ${getSectionTitle().toLowerCase()}`}\n                </p>\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              onClick={() => router.push('/admin/logout')}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"w-4 h-4 mr-2\" />\n              Log Out\n            </Button>\n          </header>\n\n          {/* Content */}\n          <main className=\"flex-1 overflow-y-auto p-6\">{renderContent()}</main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n\n// Helper function\nfunction isValidSection(section: string): boolean {\n  const validSections: AdminSection[] = [\n    'dashboard',\n    'photos',\n    'success-stories',\n    'commercial-customers',\n    'page-metadata',\n    'tracking-numbers',\n    'products',\n    'referrals',\n    'reviews',\n    'review-platforms',\n    'customer-data',\n    'marketing-campaigns',\n    'custom-campaigns',\n    'chatbot',\n  ];\n  return validSections.includes(section as AdminSection);\n}\n\n// Sidebar Component\ninterface AdminSidebarProps {\n  activeSection: AdminSection;\n  setActiveSection: (section: AdminSection) => void;\n}\n\nfunction AdminSidebar({ activeSection, setActiveSection }: AdminSidebarProps) {\n  const menuItems = [\n    { id: 'dashboard' as const, label: 'Dashboard', icon: LayoutDashboard },\n    { id: 'photos' as const, label: 'Photos', icon: ImageIcon },\n    { id: 'success-stories' as const, label: 'Success Stories', icon: Star },\n    { id: 'reviews' as const, label: 'Reviews', icon: Star },\n    { id: 'commercial-customers' as const, label: 'Commercial', icon: Building2 },\n    { id: 'page-metadata' as const, label: 'SEO/Meta', icon: FileText },\n    { id: 'tracking-numbers' as const, label: 'Tracking #s', icon: Phone },\n    { id: 'products' as const, label: 'Products', icon: Building2 },\n    { id: 'referrals' as const, label: 'Referrals', icon: Users },\n    { id: 'marketing-campaigns' as const, label: 'Marketing', icon: Mail },\n    { id: 'customer-data' as const, label: 'Customers', icon: Users },\n    { id: 'chatbot' as const, label: 'Chatbot', icon: Bot },\n  ];\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4 border-b\">\n        <h2 className=\"text-lg font-bold\">Economy Plumbing</h2>\n        <p className=\"text-xs text-muted-foreground\">Admin Dashboard</p>\n      </SidebarHeader>\n\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.id}>\n                  <SidebarMenuButton\n                    onClick={() => setActiveSection(item.id)}\n                    isActive={activeSection === item.id}\n                    data-testid={`nav-${item.id}`}\n                  >\n                    <item.icon className=\"w-4 h-4\" />\n                    <span>{item.label}</span>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      <SidebarFooter className=\"p-4 border-t\">\n        <div className=\"text-xs text-muted-foreground\">\n          Next.js Migration v2.0\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n\n// Placeholder Components\nfunction DashboardPlaceholder({ stats }: { stats: any }) {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"grid md:grid-cols-4 gap-6\">\n        <StatsCard label=\"Total Photos\" value={stats.totalPhotos || 0} />\n        <StatsCard label=\"Blog Posts\" value={stats.totalBlogPosts || 0} />\n        <StatsCard label=\"Customers\" value={stats.totalCustomers || 0} />\n        <StatsCard label=\"Reviews\" value={stats.totalReviews || 0} />\n      </div>\n\n      <div className=\"bg-card p-8 rounded-lg border\">\n        <h3 className=\"text-lg font-semibold mb-2\">Admin Dashboard</h3>\n        <p className=\"text-muted-foreground\">\n          Select a section from the sidebar to manage different parts of the website.\n          This is the migrated unified admin dashboard.\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction StatsCard({ label, value }: { label: string; value: number }) {\n  return (\n    <div className=\"bg-card p-6 rounded-lg border\">\n      <div className=\"text-sm text-muted-foreground mb-1\">{label}</div>\n      <div className=\"text-3xl font-bold\">{value}</div>\n    </div>\n  );\n}\n\nfunction SectionPlaceholder({ title }: { title: string }) {\n  return (\n    <div className=\"bg-card p-8 rounded-lg border\">\n      <h3 className=\"text-lg font-semibold mb-2\">{title}</h3>\n      <p className=\"text-muted-foreground\">\n        This section is being migrated from the old admin dashboard.\n        Full functionality will be restored soon.\n      </p>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}