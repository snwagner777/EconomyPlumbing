(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,461288,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(266027),a=e.i(954616),n=e.i(437453),i=e.i(809637),l=e.i(515288),o=e.i(487486),c=e.i(519455),d=e.i(793479),u=e.i(110204),h=e.i(967489),m=e.i(677572),x=e.i(776639),p=e.i(975157);let v=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:r,className:(0,p.cn)("w-full caption-bottom text-sm",e),...s})}));v.displayName="Table";let f=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("thead",{ref:r,className:(0,p.cn)("[&_tr]:border-b",e),...s}));f.displayName="TableHeader";let j=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("tbody",{ref:r,className:(0,p.cn)("[&_tr:last-child]:border-0",e),...s}));j.displayName="TableBody",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("tfoot",{ref:r,className:(0,p.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let g=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("tr",{ref:r,className:(0,p.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));g.displayName="TableRow";let b=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("th",{ref:r,className:(0,p.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));b.displayName="TableHead";let w=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("td",{ref:r,className:(0,p.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));w.displayName="TableCell",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("caption",{ref:r,className:(0,p.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";var C=e.i(302747),N=e.i(624687),y=e.i(475254);let S=(0,y.default)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var T=e.i(286536),R=e.i(686311),k=e.i(555436),E=e.i(870273),D=e.i(365582),L=e.i(400417),A=e.i(25652),P=e.i(761911),H=e.i(503116),q=e.i(263488);let I=(0,y.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var B=e.i(16715),U=e.i(908406),_=e.i(248425),O=e.i(296626),F=e.i(30030),M=e.i(820783),z=e.i(30207),$=e.i(586318),W=e.i(934620),V=e.i(470152),Q=e.i(981140),X="ScrollArea",[Y,K]=(0,F.createContextScope)(X),[G,J]=Y(X),Z=s.forwardRef((e,r)=>{let{__scopeScrollArea:a,type:n="hover",dir:i,scrollHideDelay:l=600,...o}=e,[c,d]=s.useState(null),[u,h]=s.useState(null),[m,x]=s.useState(null),[p,v]=s.useState(null),[f,j]=s.useState(null),[g,b]=s.useState(0),[w,C]=s.useState(0),[N,y]=s.useState(!1),[S,T]=s.useState(!1),R=(0,M.useComposedRefs)(r,e=>d(e)),k=(0,$.useDirection)(i);return(0,t.jsx)(G,{scope:a,type:n,dir:k,scrollHideDelay:l,scrollArea:c,viewport:u,onViewportChange:h,content:m,onContentChange:x,scrollbarX:p,onScrollbarXChange:v,scrollbarXEnabled:N,onScrollbarXEnabledChange:y,scrollbarY:f,onScrollbarYChange:j,scrollbarYEnabled:S,onScrollbarYEnabledChange:T,onCornerWidthChange:b,onCornerHeightChange:C,children:(0,t.jsx)(_.Primitive.div,{dir:k,...o,ref:R,style:{position:"relative","--radix-scroll-area-corner-width":g+"px","--radix-scroll-area-corner-height":w+"px",...e.style}})})});Z.displayName=X;var ee="ScrollAreaViewport",et=s.forwardRef((e,r)=>{let{__scopeScrollArea:a,children:n,nonce:i,...l}=e,o=J(ee,a),c=s.useRef(null),d=(0,M.useComposedRefs)(r,c,o.onViewportChange);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),(0,t.jsx)(_.Primitive.div,{"data-radix-scroll-area-viewport":"",...l,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,t.jsx)("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});et.displayName=ee;var es="ScrollAreaScrollbar",er=s.forwardRef((e,r)=>{let{forceMount:a,...n}=e,i=J(es,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,c="horizontal"===e.orientation;return s.useEffect(()=>(c?l(!0):o(!0),()=>{c?l(!1):o(!1)}),[c,l,o]),"hover"===i.type?(0,t.jsx)(ea,{...n,ref:r,forceMount:a}):"scroll"===i.type?(0,t.jsx)(en,{...n,ref:r,forceMount:a}):"auto"===i.type?(0,t.jsx)(ei,{...n,ref:r,forceMount:a}):"always"===i.type?(0,t.jsx)(el,{...n,ref:r}):null});er.displayName=es;var ea=s.forwardRef((e,r)=>{let{forceMount:a,...n}=e,i=J(es,e.__scopeScrollArea),[l,o]=s.useState(!1);return s.useEffect(()=>{let e=i.scrollArea,t=0;if(e){let s=()=>{window.clearTimeout(t),o(!0)},r=()=>{t=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return e.addEventListener("pointerenter",s),e.addEventListener("pointerleave",r),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",s),e.removeEventListener("pointerleave",r)}}},[i.scrollArea,i.scrollHideDelay]),(0,t.jsx)(O.Presence,{present:a||l,children:(0,t.jsx)(ei,{"data-state":l?"visible":"hidden",...n,ref:r})})}),en=s.forwardRef((e,r)=>{var a;let{forceMount:n,...i}=e,l=J(es,e.__scopeScrollArea),o="horizontal"===e.orientation,c=eS(()=>u("SCROLL_END"),100),[d,u]=(a={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},s.useReducer((e,t)=>a[e][t]??e,"hidden"));return s.useEffect(()=>{if("idle"===d){let e=window.setTimeout(()=>u("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(e)}},[d,l.scrollHideDelay,u]),s.useEffect(()=>{let e=l.viewport,t=o?"scrollLeft":"scrollTop";if(e){let s=e[t],r=()=>{let r=e[t];s!==r&&(u("SCROLL"),c()),s=r};return e.addEventListener("scroll",r),()=>e.removeEventListener("scroll",r)}},[l.viewport,o,u,c]),(0,t.jsx)(O.Presence,{present:n||"hidden"!==d,children:(0,t.jsx)(el,{"data-state":"hidden"===d?"hidden":"visible",...i,ref:r,onPointerEnter:(0,Q.composeEventHandlers)(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:(0,Q.composeEventHandlers)(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),ei=s.forwardRef((e,r)=>{let a=J(es,e.__scopeScrollArea),{forceMount:n,...i}=e,[l,o]=s.useState(!1),c="horizontal"===e.orientation,d=eS(()=>{if(a.viewport){let e=a.viewport.offsetWidth<a.viewport.scrollWidth,t=a.viewport.offsetHeight<a.viewport.scrollHeight;o(c?e:t)}},10);return eT(a.viewport,d),eT(a.content,d),(0,t.jsx)(O.Presence,{present:n||l,children:(0,t.jsx)(el,{"data-state":l?"visible":"hidden",...i,ref:r})})}),el=s.forwardRef((e,r)=>{let{orientation:a="vertical",...n}=e,i=J(es,e.__scopeScrollArea),l=s.useRef(null),o=s.useRef(0),[c,d]=s.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=eb(c.viewport,c.content),h={...n,sizes:c,onSizesChange:d,hasThumb:!!(u>0&&u<1),onThumbChange:e=>l.current=e,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:e=>o.current=e};function m(e,t){return function(e,t,s,r="ltr"){let a=ew(s),n=t||a/2,i=s.scrollbar.paddingStart+n,l=s.scrollbar.size-s.scrollbar.paddingEnd-(a-n),o=s.content-s.viewport;return eN([i,l],"ltr"===r?[0,o]:[-1*o,0])(e)}(e,o.current,c,t)}return"horizontal"===a?(0,t.jsx)(eo,{...h,ref:r,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=eC(i.viewport.scrollLeft,c,i.dir);l.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollLeft=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollLeft=m(e,i.dir))}}):"vertical"===a?(0,t.jsx)(ec,{...h,ref:r,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=eC(i.viewport.scrollTop,c);l.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollTop=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollTop=m(e))}}):null}),eo=s.forwardRef((e,r)=>{let{sizes:a,onSizesChange:n,...i}=e,l=J(es,e.__scopeScrollArea),[o,c]=s.useState(),d=s.useRef(null),u=(0,M.useComposedRefs)(r,d,l.onScrollbarXChange);return s.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,t.jsx)(eh,{"data-orientation":"horizontal",...i,ref:u,sizes:a,style:{bottom:0,left:"rtl"===l.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===l.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ew(a)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,s)=>{if(l.viewport){var r,a;let n=l.viewport.scrollLeft+t.deltaX;e.onWheelScroll(n),r=n,a=s,r>0&&r<a&&t.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&n({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:eg(o.paddingLeft),paddingEnd:eg(o.paddingRight)}})}})}),ec=s.forwardRef((e,r)=>{let{sizes:a,onSizesChange:n,...i}=e,l=J(es,e.__scopeScrollArea),[o,c]=s.useState(),d=s.useRef(null),u=(0,M.useComposedRefs)(r,d,l.onScrollbarYChange);return s.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,t.jsx)(eh,{"data-orientation":"vertical",...i,ref:u,sizes:a,style:{top:0,right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ew(a)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,s)=>{if(l.viewport){var r,a;let n=l.viewport.scrollTop+t.deltaY;e.onWheelScroll(n),r=n,a=s,r>0&&r<a&&t.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&n({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:eg(o.paddingTop),paddingEnd:eg(o.paddingBottom)}})}})}),[ed,eu]=Y(es),eh=s.forwardRef((e,r)=>{let{__scopeScrollArea:a,sizes:n,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:m,...x}=e,p=J(es,a),[v,f]=s.useState(null),j=(0,M.useComposedRefs)(r,e=>f(e)),g=s.useRef(null),b=s.useRef(""),w=p.viewport,C=n.content-n.viewport,N=(0,z.useCallbackRef)(h),y=(0,z.useCallbackRef)(d),S=eS(m,10);function T(e){g.current&&u({x:e.clientX-g.current.left,y:e.clientY-g.current.top})}return s.useEffect(()=>{let e=e=>{let t=e.target;v?.contains(t)&&N(e,C)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[w,v,C,N]),s.useEffect(y,[n,y]),eT(v,S),eT(p.content,S),(0,t.jsx)(ed,{scope:a,scrollbar:v,hasThumb:i,onThumbChange:(0,z.useCallbackRef)(l),onThumbPointerUp:(0,z.useCallbackRef)(o),onThumbPositionChange:y,onThumbPointerDown:(0,z.useCallbackRef)(c),children:(0,t.jsx)(_.Primitive.div,{...x,ref:j,style:{position:"absolute",...x.style},onPointerDown:(0,Q.composeEventHandlers)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),g.current=v.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),T(e))}),onPointerMove:(0,Q.composeEventHandlers)(e.onPointerMove,T),onPointerUp:(0,Q.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=b.current,p.viewport&&(p.viewport.style.scrollBehavior=""),g.current=null})})})}),em="ScrollAreaThumb",ex=s.forwardRef((e,s)=>{let{forceMount:r,...a}=e,n=eu(em,e.__scopeScrollArea);return(0,t.jsx)(O.Presence,{present:r||n.hasThumb,children:(0,t.jsx)(ep,{ref:s,...a})})}),ep=s.forwardRef((e,r)=>{let{__scopeScrollArea:a,style:n,...i}=e,l=J(em,a),o=eu(em,a),{onThumbPositionChange:c}=o,d=(0,M.useComposedRefs)(r,e=>o.onThumbChange(e)),u=s.useRef(void 0),h=eS(()=>{u.current&&(u.current(),u.current=void 0)},100);return s.useEffect(()=>{let e=l.viewport;if(e){let t=()=>{h(),u.current||(u.current=ey(e,c),c())};return c(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[l.viewport,h,c]),(0,t.jsx)(_.Primitive.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:(0,Q.composeEventHandlers)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top;o.onThumbPointerDown({x:s,y:r})}),onPointerUp:(0,Q.composeEventHandlers)(e.onPointerUp,o.onThumbPointerUp)})});ex.displayName=em;var ev="ScrollAreaCorner",ef=s.forwardRef((e,s)=>{let r=J(ev,e.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&a?(0,t.jsx)(ej,{...e,ref:s}):null});ef.displayName=ev;var ej=s.forwardRef((e,r)=>{let{__scopeScrollArea:a,...n}=e,i=J(ev,a),[l,o]=s.useState(0),[c,d]=s.useState(0),u=!!(l&&c);return eT(i.scrollbarX,()=>{let e=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(e),d(e)}),eT(i.scrollbarY,()=>{let e=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(e),o(e)}),u?(0,t.jsx)(_.Primitive.div,{...n,ref:r,style:{width:l,height:c,position:"absolute",right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:0,...e.style}}):null});function eg(e){return e?parseInt(e,10):0}function eb(e,t){let s=e/t;return isNaN(s)?0:s}function ew(e){let t=eb(e.viewport,e.content),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-s)*t,18)}function eC(e,t,s="ltr"){let r=ew(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=t.scrollbar.size-a,i=t.content-t.viewport,l=(0,V.clamp)(e,"ltr"===s?[0,i]:[-1*i,0]);return eN([0,i],[0,n-r])(l)}function eN(e,t){return s=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(s-e[0])}}var ey=(e,t=()=>{})=>{let s={left:e.scrollLeft,top:e.scrollTop},r=0;return!function a(){let n={left:e.scrollLeft,top:e.scrollTop},i=s.left!==n.left,l=s.top!==n.top;(i||l)&&t(),s=n,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function eS(e,t){let r=(0,z.useCallbackRef)(e),a=s.useRef(0);return s.useEffect(()=>()=>window.clearTimeout(a.current),[]),s.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,t)},[r,t])}function eT(e,t){let s=(0,z.useCallbackRef)(t);(0,W.useLayoutEffect)(()=>{let t=0;if(e){let r=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(s)});return r.observe(e),()=>{window.cancelAnimationFrame(t),r.unobserve(e)}}},[e,s])}let eR=s.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(Z,{ref:a,className:(0,p.cn)("relative overflow-hidden",e),...r,children:[(0,t.jsx)(et,{className:"h-full w-full rounded-[inherit]",children:s}),(0,t.jsx)(ek,{}),(0,t.jsx)(ef,{})]}));eR.displayName=Z.displayName;let ek=s.forwardRef(({className:e,orientation:s="vertical",...r},a)=>(0,t.jsx)(er,{ref:a,orientation:s,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:(0,t.jsx)(ex,{className:"relative flex-1 rounded-full bg-border"})}));ek.displayName=er.displayName;var eE=e.i(772436);function eD(){let{toast:e}=(0,U.useToast)(),[p,y]=(0,s.useState)("conversations"),[_,O]=(0,s.useState)(""),[F,M]=(0,s.useState)("all"),[z,$]=(0,s.useState)(null),[W,V]=(0,s.useState)([]),[Q,X]=(0,s.useState)(!1),[Y,K]=(0,s.useState)(null),[G,J]=(0,s.useState)(!1),{data:Z=[],isLoading:ee,refetch:et}=(0,r.useQuery)({queryKey:["/api/admin/chatbot/conversations"]}),{data:es,isLoading:er}=(0,r.useQuery)({queryKey:["/api/admin/chatbot/analytics"]}),{data:ea=[],isLoading:en,refetch:ei}=(0,r.useQuery)({queryKey:["/api/admin/chatbot/quick-responses"]}),el=(0,a.useMutation)({mutationFn:async({id:e,archived:t})=>(0,n.apiRequest)("PATCH",`/api/admin/chatbot/conversation/${e}`,{archived:t}),onSuccess:()=>{e({title:"Success",description:"Conversation updated successfully"}),et(),z&&$(null)},onError:()=>{e({title:"Error",description:"Failed to update conversation",variant:"destructive"})}}),eo=(0,a.useMutation)({mutationFn:async({id:e,notes:t})=>(0,n.apiRequest)("PATCH",`/api/admin/chatbot/conversation/${e}`,{notes:t}),onSuccess:()=>{e({title:"Success",description:"Notes saved successfully"}),et()},onError:()=>{e({title:"Error",description:"Failed to save notes",variant:"destructive"})}}),ec=(0,a.useMutation)({mutationFn:async e=>e.id?(0,n.apiRequest)("PATCH",`/api/admin/chatbot/quick-responses/${e.id}`,e):(0,n.apiRequest)("POST","/api/admin/chatbot/quick-responses",e),onSuccess:()=>{e({title:"Success",description:"Quick response saved successfully"}),ei(),K(null)},onError:()=>{e({title:"Error",description:"Failed to save quick response",variant:"destructive"})}}),ed=(0,a.useMutation)({mutationFn:async e=>(0,n.apiRequest)("DELETE",`/api/admin/chatbot/quick-responses/${e}`),onSuccess:()=>{e({title:"Success",description:"Quick response deleted successfully"}),ei()},onError:()=>{e({title:"Error",description:"Failed to delete quick response",variant:"destructive"})}}),eu=async t=>{$(t),X(!0);try{let e=await fetch(`/api/admin/chatbot/conversation/${t.id}`);if(e.ok){let t=await e.json();V(t.messages||[])}}catch(t){console.error("Failed to load conversation details:",t),e({title:"Error",description:"Failed to load conversation details",variant:"destructive"})}finally{X(!1)}},eh=async t=>{try{await (0,n.apiRequest)("POST",`/api/admin/chatbot/conversation/${t}/email`),e({title:"Success",description:"Conversation emailed to admin successfully"})}catch(t){e({title:"Error",description:"Failed to email conversation",variant:"destructive"})}},em=async t=>{try{let s=await fetch(`/api/admin/chatbot/export?format=${t}`);if(s.ok){let r=await s.blob(),a=window.URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=`chatbot-conversations-${new Date().toISOString().split("T")[0]}.${t}`,n.click(),window.URL.revokeObjectURL(a),e({title:"Success",description:`Conversations exported as ${t.toUpperCase()}`})}}catch(t){e({title:"Error",description:"Failed to export conversations",variant:"destructive"})}J(!1)},ex=Z.filter(e=>{if("active"===F&&e.archived||"archived"===F&&!e.archived)return!1;if(_){let t=_.toLowerCase();return e.customerName?.toLowerCase().includes(t)||e.customerEmail?.toLowerCase().includes(t)||e.lastMessage?.toLowerCase().includes(t)||e.pageContext?.toLowerCase().includes(t)}return!0});return(0,t.jsxs)("div",{className:"container mx-auto p-6 max-w-7xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"AI Chatbot Management"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Monitor conversations, analyze engagement, and manage responses"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.Button,{onClick:()=>et(),variant:"outline","data-testid":"button-refresh-conversations",children:[(0,t.jsx)(B.RefreshCw,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,t.jsxs)(c.Button,{onClick:()=>J(!0),"data-testid":"button-export-conversations",children:[(0,t.jsx)(I,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),(0,t.jsxs)(m.Tabs,{value:p,onValueChange:y,className:"space-y-4",children:[(0,t.jsxs)(m.TabsList,{className:"grid w-full grid-cols-4",children:[(0,t.jsxs)(m.TabsTrigger,{value:"conversations","data-testid":"tab-conversations",children:[(0,t.jsx)(R.MessageSquare,{className:"w-4 h-4 mr-2"}),"Conversations"]}),(0,t.jsxs)(m.TabsTrigger,{value:"analytics","data-testid":"tab-analytics",children:[(0,t.jsx)(A.TrendingUp,{className:"w-4 h-4 mr-2"}),"Analytics"]}),(0,t.jsxs)(m.TabsTrigger,{value:"quick-responses","data-testid":"tab-quick-responses",children:[(0,t.jsx)(H.Clock,{className:"w-4 h-4 mr-2"}),"Quick Responses"]}),(0,t.jsxs)(m.TabsTrigger,{value:"settings","data-testid":"tab-settings",children:[(0,t.jsx)(S,{className:"w-4 h-4 mr-2"}),"Settings"]})]}),(0,t.jsx)(m.TabsContent,{value:"conversations",className:"space-y-4",children:(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(l.CardTitle,{children:"Recent Conversations"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(k.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(d.Input,{placeholder:"Search conversations...",value:_,onChange:e=>O(e.target.value),className:"pl-8 w-64","data-testid":"input-search-conversations"})]}),(0,t.jsxs)(h.Select,{value:F,onValueChange:e=>M(e),children:[(0,t.jsx)(h.SelectTrigger,{className:"w-32","data-testid":"select-filter-status",children:(0,t.jsx)(h.SelectValue,{})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(h.SelectItem,{value:"active",children:"Active"}),(0,t.jsx)(h.SelectItem,{value:"archived",children:"Archived"})]})]})]})]})}),(0,t.jsx)(l.CardContent,{children:ee?(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,t.jsx)(C.Skeleton,{className:"h-20 w-full"},e))}):(0,t.jsxs)(v,{children:[(0,t.jsx)(f,{children:(0,t.jsxs)(g,{children:[(0,t.jsx)(b,{children:"Customer"}),(0,t.jsx)(b,{children:"Started"}),(0,t.jsx)(b,{children:"Messages"}),(0,t.jsx)(b,{children:"Page"}),(0,t.jsx)(b,{children:"Rating"}),(0,t.jsx)(b,{children:"Status"}),(0,t.jsx)(b,{children:"Actions"})]})}),(0,t.jsx)(j,{children:0===ex.length?(0,t.jsx)(g,{children:(0,t.jsx)(w,{colSpan:7,className:"text-center py-8",children:"No conversations found"})}):ex.map(e=>(0,t.jsxs)(g,{children:[(0,t.jsx)(w,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.customerName||"Anonymous"}),e.customerEmail&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.customerEmail})]})}),(0,t.jsx)(w,{children:(0,i.formatDistanceToNow)(new Date(e.startedAt),{addSuffix:!0})}),(0,t.jsx)(w,{children:e.messageCount||0}),(0,t.jsx)(w,{children:(0,t.jsx)(o.Badge,{variant:"outline",children:e.pageContext||"Unknown"})}),(0,t.jsx)(w,{children:e.rating?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(E.Star,{className:"w-4 h-4 text-yellow-500 mr-1"}),e.rating]}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(w,{children:(0,t.jsx)(o.Badge,{variant:e.archived?"secondary":e.endedAt?"default":"outline",children:e.archived?"Archived":e.endedAt?"Ended":"Active"})}),(0,t.jsx)(w,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.Button,{size:"icon",variant:"ghost",onClick:()=>eu(e),"data-testid":`button-view-conversation-${e.id}`,children:(0,t.jsx)(T.Eye,{className:"w-4 h-4"})}),(0,t.jsx)(c.Button,{size:"icon",variant:"ghost",onClick:()=>eh(e.id),"data-testid":`button-email-conversation-${e.id}`,children:(0,t.jsx)(q.Mail,{className:"w-4 h-4"})}),(0,t.jsx)(c.Button,{size:"icon",variant:"ghost",onClick:()=>el.mutate({id:e.id,archived:!e.archived}),"data-testid":`button-archive-conversation-${e.id}`,children:(0,t.jsx)(S,{className:"w-4 h-4"})})]})})]},e.id))})]})})]})}),(0,t.jsxs)(m.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Total Conversations"}),(0,t.jsx)(R.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:er?(0,t.jsx)(C.Skeleton,{className:"h-8 w-20"}):es?.totalConversations||0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Active Now"}),(0,t.jsx)(P.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:er?(0,t.jsx)(C.Skeleton,{className:"h-8 w-20"}):es?.activeConversations||0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently chatting"})]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Avg Rating"}),(0,t.jsx)(E.Star,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:er?(0,t.jsx)(C.Skeleton,{className:"h-8 w-20"}):es?.averageRating?.toFixed(1)||"N/A"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Out of 5 stars"})]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Feedback"}),(0,t.jsx)(L.ThumbsUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(L.ThumbsUp,{className:"w-4 h-4 text-green-600 mr-1"}),(0,t.jsx)("span",{className:"font-bold",children:es?.totalFeedback?.positive||0})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(D.ThumbsDown,{className:"w-4 h-4 text-red-600 mr-1"}),(0,t.jsx)("span",{className:"font-bold",children:es?.totalFeedback?.negative||0})]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"User feedback"})]})]})]}),es?.commonQuestions&&es.commonQuestions.length>0&&(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{children:[(0,t.jsx)(l.CardTitle,{children:"Common Questions"}),(0,t.jsx)(l.CardDescription,{children:"Most frequently asked questions by customers"})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:es.commonQuestions.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg bg-muted",children:[(0,t.jsx)("span",{className:"flex-1",children:e.question}),(0,t.jsxs)(o.Badge,{variant:"secondary",children:[e.count," times"]})]},s))})})]})]}),(0,t.jsx)(m.TabsContent,{value:"quick-responses",className:"space-y-4",children:(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{children:"Quick Response Templates"}),(0,t.jsx)(l.CardDescription,{children:"Manage predefined responses for common questions"})]}),(0,t.jsx)(c.Button,{onClick:()=>K({}),"data-testid":"button-add-quick-response",children:"Add Response"})]})}),(0,t.jsx)(l.CardContent,{children:en?(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,t.jsx)(C.Skeleton,{className:"h-16 w-full"},e))}):(0,t.jsx)("div",{className:"space-y-2",children:0===ea.length?(0,t.jsx)("p",{className:"text-center py-8 text-muted-foreground",children:"No quick responses configured"}):ea.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.label}),(0,t.jsx)(o.Badge,{variant:"outline",children:e.category}),!e.isActive&&(0,t.jsx)(o.Badge,{variant:"secondary",children:"Inactive"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.message})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.Button,{size:"sm",variant:"ghost",onClick:()=>K(e),"data-testid":`button-edit-quick-response-${e.id}`,children:"Edit"}),(0,t.jsx)(c.Button,{size:"sm",variant:"ghost",onClick:()=>ed.mutate(e.id),"data-testid":`button-delete-quick-response-${e.id}`,children:"Delete"})]})]},e.id))})})]})}),(0,t.jsx)(m.TabsContent,{value:"settings",className:"space-y-4",children:(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{children:[(0,t.jsx)(l.CardTitle,{children:"Chatbot Configuration"}),(0,t.jsx)(l.CardDescription,{children:"Configure chatbot behavior and settings"})]}),(0,t.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{children:"Greeting Message"}),(0,t.jsx)(N.Textarea,{placeholder:"Hi! How can I help you today?",className:"min-h-20","data-testid":"textarea-greeting-message"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{children:"Auto-Response Delay (seconds)"}),(0,t.jsx)(d.Input,{type:"number",defaultValue:"1",min:"0",max:"10","data-testid":"input-response-delay"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.Label,{children:"Session Timeout (minutes)"}),(0,t.jsx)(d.Input,{type:"number",defaultValue:"30",min:"5",max:"120","data-testid":"input-session-timeout"})]}),(0,t.jsx)(c.Button,{className:"w-full","data-testid":"button-save-settings",children:"Save Settings"})]})]})})]}),(0,t.jsx)(x.Dialog,{open:!!z,onOpenChange:()=>$(null),children:(0,t.jsxs)(x.DialogContent,{className:"max-w-4xl max-h-[80vh]",children:[(0,t.jsxs)(x.DialogHeader,{children:[(0,t.jsx)(x.DialogTitle,{children:"Conversation Details"}),(0,t.jsx)(x.DialogDescription,{children:z&&(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,t.jsx)(o.Badge,{children:z.pageContext||"Unknown Page"}),(0,t.jsxs)("span",{className:"text-sm",children:["Started ",(0,i.formatDistanceToNow)(new Date(z.startedAt),{addSuffix:!0})]}),z.rating&&(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(E.Star,{className:"w-4 h-4 text-yellow-500 mr-1"}),z.rating,"/5"]})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsx)(eR,{className:"h-[400px] border rounded-lg p-4",children:Q?(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,t.jsx)(C.Skeleton,{className:"h-16 w-full"},e))}):(0,t.jsx)("div",{className:"space-y-4",children:W.map(e=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[70%] p-3 rounded-lg ${"user"===e.role?"bg-primary text-primary-foreground":"bg-muted"}`,children:[e.imageUrl&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)("img",{src:e.imageUrl,alt:"Uploaded",className:"rounded-lg max-w-full"})}),(0,t.jsx)("p",{className:"text-sm",children:e.content}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,t.jsx)("span",{className:"text-xs opacity-70",children:(0,i.formatDistanceToNow)(new Date(e.timestamp),{addSuffix:!0})}),"assistant"===e.role&&e.feedback&&(0,t.jsx)("div",{className:"flex items-center",children:"positive"===e.feedback?(0,t.jsx)(L.ThumbsUp,{className:"w-3 h-3 text-green-600"}):(0,t.jsx)(D.ThumbsDown,{className:"w-3 h-3 text-red-600"})})]})]})},e.id))})})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Internal Notes"}),(0,t.jsx)(N.Textarea,{placeholder:"Add notes about this conversation...",value:z?.notes||"",onChange:e=>{z&&$({...z,notes:e.target.value})},className:"min-h-32 mt-2","data-testid":"textarea-conversation-notes"}),(0,t.jsx)(c.Button,{className:"w-full mt-2",onClick:()=>{z&&z.notes&&eo.mutate({id:z.id,notes:z.notes})},"data-testid":"button-save-notes",children:"Save Notes"})]}),(0,t.jsx)(eE.Separator,{}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Button,{className:"w-full",variant:"outline",onClick:()=>z&&eh(z.id),"data-testid":"button-email-conversation-detail",children:[(0,t.jsx)(q.Mail,{className:"w-4 h-4 mr-2"}),"Email Conversation"]}),(0,t.jsxs)(c.Button,{className:"w-full",variant:"outline",onClick:()=>{z&&el.mutate({id:z.id,archived:!z.archived})},"data-testid":"button-archive-conversation-detail",children:[(0,t.jsx)(S,{className:"w-4 h-4 mr-2"}),z?.archived?"Unarchive":"Archive"]})]})]})]})]})}),(0,t.jsx)(x.Dialog,{open:!!Y,onOpenChange:()=>K(null),children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsx)(x.DialogHeader,{children:(0,t.jsxs)(x.DialogTitle,{children:[Y?.id?"Edit":"Add"," Quick Response"]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Label"}),(0,t.jsx)(d.Input,{value:Y?.label||"",onChange:e=>K({...Y,label:e.target.value}),placeholder:"e.g., Schedule Service","data-testid":"input-quick-response-label"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Message"}),(0,t.jsx)(N.Textarea,{value:Y?.message||"",onChange:e=>K({...Y,message:e.target.value}),placeholder:"The message that will be sent...",className:"min-h-24","data-testid":"textarea-quick-response-message"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Category"}),(0,t.jsxs)(h.Select,{value:Y?.category||"general",onValueChange:e=>K({...Y,category:e}),children:[(0,t.jsx)(h.SelectTrigger,{"data-testid":"select-quick-response-category",children:(0,t.jsx)(h.SelectValue,{})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"general",children:"General"}),(0,t.jsx)(h.SelectItem,{value:"service",children:"Service"}),(0,t.jsx)(h.SelectItem,{value:"emergency",children:"Emergency"}),(0,t.jsx)(h.SelectItem,{value:"pricing",children:"Pricing"}),(0,t.jsx)(h.SelectItem,{value:"hours",children:"Hours"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Sort Order"}),(0,t.jsx)(d.Input,{type:"number",value:Y?.sortOrder||0,onChange:e=>K({...Y,sortOrder:parseInt(e.target.value)||0}),min:"0","data-testid":"input-quick-response-sort-order"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"quick-response-active",checked:Y?.isActive!==!1,onChange:e=>K({...Y,isActive:e.target.checked}),"data-testid":"checkbox-quick-response-active"}),(0,t.jsx)(u.Label,{htmlFor:"quick-response-active",children:"Active"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(c.Button,{variant:"outline",onClick:()=>K(null),"data-testid":"button-cancel-quick-response",children:"Cancel"}),(0,t.jsx)(c.Button,{onClick:()=>ec.mutate(Y),"data-testid":"button-save-quick-response",children:"Save"})]})]})]})}),(0,t.jsx)(x.Dialog,{open:G,onOpenChange:J,children:(0,t.jsxs)(x.DialogContent,{children:[(0,t.jsxs)(x.DialogHeader,{children:[(0,t.jsx)(x.DialogTitle,{children:"Export Conversations"}),(0,t.jsx)(x.DialogDescription,{children:"Choose the format for exporting conversation data"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.Button,{className:"flex-1",onClick:()=>em("csv"),"data-testid":"button-export-csv",children:"Export as CSV"}),(0,t.jsx)(c.Button,{className:"flex-1",variant:"outline",onClick:()=>em("json"),"data-testid":"button-export-json",children:"Export as JSON"})]})]})})]})}e.s(["default",()=>eD],461288)}]);