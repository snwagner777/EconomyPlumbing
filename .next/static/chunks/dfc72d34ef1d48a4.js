(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,870273,e=>{"use strict";let t=(0,e.i(475254).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);e.s(["Star",()=>t],870273)},87316,e=>{"use strict";let t=(0,e.i(475254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},531278,e=>{"use strict";let t=(0,e.i(475254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],531278)},686311,e=>{"use strict";let t=(0,e.i(475254).default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);e.s(["MessageSquare",()=>t],686311)},400417,e=>{"use strict";let t=(0,e.i(475254).default)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);e.s(["ThumbsUp",()=>t],400417)},63209,e=>{"use strict";let t=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},212426,e=>{"use strict";let t=(0,e.i(475254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],212426)},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},195116,e=>{"use strict";let t=(0,e.i(475254).default)("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);e.s(["Wrench",()=>t],195116)},326999,e=>{"use strict";var t=e.i(271645),s=e.i(981140),a=e.i(820783),i=e.i(30030),n=e.i(610772),l=e.i(369340),r=e.i(726330),o=e.i(765491),c=e.i(774606),d=e.i(296626),u=e.i(248425),m=e.i(303536),p=e.i(985369),h=e.i(186312),x=e.i(991918),f=e.i(843476),g="Dialog",[y,j]=(0,i.createContextScope)(g),[v,b]=y(g),w=e=>{let{__scopeDialog:s,children:a,open:i,defaultOpen:r,onOpenChange:o,modal:c=!0}=e,d=t.useRef(null),u=t.useRef(null),[m=!1,p]=(0,l.useControllableState)({prop:i,defaultProp:r,onChange:o});return(0,f.jsx)(v,{scope:s,triggerRef:d,contentRef:u,contentId:(0,n.useId)(),titleId:(0,n.useId)(),descriptionId:(0,n.useId)(),open:m,onOpenChange:p,onOpenToggle:t.useCallback(()=>p(e=>!e),[p]),modal:c,children:a})};w.displayName=g;var N="DialogTrigger",C=t.forwardRef((e,t)=>{let{__scopeDialog:i,...n}=e,l=b(N,i),r=(0,a.useComposedRefs)(t,l.triggerRef);return(0,f.jsx)(u.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":U(l.open),...n,ref:r,onClick:(0,s.composeEventHandlers)(e.onClick,l.onOpenToggle)})});C.displayName=N;var k="DialogPortal",[D,I]=y(k,{forceMount:void 0}),S=e=>{let{__scopeDialog:s,forceMount:a,children:i,container:n}=e,l=b(k,s);return(0,f.jsx)(D,{scope:s,forceMount:a,children:t.Children.map(i,e=>(0,f.jsx)(d.Presence,{present:a||l.open,children:(0,f.jsx)(c.Portal,{asChild:!0,container:n,children:e})}))})};S.displayName=k;var R="DialogOverlay",T=t.forwardRef((e,t)=>{let s=I(R,e.__scopeDialog),{forceMount:a=s.forceMount,...i}=e,n=b(R,e.__scopeDialog);return n.modal?(0,f.jsx)(d.Presence,{present:a||n.open,children:(0,f.jsx)(z,{...i,ref:t})}):null});T.displayName=R;var P=(0,x.createSlot)("DialogOverlay.RemoveScroll"),z=t.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,i=b(R,s);return(0,f.jsx)(p.RemoveScroll,{as:P,allowPinchZoom:!0,shards:[i.contentRef],children:(0,f.jsx)(u.Primitive.div,{"data-state":U(i.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),E="DialogContent",O=t.forwardRef((e,t)=>{let s=I(E,e.__scopeDialog),{forceMount:a=s.forceMount,...i}=e,n=b(E,e.__scopeDialog);return(0,f.jsx)(d.Presence,{present:a||n.open,children:n.modal?(0,f.jsx)(A,{...i,ref:t}):(0,f.jsx)(H,{...i,ref:t})})});O.displayName=E;var A=t.forwardRef((e,i)=>{let n=b(E,e.__scopeDialog),l=t.useRef(null),r=(0,a.useComposedRefs)(i,n.contentRef,l);return t.useEffect(()=>{let e=l.current;if(e)return(0,h.hideOthers)(e)},[]),(0,f.jsx)($,{...e,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,s.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:(0,s.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey;(2===t.button||s)&&e.preventDefault()}),onFocusOutside:(0,s.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault())})}),H=t.forwardRef((e,s)=>{let a=b(E,e.__scopeDialog),i=t.useRef(!1),n=t.useRef(!1);return(0,f.jsx)($,{...e,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(i.current||a.triggerRef.current?.focus(),t.preventDefault()),i.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));let s=t.target;a.triggerRef.current?.contains(s)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),$=t.forwardRef((e,s)=>{let{__scopeDialog:i,trapFocus:n,onOpenAutoFocus:l,onCloseAutoFocus:c,...d}=e,u=b(E,i),p=t.useRef(null),h=(0,a.useComposedRefs)(s,p);return(0,m.useFocusGuards)(),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.FocusScope,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:l,onUnmountAutoFocus:c,children:(0,f.jsx)(r.DismissableLayer,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":U(u.open),...d,ref:h,onDismiss:()=>u.onOpenChange(!1)})}),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(X,{titleId:u.titleId}),(0,f.jsx)(Z,{contentRef:p,descriptionId:u.descriptionId})]})]})}),M="DialogTitle",B=t.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,i=b(M,s);return(0,f.jsx)(u.Primitive.h2,{id:i.titleId,...a,ref:t})});B.displayName=M;var F="DialogDescription",_=t.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,i=b(F,s);return(0,f.jsx)(u.Primitive.p,{id:i.descriptionId,...a,ref:t})});_.displayName=F;var q="DialogClose",W=t.forwardRef((e,t)=>{let{__scopeDialog:a,...i}=e,n=b(q,a);return(0,f.jsx)(u.Primitive.button,{type:"button",...i,ref:t,onClick:(0,s.composeEventHandlers)(e.onClick,()=>n.onOpenChange(!1))})});function U(e){return e?"open":"closed"}W.displayName=q;var L="DialogTitleWarning",[V,K]=(0,i.createContext)(L,{contentName:E,titleName:M,docsSlug:"dialog"}),X=({titleId:e})=>{let s=K(L),a=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return t.useEffect(()=>{e&&(document.getElementById(e)||console.error(a))},[a,e]),null},Z=({contentRef:e,descriptionId:s})=>{let a=K("DialogDescriptionWarning"),i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${a.contentName}}.`;return t.useEffect(()=>{let t=e.current?.getAttribute("aria-describedby");s&&t&&(document.getElementById(s)||console.warn(i))},[i,e,s]),null};e.s(["Close",()=>W,"Content",()=>O,"Description",()=>_,"Overlay",()=>T,"Portal",()=>S,"Root",()=>w,"Title",()=>B,"Trigger",()=>C])},776639,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(326999),i=e.i(37727),n=e.i(975157);let l=a.Root;a.Trigger;let r=a.Portal;a.Close;let o=s.forwardRef(({className:e,...s},i)=>(0,t.jsx)(a.Overlay,{ref:i,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));o.displayName=a.Overlay.displayName;let c=s.forwardRef(({className:e,children:s,...l},c)=>(0,t.jsxs)(r,{children:[(0,t.jsx)(o,{}),(0,t.jsxs)(a.Content,{ref:c,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...l,children:[s,(0,t.jsxs)(a.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(i.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));c.displayName=a.Content.displayName;let d=({className:e,...s})=>(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});d.displayName="DialogHeader";let u=({className:e,...s})=>(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});u.displayName="DialogFooter";let m=s.forwardRef(({className:e,...s},i)=>(0,t.jsx)(a.Title,{ref:i,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));m.displayName=a.Title.displayName;let p=s.forwardRef(({className:e,...s},i)=>(0,t.jsx)(a.Description,{ref:i,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));p.displayName=a.Description.displayName,e.s(["Dialog",()=>l,"DialogContent",()=>c,"DialogDescription",()=>p,"DialogFooter",()=>u,"DialogHeader",()=>d,"DialogTitle",()=>m])},727612,e=>{"use strict";let t=(0,e.i(475254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],727612)},514764,e=>{"use strict";let t=(0,e.i(475254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],514764)},803408,e=>{"use strict";let t=(0,e.i(475254).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>t])},735501,e=>{"use strict";var t=e.i(803408);e.s(["ImageIcon",()=>t.default])},365582,e=>{"use strict";let t=(0,e.i(475254).default)("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);e.s(["ThumbsDown",()=>t],365582)},891987,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(174080),i=e.i(618566),n=e.i(519455),l=e.i(515288),r=e.i(793479),o=e.i(487486),c=e.i(776639),d=e.i(475254);let u=(0,d.default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var m=e.i(37727),p=e.i(514764),h=e.i(343432),x=e.i(686311),f=e.i(531278);let g=(0,d.default)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);var y=e.i(400417),j=e.i(365582),v=e.i(735501),b=e.i(870273),w=e.i(727612),N=e.i(269638),C=e.i(63209);let k=(0,d.default)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var D=e.i(503116),I=e.i(212426),S=e.i(87316),R=e.i(195116);e.i(573690);var T=e.i(829682),P=e.i(437453),z=e.i(975157),E=e.i(74223);function O(){try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.value=800,t.type="sine",s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5)}catch(e){console.log("Could not play notification sound:",e)}}let A="chatbot_conversations",H=[{label:"Emergency Service",message:"I need emergency plumbing service",icon:"AlertCircle"},{label:"Get Quote",message:"I'd like to get a quote for plumbing services",icon:"DollarSign"},{label:"Schedule Service",message:"I want to schedule a service appointment",icon:"Calendar"},{label:"Water Heater Issue",message:"I'm having issues with my water heater",icon:"Wrench"},{label:"Business Hours",message:"What are your business hours?",icon:"Clock"},{label:"Service Areas",message:"What areas do you service?",icon:"HelpCircle"}],$={AlertCircle:C.AlertCircle,DollarSign:I.DollarSign,Calendar:S.Calendar,Wrench:R.Wrench,Clock:D.Clock,HelpCircle:k,CheckCircle:N.CheckCircle};function M(){let e,d=(0,i.usePathname)()||"/",[N,C]=(0,s.useState)(!1),[k,D]=(0,s.useState)(!1),[I,S]=(0,s.useState)([]),[R,M]=(0,s.useState)(""),[B,F]=(0,s.useState)(!1),[_,q]=(0,s.useState)(!1),[W,U]=(0,s.useState)(!1),[L,V]=(0,s.useState)(""),[K,X]=(0,s.useState)(""),[Z,G]=(0,s.useState)(H),[J,Q]=(0,s.useState)(0),[Y,ee]=(0,s.useState)(!1),[et,es]=(0,s.useState)(0),[ea,ei]=(0,s.useState)(null),[en,el]=(0,s.useState)(!1),er=(0,s.useRef)(null),eo=(0,s.useRef)(null),ec=(0,T.usePhoneConfig)(),ed=function(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}();if(d.startsWith("/admin")||!ec||!ec.tel||!ec.display)return null;(0,s.useEffect)(()=>{let e=localStorage.getItem(A);if(e)try{let t=JSON.parse(e);Date.now()-t.lastActivity<18e5?(V(t.sessionId),X(t.conversationId),S(t.messages||[])):eu()}catch(e){console.error("Failed to load conversation:",e),eu()}else eu()},[]);let eu=()=>{let e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t=`conv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;V(e),X(t),S([]),em(e,t,[])},em=(e,t,s)=>{let a={sessionId:e,conversationId:t,messages:s,lastActivity:Date.now(),pageContext:d,rating:et||void 0};localStorage.setItem(A,JSON.stringify(a))};(0,s.useEffect)(()=>{L&&K&&em(L,K,I)},[I,L,K,et]),(0,s.useEffect)(()=>{!N&&I.length>0&&"assistant"===I[I.length-1].role&&(Q(e=>e+1),O())},[I,N]),(0,s.useEffect)(()=>{N&&Q(0)},[N]),(0,s.useEffect)(()=>{k||eo.current?.scrollIntoView({behavior:"smooth"})},[I,k]),(0,s.useEffect)(()=>{N&&0===I.length&&S([{id:`msg_${Date.now()}`,role:"assistant",content:"Hi! I'm Economy Plumbing's AI assistant. I can help you with:\n\n• Water heater questions\n• Pricing estimates\n• Scheduling appointments\n• Emergency plumbing info\n• Common plumbing issues\n\nWhat can I help you with today?",timestamp:Date.now()}])},[N,I.length]);let ep=async e=>{let t=e||R.trim();if(!t&&!ea||B)return;let s={id:`msg_${Date.now()}`,role:"user",content:t||"I've uploaded an image of my plumbing issue",timestamp:Date.now()};M("");let a=[...I,s];S(a),F(!0),U(!0);try{if(ea){el(!0);let e=new FormData;e.append("image",ea),e.append("sessionId",L),e.append("conversationId",K);let t=await (0,P.apiRequest)("POST","/api/chatbot/upload-image",e);s.imageUrl=(await t.json()).imageUrl,ei(null),el(!1)}let e=await (0,P.apiRequest)("POST","/api/chatbot",{messages:a.map(e=>({role:e.role,content:e.content,imageUrl:e.imageUrl})),sessionId:L,conversationId:K,pageContext:d}),t=await e.json();t.quickResponses&&t.quickResponses.length>0&&G(t.quickResponses);let i={id:`msg_${Date.now()}`,role:"assistant",content:t.message,timestamp:Date.now(),needsHandoff:t.needsHandoff};if(t.needsHandoff&&q(!0),t.openScheduler&&!await (0,E.openScheduler)()){let e={id:`msg_${Date.now()+1}`,role:"assistant",content:"I'm having trouble opening the scheduler right now. Please call us at "+ec.display+" to book your appointment, or you can try refreshing the page and clicking the 'Schedule Service' button.",timestamp:Date.now()};S([...a,i,e]);return}S([...a,i]),(!N||k)&&O()}catch(e){console.error("Chatbot error:",e),S([...a,{id:`msg_${Date.now()}`,role:"assistant",content:`I'm having trouble connecting right now. Please text us directly at ${ec.display} or call for immediate assistance.`,timestamp:Date.now(),needsHandoff:!0}]),q(!0)}finally{F(!1),U(!1)}},eh=async(e,t)=>{if(e){S(s=>s.map(s=>s.id===e?{...s,feedback:t}:s));try{await (0,P.apiRequest)("POST","/api/chatbot/feedback",{messageId:e,conversationId:K,feedback:t})}catch(e){console.error("Failed to send feedback:",e)}}},ex=async e=>{es(e),ee(!1);try{await (0,P.apiRequest)("POST","/api/chatbot/end-conversation",{conversationId:K,rating:e})}catch(e){console.error("Failed to submit rating:",e)}let t={id:`msg_${Date.now()}`,role:"assistant",content:"Thank you for your feedback! Is there anything else I can help you with?",timestamp:Date.now()};S(e=>[...e,t])},ef=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ep())},eg=()=>{window.location.href=`sms:${ec.tel}`},ey=Y&&(0,t.jsx)(c.Dialog,{open:Y,onOpenChange:ee,children:(0,t.jsxs)(c.DialogContent,{children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:"How was your experience?"}),(0,t.jsx)(c.DialogDescription,{children:"Please rate your conversation to help us improve our service"})]}),(0,t.jsx)("div",{className:"flex justify-center gap-2 py-4",children:[1,2,3,4,5].map(e=>(0,t.jsx)("button",{onClick:()=>ex(e),className:"hover:scale-110 transition-transform","data-testid":`button-rating-${e}`,children:(0,t.jsx)(b.Star,{className:(0,z.cn)("w-8 h-8",e<=et?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},e))})]})});return e=N?k?(0,t.jsxs)("div",{className:(0,z.cn)("fixed bg-background border rounded-lg shadow-lg p-3 flex items-center gap-3 cursor-pointer hover:shadow-xl transition-shadow",ed?"bottom-4 left-4 right-4":"bottom-6 right-6"),style:{zIndex:9999},onClick:()=>D(!1),children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:(0,t.jsx)(u,{className:"w-4 h-4 text-primary-foreground"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-semibold",children:"Economy Plumbing AI"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Click to expand"})]}),J>0&&(0,t.jsxs)(o.Badge,{className:"animate-pulse",children:[J," new"]}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:e=>{e.stopPropagation(),C(!1),D(!1)},"data-testid":"button-close-minimized",children:(0,t.jsx)(m.X,{className:"w-4 h-4"})})]}):ed&&!k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l.Card,{className:"shadow-2xl flex flex-col",style:{position:"fixed",left:0,right:0,bottom:0,width:"100%",height:"calc(100vh - 80px)",borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem",borderBottomLeftRadius:0,borderBottomRightRadius:0,zIndex:9999},children:[(0,t.jsx)(l.CardHeader,{className:"pb-3 border-b flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:(0,t.jsx)(u,{className:"w-5 h-5 text-primary-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-base",children:"Economy Plumbing AI"}),(0,t.jsxs)(l.CardDescription,{className:"text-xs flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Online ",d&&`• ${d.substring(1)||"home"}`]})]})]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>{S([]),q(!1),eu(),localStorage.removeItem(A),S([{id:`msg_${Date.now()}`,role:"assistant",content:"Hi! I've cleared our previous conversation. How can I help you today?",timestamp:Date.now()}])},className:"h-8 w-8","data-testid":"button-clear-chat",children:(0,t.jsx)(w.Trash2,{className:"w-4 h-4"})}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>D(!0),className:"h-8 w-8","data-testid":"button-minimize-chatbot",children:(0,t.jsx)(g,{className:"w-4 h-4"})}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>C(!1),className:"h-8 w-8","data-testid":"button-close-chatbot",children:(0,t.jsx)(m.X,{className:"w-4 h-4"})})]})]})}),(0,t.jsxs)(l.CardContent,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[I.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:(0,z.cn)("max-w-[85%] rounded-lg px-4 py-2","user"===e.role?"bg-primary text-primary-foreground":"bg-muted"),"data-testid":`message-${e.role}-${s}`,children:[(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),e.imageUrl&&(0,t.jsx)("img",{src:e.imageUrl,alt:"Uploaded plumbing issue",className:"mt-2 rounded-md max-w-full h-auto"})]})}),"assistant"===e.role&&(0,t.jsxs)("div",{className:"flex justify-start mt-2 gap-2 ml-2",children:[(0,t.jsx)(n.Button,{variant:"positive"===e.feedback?"default":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>eh(e.id,"positive"),"data-testid":`button-feedback-positive-${s}`,children:(0,t.jsx)(y.ThumbsUp,{className:"w-3 h-3"})}),(0,t.jsx)(n.Button,{variant:"negative"===e.feedback?"default":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>eh(e.id,"negative"),"data-testid":`button-feedback-negative-${s}`,children:(0,t.jsx)(j.ThumbsDown,{className:"w-3 h-3"})})]})]},e.id||s)),W&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)("div",{className:"bg-muted rounded-lg px-4 py-3 flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,t.jsx)("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,t.jsx)("span",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Typing..."})]})}),_&&(0,t.jsx)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4 space-y-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.Phone,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-semibold",children:"Ready to Connect?"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Text us for personalized help from our team. We respond within minutes!"}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(n.Button,{onClick:eg,className:"w-full","data-testid":"button-text-us",children:[(0,t.jsx)(x.MessageSquare,{className:"w-4 h-4 mr-2"}),"Text Us: ",ec.display]}),(0,t.jsx)(n.Button,{asChild:!0,variant:"outline",className:"w-full","data-testid":"button-call-us",children:(0,t.jsxs)("a",{href:`tel:${ec.tel}`,children:[(0,t.jsx)(h.Phone,{className:"w-4 h-4 mr-2"}),"Or Call: ",ec.display]})})]})]})]})}),(0,t.jsx)("div",{ref:eo})]}),Z.length>0&&!B&&(0,t.jsx)("div",{className:"border-t px-3 py-2 flex-shrink-0",children:(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:Z.slice(0,3).map((e,s)=>{let a=$[e.icon||"HelpCircle"];return(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"flex-shrink-0 text-xs",onClick:()=>ep(e.message),"data-testid":`button-quick-response-${s}`,children:[a&&(0,t.jsx)(a,{className:"w-3 h-3 mr-1"}),e.label]},s)})})}),(0,t.jsxs)("div",{className:"border-t p-3 flex-shrink-0",children:[ea&&(0,t.jsxs)("div",{className:"mb-2 p-2 bg-muted rounded-md flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs truncate",children:ea.name}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>ei(null),children:(0,t.jsx)(m.X,{className:"w-3 h-3"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.Input,{value:R,onChange:e=>M(e.target.value),onKeyPress:ef,placeholder:"Ask me anything...",disabled:B,className:"flex-1","data-testid":"input-chat-message"}),(0,t.jsx)("input",{type:"file",ref:er,onChange:e=>{let t=e.target.files?.[0];t&&ei(t)},accept:"image/*",className:"hidden"}),(0,t.jsx)(n.Button,{onClick:()=>er.current?.click(),disabled:B,size:"icon",variant:"outline","data-testid":"button-upload-image",children:(0,t.jsx)(v.ImageIcon,{className:"w-4 h-4"})}),(0,t.jsx)(n.Button,{onClick:()=>ep(),disabled:!R.trim()&&!ea||B,size:"icon","data-testid":"button-send-message",children:en?(0,t.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(p.Send,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"AI responses may vary. For urgent issues, call us."}),(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{ee(!0)},className:"text-xs h-auto p-0","data-testid":"button-end-conversation",children:"End Chat"})]})]})]}),ey]}):(0,t.jsxs)(l.Card,{className:"shadow-2xl flex flex-col rounded-lg",style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"24rem",height:"600px",zIndex:9999},children:[(0,t.jsx)(l.CardHeader,{className:"pb-3 border-b flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:(0,t.jsx)(u,{className:"w-5 h-5 text-primary-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-base",children:"Economy Plumbing AI"}),(0,t.jsxs)(l.CardDescription,{className:"text-xs flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Online"]})]})]}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>C(!1),"data-testid":"button-close-chatbot",children:(0,t.jsx)(m.X,{className:"w-4 h-4"})})]})}),(0,t.jsxs)(l.CardContent,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[I.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsx)("div",{className:`max-w-[85%] rounded-lg px-4 py-2 ${"user"===e.role?"bg-primary text-primary-foreground":"bg-muted"}`,"data-testid":`message-${e.role}-${s}`,children:(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})})},s)),B&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)("div",{className:"bg-muted rounded-lg px-4 py-3 flex items-center gap-2",children:[(0,t.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Thinking..."})]})}),_&&(0,t.jsx)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4 space-y-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.Phone,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-semibold",children:"Ready to Connect?"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Text us for personalized help from our team. We respond within minutes!"}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(n.Button,{onClick:eg,className:"w-full","data-testid":"button-text-us",children:[(0,t.jsx)(x.MessageSquare,{className:"w-4 h-4 mr-2"}),"Text Us: ",ec.display]}),(0,t.jsx)(n.Button,{asChild:!0,variant:"outline",className:"w-full","data-testid":"button-call-us",children:(0,t.jsxs)("a",{href:`tel:${ec.tel}`,children:[(0,t.jsx)(h.Phone,{className:"w-4 h-4 mr-2"}),"Or Call: ",ec.display]})})]})]})]})}),(0,t.jsx)("div",{ref:eo})]}),(0,t.jsxs)("div",{className:"border-t p-3 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.Input,{value:R,onChange:e=>M(e.target.value),onKeyPress:ef,placeholder:"Ask me anything...",disabled:B,className:"flex-1","data-testid":"input-chat-message"}),(0,t.jsx)(n.Button,{onClick:()=>ep(),disabled:!R.trim()||B,size:"icon","data-testid":"button-send-message",children:(0,t.jsx)(p.Send,{className:"w-4 h-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"AI responses may be inaccurate. For urgent issues, text or call us directly."})]})]}):(0,t.jsxs)("div",{className:"relative",style:{position:"fixed",bottom:ed?"1rem":"1.5rem",right:ed?"1rem":"1.5rem",zIndex:9999},children:[(0,t.jsx)(n.Button,{onClick:()=>C(!0),className:"h-14 w-14 rounded-full shadow-lg hover:scale-110 transition-transform",size:"icon","data-testid":"button-open-chatbot",children:(0,t.jsx)(u,{className:"w-6 h-6"})}),J>0&&(0,t.jsx)(o.Badge,{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0 flex items-center justify-center animate-pulse",children:J})]}),(0,a.createPortal)(e,document.body)}e.s(["default",()=>M],891987)},742853,e=>{e.n(e.i(891987))}]);