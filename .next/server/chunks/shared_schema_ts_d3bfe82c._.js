module.exports=[90337,e=>{"use strict";var t=e.i(18899),a=e.i(94093),o=e.i(84259),i=e.i(23624),r=e.i(3090),n=e.i(70988),l=e.i(2847),d=e.i(44988),s=e.i(4775);class u{constructor(e,t){this.unique=e,this.name=t}static [d.entityKind]="PgIndexBuilderOn";on(...e){return new m(e.map(e=>{if((0,d.is)(e,t.SQL))return e;let a=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),a}),this.unique,!1,this.name)}onOnly(...e){return new m(e.map(e=>{if((0,d.is)(e,t.SQL))return e;let a=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,a}),this.unique,!0,this.name)}using(e,...a){return new m(a.map(e=>{if((0,d.is)(e,t.SQL))return e;let a=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),a}),this.unique,!0,this.name,e)}}class m{static [d.entityKind]="PgIndexBuilder";config;constructor(e,t,a,o,i="btree"){this.config={name:o,columns:e,unique:t,only:a,method:i}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new _(this.config,e)}}class _{static [d.entityKind]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}function c(e){return new u(!1,e)}function p(e){return new u(!0,e)}var x=e.i(90429),g=e.i(38257),f=e.i(69e3),N=e.i(4313),b=e.i(56325),y=e.i(22632);let I={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:0xffffff,INT32_MIN:-0x80000000,INT32_MAX:0x7fffffff,INT32_UNSIGNED_MAX:0xffffffff,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-0x8000000000000000n,INT64_MAX:0x7fffffffffffffffn,INT64_UNSIGNED_MAX:0xffffffffffffffffn};function h(e,t){return t.includes(e.columnType)}let v=y.z.union([y.z.string(),y.z.number(),y.z.boolean(),y.z.null()]),A=y.z.union([v,y.z.record(y.z.any()),y.z.array(y.z.any())]),T=y.z.custom(e=>e instanceof Buffer);function S(e){return(0,f.isTable)(e)?(0,N.getTableColumns)(e):(0,N.getViewSelectedFields)(e)}let w={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},q=(e,a)=>(function e(a,o,i,r){let n={};for(let[l,s]of Object.entries(a)){if(!(0,d.is)(s,b.Column)&&!(0,d.is)(s,t.SQL)&&!(0,d.is)(s,t.SQL.Aliased)&&"object"==typeof s){let a=(0,f.isTable)(s)||(0,t.isView)(s)?S(s):s;n[l]=e(a,o[l]??{},i,r);continue}let a=o[l];if(void 0!==a&&"function"!=typeof a){n[l]=a;continue}let u=(0,d.is)(s,b.Column)?s:void 0,m=u?function e(t,a){let o,i=a?.zodInstance??y.z,r=a?.coerce??{};return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0&&(o=t.enumValues.length?i.enum(t.enumValues):i.string()),o||(h(t,["PgGeometry","PgPointTuple"])?o=i.tuple([i.number(),i.number()]):h(t,["PgGeometryObject","PgPointObject"])?o=i.object({x:i.number(),y:i.number()}):h(t,["PgHalfVector","PgVector"])?(o=i.array(i.number()),o=t.dimensions?o.length(t.dimensions):o):h(t,["PgLine"])?o=i.tuple([i.number(),i.number(),i.number()]):h(t,["PgLineABC"])?o=i.object({a:i.number(),b:i.number(),c:i.number()}):h(t,["PgArray"])?(o=i.array(e(t.baseColumn,i)),o=t.size?o.length(t.size):o):"array"===t.dataType?o=i.array(i.any()):"number"===t.dataType?o=function(e,t,a){let o,i,r=e.getSQLType().includes("unsigned"),n=!1;h(e,["MySqlTinyInt","SingleStoreTinyInt"])?(o=r?0:I.INT8_MIN,i=r?I.INT8_UNSIGNED_MAX:I.INT8_MAX,n=!0):h(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(o=r?0:I.INT16_MIN,i=r?I.INT16_UNSIGNED_MAX:I.INT16_MAX,n=!0):h(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(o=r?0:I.INT24_MIN,i=r?I.INT24_UNSIGNED_MAX:I.INT24_MAX,n=h(e,["MySqlMediumInt","SingleStoreMediumInt"])):h(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(o=r?0:I.INT32_MIN,i=r?I.INT32_UNSIGNED_MAX:I.INT32_MAX,n=!0):h(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(o=r?0:I.INT48_MIN,i=r?I.INT48_UNSIGNED_MAX:I.INT48_MAX):h(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(o=(r=r||h(e,["MySqlSerial","SingleStoreSerial"]))?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,n=!0):h(e,["MySqlYear","SingleStoreYear"])?(o=1901,i=2155,n=!0):(o=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let l=!0===a||a?.number?t.coerce.number():t.number();return l=l.min(o).max(i),n?l.int():l}(t,i,r):"bigint"===t.dataType?o=function(e,t,a){let o=e.getSQLType().includes("unsigned"),i=o?0n:I.INT64_MIN,r=o?I.INT64_UNSIGNED_MAX:I.INT64_MAX;return(!0===a||a?.bigint?t.coerce.bigint():t.bigint()).min(i).max(r)}(t,i,r):"boolean"===t.dataType?o=!0===r||r.boolean?i.coerce.boolean():i.boolean():"date"===t.dataType?o=!0===r||r.date?i.coerce.date():i.date():"string"===t.dataType?o=function(e,t,a){let o,i;if(h(e,["PgUUID"]))return t.string().uuid();let r=!1;h(e,["PgVarchar","SQLiteText"])?o=e.length:h(e,["MySqlVarChar","SingleStoreVarChar"])?o=e.length??I.INT16_UNSIGNED_MAX:h(e,["MySqlText","SingleStoreText"])&&(o="longtext"===e.textType?I.INT32_UNSIGNED_MAX:"mediumtext"===e.textType?I.INT24_UNSIGNED_MAX:"text"===e.textType?I.INT16_UNSIGNED_MAX:I.INT8_UNSIGNED_MAX),h(e,["PgChar","MySqlChar","SingleStoreChar"])&&(o=e.length,r=!0),h(e,["PgBinaryVector"])&&(i=/^[01]+$/,o=e.dimensions);let n=!0===a||a?.string?t.coerce.string():t.string();return n=i?n.regex(i):n,o&&r?n.length(o):o?n.max(o):n}(t,i,r):"json"===t.dataType?o=A:"custom"===t.dataType?o=i.any():"buffer"===t.dataType&&(o=T)),o||(o=i.any()),o}(u,r):y.z.any(),_="function"==typeof a?a(m):m;!i.never(u)&&(n[l]=_,u&&(i.nullable(u)&&(n[l]=n[l].nullable()),i.optional(u)&&(n[l]=n[l].optional())))}return y.z.object(n)})(S(e),a??{},w),k=(0,a.pgTable)("users",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),username:(0,o.text)("username").notNull().unique(),password:(0,o.text)("password").notNull()}),C=(0,a.pgTable)("oauth_users",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),email:(0,i.varchar)("email").unique(),firstName:(0,i.varchar)("first_name"),lastName:(0,i.varchar)("last_name"),profileImageUrl:(0,i.varchar)("profile_image_url"),createdAt:(0,r.timestamp)("created_at").defaultNow(),updatedAt:(0,r.timestamp)("updated_at").defaultNow()}),j=(0,a.pgTable)("sessions",{sid:(0,i.varchar)("sid").primaryKey(),sess:(0,g.jsonb)("sess").notNull(),expire:(0,r.timestamp)("expire").notNull()},e=>[c("IDX_session_expire").on(e.expire)]),P=(0,a.pgTable)("admin_whitelist",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),email:(0,i.varchar)("email").notNull().unique(),addedAt:(0,r.timestamp)("added_at").defaultNow(),addedBy:(0,i.varchar)("added_by"),notes:(0,o.text)("notes")}),E=(0,a.pgTable)("blog_posts",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),title:(0,o.text)("title").notNull(),h1:(0,o.text)("h1"),slug:(0,o.text)("slug").notNull().unique(),content:(0,o.text)("content").notNull(),excerpt:(0,o.text)("excerpt"),author:(0,o.text)("author").notNull().default("Economy Plumbing"),publishDate:(0,r.timestamp)("publish_date").notNull().defaultNow(),category:(0,o.text)("category").notNull(),featuredImage:(0,o.text)("featured_image"),jpegFeaturedImage:(0,o.text)("jpeg_featured_image"),imageId:(0,i.varchar)("image_id"),focalPointX:(0,n.integer)("focal_point_x"),focalPointY:(0,n.integer)("focal_point_y"),metaDescription:(0,o.text)("meta_description"),published:(0,l.boolean)("published").notNull().default(!0),isScheduled:(0,l.boolean)("is_scheduled").notNull().default(!1),scheduledFor:(0,r.timestamp)("scheduled_for"),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!1)},e=>({publishDateIdx:c("blog_posts_publish_date_idx").on(e.publishDate),categoryIdx:c("blog_posts_category_idx").on(e.category),publishedIdx:c("blog_posts_published_idx").on(e.published),imageIdIdx:c("blog_posts_image_id_idx").on(e.imageId),scheduledIdx:c("blog_posts_scheduled_idx").on(e.isScheduled,e.scheduledFor)})),M=(0,a.pgTable)("products",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),name:(0,o.text)("name").notNull(),slug:(0,o.text)("slug").notNull().unique(),description:(0,o.text)("description").notNull(),price:(0,n.integer)("price").notNull(),category:(0,o.text)("category").notNull(),sku:(0,o.text)("sku"),image:(0,o.text)("image"),stripeProductId:(0,o.text)("stripe_product_id"),stripePriceId:(0,o.text)("stripe_price_id"),features:(0,o.text)("features").array(),active:(0,l.boolean)("active").notNull().default(!0),serviceTitanMembershipTypeId:(0,o.text)("service_titan_membership_type_id"),durationBillingId:(0,o.text)("duration_billing_id"),serviceTitanEnabled:(0,l.boolean)("service_titan_enabled").notNull().default(!1)},e=>({categoryIdx:c("products_category_idx").on(e.category),activeIdx:c("products_active_idx").on(e.active)})),K=(0,a.pgTable)("contact_submissions",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),name:(0,o.text)("name").notNull(),phone:(0,o.text)("phone").notNull(),email:(0,o.text)("email"),service:(0,o.text)("service"),location:(0,o.text)("location"),urgency:(0,o.text)("urgency"),message:(0,o.text)("message"),pageContext:(0,o.text)("page_context"),submittedAt:(0,r.timestamp)("submitted_at").notNull().defaultNow()},e=>({submittedAtIdx:c("contact_submissions_submitted_at_idx").on(e.submittedAt)})),R=(0,a.pgTable)("referral_codes",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),code:(0,o.text)("code").notNull().unique(),customerId:(0,n.integer)("customer_id").notNull(),customerName:(0,o.text)("customer_name").notNull(),customerPhone:(0,o.text)("customer_phone"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({codeIdx:c("referral_codes_code_idx").on(e.code),customerIdIdx:c("referral_codes_customer_id_idx").on(e.customerId)})),D=(0,a.pgTable)("chatbot_conversations",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),sessionId:(0,i.varchar)("session_id").notNull(),customerEmail:(0,i.varchar)("customer_email"),customerPhone:(0,i.varchar)("customer_phone"),startedAt:(0,r.timestamp)("started_at").notNull().defaultNow(),endedAt:(0,r.timestamp)("ended_at"),pageContext:(0,i.varchar)("page_context"),handoffRequested:(0,l.boolean)("handoff_requested").notNull().default(!1),handoffReason:(0,o.text)("handoff_reason"),emailSent:(0,l.boolean)("email_sent").notNull().default(!1),archived:(0,l.boolean)("archived").notNull().default(!1),notes:(0,o.text)("notes"),rating:(0,n.integer)("rating"),feedbackPositive:(0,n.integer)("feedback_positive").notNull().default(0),feedbackNegative:(0,n.integer)("feedback_negative").notNull().default(0)},e=>({sessionIdIdx:c("chatbot_conversations_session_id_idx").on(e.sessionId),startedAtIdx:c("chatbot_conversations_started_at_idx").on(e.startedAt),handoffIdx:c("chatbot_conversations_handoff_idx").on(e.handoffRequested),archivedIdx:c("chatbot_conversations_archived_idx").on(e.archived)})),z=(0,a.pgTable)("chatbot_messages",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),conversationId:(0,i.varchar)("conversation_id").notNull().references(()=>D.id,{onDelete:"cascade"}),role:(0,i.varchar)("role").notNull(),content:(0,o.text)("content").notNull(),imageUrl:(0,o.text)("image_url"),feedback:(0,i.varchar)("feedback"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({conversationIdIdx:c("chatbot_messages_conversation_id_idx").on(e.conversationId),createdAtIdx:c("chatbot_messages_created_at_idx").on(e.createdAt)})),O=(0,a.pgTable)("chatbot_analytics",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),question:(0,o.text)("question").notNull(),category:(0,i.varchar)("category"),count:(0,n.integer)("count").notNull().default(1),lastAsked:(0,r.timestamp)("last_asked").notNull().defaultNow(),suggestedAnswer:(0,o.text)("suggested_answer"),isCommon:(0,l.boolean)("is_common").notNull().default(!1)},e=>({categoryIdx:c("chatbot_analytics_category_idx").on(e.category),countIdx:c("chatbot_analytics_count_idx").on(e.count),isCommonIdx:c("chatbot_analytics_is_common_idx").on(e.isCommon)})),U=(0,a.pgTable)("chatbot_quick_responses",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),label:(0,i.varchar)("label").notNull(),message:(0,o.text)("message").notNull(),category:(0,i.varchar)("category"),sortOrder:(0,n.integer)("sort_order").notNull().default(0),active:(0,l.boolean)("active").notNull().default(!0),icon:(0,i.varchar)("icon")},e=>({categoryIdx:c("chatbot_quick_responses_category_idx").on(e.category),activeIdx:c("chatbot_quick_responses_active_idx").on(e.active),sortOrderIdx:c("chatbot_quick_responses_sort_order_idx").on(e.sortOrder)})),B=(0,a.pgTable)("referrals",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),referralCode:(0,o.text)("referral_code"),referrerName:(0,o.text)("referrer_name").notNull(),referrerPhone:(0,o.text)("referrer_phone").notNull(),referrerCustomerId:(0,n.integer)("referrer_customer_id"),refereeName:(0,o.text)("referee_name").notNull(),refereePhone:(0,o.text)("referee_phone").notNull(),refereeEmail:(0,o.text)("referee_email"),refereeCustomerId:(0,n.integer)("referee_customer_id"),status:(0,o.text)("status").notNull().default("pending"),creditAmount:(0,n.integer)("credit_amount").notNull().default(2500),firstJobId:(0,o.text)("first_job_id"),firstJobDate:(0,r.timestamp)("first_job_date"),firstJobAmount:(0,n.integer)("first_job_amount"),creditedAt:(0,r.timestamp)("credited_at"),creditedBy:(0,i.varchar)("credited_by"),creditNotes:(0,o.text)("credit_notes"),expiresAt:(0,r.timestamp)("expires_at"),submittedAt:(0,r.timestamp)("submitted_at").notNull().defaultNow(),contactedAt:(0,r.timestamp)("contacted_at"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()},e=>({referrerCustomerIdIdx:c("referrals_referrer_customer_id_idx").on(e.referrerCustomerId),refereeCustomerIdIdx:c("referrals_referee_customer_id_idx").on(e.refereeCustomerId),statusIdx:c("referrals_status_idx").on(e.status),submittedAtIdx:c("referrals_submitted_at_idx").on(e.submittedAt)})),X=(0,a.pgTable)("referral_credit_usage",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerId:(0,n.integer)("customer_id").notNull(),jobId:(0,o.text)("job_id").notNull(),jobNumber:(0,o.text)("job_number").notNull(),amountUsed:(0,n.integer)("amount_used").notNull(),usedAt:(0,r.timestamp)("used_at").notNull(),processedAt:(0,r.timestamp)("processed_at").notNull().defaultNow()},e=>({customerIdIdx:c("referral_credit_usage_customer_id_idx").on(e.customerId),jobIdIdx:p("referral_credit_usage_job_id_idx").on(e.jobId),usedAtIdx:c("referral_credit_usage_used_at_idx").on(e.usedAt)})),F=(0,a.pgTable)("referee_welcome_emails",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),referralId:(0,i.varchar)("referral_id").notNull(),refereeName:(0,o.text)("referee_name").notNull(),refereeEmail:(0,o.text)("referee_email").notNull(),referrerName:(0,o.text)("referrer_name").notNull(),subject:(0,o.text)("subject").notNull(),htmlContent:(0,o.text)("html_content").notNull(),plainTextContent:(0,o.text)("plain_text_content").notNull(),status:(0,o.text)("status").notNull().default("queued"),sentAt:(0,r.timestamp)("sent_at"),failureReason:(0,o.text)("failure_reason"),emailOpens:(0,n.integer)("email_opens").notNull().default(0),linkClicks:(0,n.integer)("link_clicks").notNull().default(0),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!0),aiPrompt:(0,o.text)("ai_prompt"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({referralIdIdx:c("referee_welcome_emails_referral_id_idx").on(e.referralId),statusIdx:c("referee_welcome_emails_status_idx").on(e.status),sentAtIdx:c("referee_welcome_emails_sent_at_idx").on(e.sentAt),refereeEmailIdx:c("referee_welcome_emails_referee_email_idx").on(e.refereeEmail)})),V=(0,a.pgTable)("referrer_thank_you_emails",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),referralId:(0,i.varchar)("referral_id").notNull(),referrerName:(0,o.text)("referrer_name").notNull(),referrerEmail:(0,o.text)("referrer_email").notNull(),referrerCustomerId:(0,n.integer)("referrer_customer_id").notNull(),refereeName:(0,o.text)("referee_name").notNull(),subject:(0,o.text)("subject").notNull(),htmlContent:(0,o.text)("html_content").notNull(),plainTextContent:(0,o.text)("plain_text_content").notNull(),status:(0,o.text)("status").notNull().default("queued"),approvedAt:(0,r.timestamp)("approved_at"),approvedBy:(0,i.varchar)("approved_by"),sentAt:(0,r.timestamp)("sent_at"),failureReason:(0,o.text)("failure_reason"),emailOpens:(0,n.integer)("email_opens").notNull().default(0),linkClicks:(0,n.integer)("link_clicks").notNull().default(0),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!0),aiPrompt:(0,o.text)("ai_prompt"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({referralIdIdx:c("referrer_thank_you_emails_referral_id_idx").on(e.referralId),statusIdx:c("referrer_thank_you_emails_status_idx").on(e.status),sentAtIdx:c("referrer_thank_you_emails_sent_at_idx").on(e.sentAt),referrerEmailIdx:c("referrer_thank_you_emails_referrer_email_idx").on(e.referrerEmail),referrerCustomerIdIdx:c("referrer_thank_you_emails_referrer_customer_id_idx").on(e.referrerCustomerId)})),L=(0,a.pgTable)("referrer_success_emails",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),referralId:(0,i.varchar)("referral_id").notNull(),referrerName:(0,o.text)("referrer_name").notNull(),referrerEmail:(0,o.text)("referrer_email").notNull(),referrerCustomerId:(0,n.integer)("referrer_customer_id").notNull(),refereeName:(0,o.text)("referee_name").notNull(),creditAmount:(0,n.integer)("credit_amount").notNull(),creditExpiresAt:(0,r.timestamp)("credit_expires_at").notNull(),currentBalance:(0,n.integer)("current_balance"),subject:(0,o.text)("subject").notNull(),htmlContent:(0,o.text)("html_content").notNull(),plainTextContent:(0,o.text)("plain_text_content").notNull(),status:(0,o.text)("status").notNull().default("queued"),approvedAt:(0,r.timestamp)("approved_at"),approvedBy:(0,i.varchar)("approved_by"),sentAt:(0,r.timestamp)("sent_at"),failureReason:(0,o.text)("failure_reason"),emailOpens:(0,n.integer)("email_opens").notNull().default(0),linkClicks:(0,n.integer)("link_clicks").notNull().default(0),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!0),aiPrompt:(0,o.text)("ai_prompt"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({referralIdIdx:c("referrer_success_emails_referral_id_idx").on(e.referralId),statusIdx:c("referrer_success_emails_status_idx").on(e.status),sentAtIdx:c("referrer_success_emails_sent_at_idx").on(e.sentAt),referrerEmailIdx:c("referrer_success_emails_referrer_email_idx").on(e.referrerEmail),referrerCustomerIdIdx:c("referrer_success_emails_referrer_customer_id_idx").on(e.referrerCustomerId)})),G=(0,a.pgTable)("email_preferences",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),email:(0,o.text)("email").notNull().unique(),customerId:(0,n.integer)("customer_id"),marketingEmails:(0,l.boolean)("marketing_emails").notNull().default(!0),reviewRequests:(0,l.boolean)("review_requests").notNull().default(!0),referralEmails:(0,l.boolean)("referral_emails").notNull().default(!0),serviceReminders:(0,l.boolean)("service_reminders").notNull().default(!0),transactionalOnly:(0,l.boolean)("transactional_only").notNull().default(!1),unsubscribeToken:(0,o.text)("unsubscribe_token").notNull().unique(),optedOutAt:(0,r.timestamp)("opted_out_at"),fullyUnsubscribedAt:(0,r.timestamp)("fully_unsubscribed_at"),lastUpdated:(0,r.timestamp)("last_updated").notNull().defaultNow(),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({emailIdx:c("email_preferences_email_idx").on(e.email),customerIdIdx:c("email_preferences_customer_id_idx").on(e.customerId),tokenIdx:c("email_preferences_token_idx").on(e.unsubscribeToken)})),Q=(0,a.pgTable)("pending_referrals",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),referrerCustomerId:(0,n.integer)("referrer_customer_id").notNull(),referrerName:(0,o.text)("referrer_name").notNull(),refereeName:(0,o.text)("referee_name").notNull(),refereeEmail:(0,o.text)("referee_email"),refereePhone:(0,o.text)("referee_phone"),trackingCookie:(0,o.text)("tracking_cookie").unique(),convertedToReferral:(0,l.boolean)("converted_to_referral").notNull().default(!1),referralId:(0,i.varchar)("referral_id"),capturedAt:(0,r.timestamp)("captured_at").notNull().defaultNow(),convertedAt:(0,r.timestamp)("converted_at"),expiresAt:(0,r.timestamp)("expires_at").notNull()},e=>({referrerIdIdx:c("pending_referrals_referrer_id_idx").on(e.referrerCustomerId),emailIdx:c("pending_referrals_email_idx").on(e.refereeEmail),phoneIdx:c("pending_referrals_phone_idx").on(e.refereePhone),cookieIdx:c("pending_referrals_cookie_idx").on(e.trackingCookie),convertedIdx:c("pending_referrals_converted_idx").on(e.convertedToReferral)})),J=(0,a.pgTable)("conversion_events",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),eventType:(0,o.text)("event_type").notNull(),source:(0,o.text)("source"),utmSource:(0,o.text)("utm_source"),utmMedium:(0,o.text)("utm_medium"),utmCampaign:(0,o.text)("utm_campaign"),utmContent:(0,o.text)("utm_content"),metadata:(0,g.jsonb)("metadata"),customerId:(0,n.integer)("customer_id"),email:(0,o.text)("email"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({eventTypeIdx:c("conversion_events_event_type_idx").on(e.eventType),createdAtIdx:c("conversion_events_created_at_idx").on(e.createdAt),customerIdIdx:c("conversion_events_customer_id_idx").on(e.customerId)})),Y=(0,a.pgTable)("customer_segments",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),name:(0,o.text)("name").notNull().unique(),description:(0,o.text)("description"),segmentType:(0,o.text)("segment_type").notNull(),aiPrompt:(0,o.text)("ai_prompt"),aiCriteria:(0,g.jsonb)("ai_criteria"),criteria:(0,g.jsonb)("criteria"),customerCount:(0,n.integer)("customer_count").notNull().default(0),lastRefreshedAt:(0,r.timestamp)("last_refreshed_at"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()},e=>({nameIdx:c("customer_segments_name_idx").on(e.name),typeIdx:c("customer_segments_type_idx").on(e.segmentType)})),W=(0,a.pgTable)("segment_membership",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),segmentId:(0,i.varchar)("segment_id").notNull().references(()=>Y.id,{onDelete:"cascade"}),customerId:(0,n.integer)("customer_id").notNull(),addedAt:(0,r.timestamp)("added_at").notNull().defaultNow(),addedBy:(0,i.varchar)("added_by")},e=>({segmentCustomerIdx:p("segment_membership_segment_customer_idx").on(e.segmentId,e.customerId),customerIdIdx:c("segment_membership_customer_id_idx").on(e.customerId)})),Z=(0,a.pgTable)("custom_email_campaigns",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),name:(0,o.text)("name").notNull().unique(),description:(0,o.text)("description"),campaignType:(0,o.text)("campaign_type").notNull(),segmentId:(0,i.varchar)("segment_id").references(()=>Y.id,{onDelete:"set null"}),targetCustomerIds:(0,n.integer)("target_customer_ids").array(),trackingPhoneNumber:(0,o.text)("tracking_phone_number"),utmCampaign:(0,o.text)("utm_campaign"),utmSource:(0,o.text)("utm_source").default("email"),utmMedium:(0,o.text)("utm_medium").default("campaign"),status:(0,o.text)("status").notNull().default("draft"),approvedBy:(0,i.varchar)("approved_by"),approvedAt:(0,r.timestamp)("approved_at"),scheduledFor:(0,r.timestamp)("scheduled_for"),dripIntervalDays:(0,n.integer)("drip_interval_days").array(),pauseOnEngagement:(0,l.boolean)("pause_on_engagement").notNull().default(!1),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!1),aiPrompt:(0,o.text)("ai_prompt"),aiGoal:(0,o.text)("ai_goal"),totalSent:(0,n.integer)("total_sent").notNull().default(0),totalDelivered:(0,n.integer)("total_delivered").notNull().default(0),totalOpened:(0,n.integer)("total_opened").notNull().default(0),totalClicked:(0,n.integer)("total_clicked").notNull().default(0),totalUnsubscribed:(0,n.integer)("total_unsubscribed").notNull().default(0),totalBounced:(0,n.integer)("total_bounced").notNull().default(0),totalCalls:(0,n.integer)("total_calls").notNull().default(0),totalJobsBooked:(0,n.integer)("total_jobs_booked").notNull().default(0),totalRevenue:(0,n.integer)("total_revenue").notNull().default(0),dailySendLimit:(0,n.integer)("daily_send_limit").notNull().default(500),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow(),startedAt:(0,r.timestamp)("started_at"),completedAt:(0,r.timestamp)("completed_at")},e=>({nameIdx:c("custom_campaigns_name_idx").on(e.name),statusIdx:c("custom_campaigns_status_idx").on(e.status),segmentIdIdx:c("custom_campaigns_segment_id_idx").on(e.segmentId),scheduledForIdx:c("custom_campaigns_scheduled_for_idx").on(e.scheduledFor)})),H=(0,a.pgTable)("custom_campaign_emails",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),campaignId:(0,i.varchar)("campaign_id").notNull().references(()=>Z.id,{onDelete:"cascade"}),sequenceNumber:(0,n.integer)("sequence_number").notNull().default(1),daysAfterStart:(0,n.integer)("days_after_start").notNull().default(0),subject:(0,o.text)("subject").notNull(),preheader:(0,o.text)("preheader"),htmlContent:(0,o.text)("html_content").notNull(),plainTextContent:(0,o.text)("plain_text_content").notNull(),generatedByAI:(0,l.boolean)("generated_by_ai").notNull().default(!1),aiStrategy:(0,o.text)("ai_strategy"),aiPrompt:(0,o.text)("ai_prompt"),isVariant:(0,l.boolean)("is_variant").notNull().default(!1),variantOf:(0,i.varchar)("variant_of"),testPercentage:(0,n.integer)("test_percentage"),totalSent:(0,n.integer)("total_sent").notNull().default(0),totalOpened:(0,n.integer)("total_opened").notNull().default(0),totalClicked:(0,n.integer)("total_clicked").notNull().default(0),enabled:(0,l.boolean)("enabled").notNull().default(!0),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()},e=>({campaignSequenceIdx:c("custom_campaign_emails_campaign_sequence_idx").on(e.campaignId,e.sequenceNumber),variantOfIdx:c("custom_campaign_emails_variant_of_idx").on(e.variantOf)})),$=(0,a.pgTable)("custom_campaign_send_log",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),campaignId:(0,i.varchar)("campaign_id").notNull().references(()=>Z.id,{onDelete:"cascade"}),campaignEmailId:(0,i.varchar)("campaign_email_id").notNull().references(()=>H.id,{onDelete:"cascade"}),customerId:(0,n.integer)("customer_id").notNull(),recipientEmail:(0,o.text)("recipient_email").notNull(),recipientName:(0,o.text)("recipient_name").notNull(),resendEmailId:(0,o.text)("resend_email_id"),resendStatus:(0,o.text)("resend_status"),sentAt:(0,r.timestamp)("sent_at").notNull().defaultNow(),deliveredAt:(0,r.timestamp)("delivered_at"),openedAt:(0,r.timestamp)("opened_at"),clickedAt:(0,r.timestamp)("clicked_at"),bouncedAt:(0,r.timestamp)("bounced_at"),complainedAt:(0,r.timestamp)("complained_at"),unsubscribedAt:(0,r.timestamp)("unsubscribed_at"),openCount:(0,n.integer)("open_count").notNull().default(0),clickCount:(0,n.integer)("click_count").notNull().default(0),leadToJobBooking:(0,l.boolean)("lead_to_job_booking").notNull().default(!1),jobId:(0,x.bigint)("job_id",{mode:"number"}),revenueAttributed:(0,n.integer)("revenue_attributed").notNull().default(0),errorMessage:(0,o.text)("error_message")},e=>({campaignCustomerIdx:c("custom_send_log_campaign_customer_idx").on(e.campaignId,e.customerId),campaignEmailIdx:c("custom_send_log_campaign_email_idx").on(e.campaignEmailId),sentAtIdx:c("custom_send_log_sent_at_idx").on(e.sentAt),resendEmailIdIdx:c("custom_send_log_resend_id_idx").on(e.resendEmailId),openedAtIdx:c("custom_send_log_opened_at_idx").on(e.openedAt),clickedAtIdx:c("custom_send_log_clicked_at_idx").on(e.clickedAt)})),ee=(0,a.pgTable)("customer_success_stories",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerName:(0,o.text)("customer_name").notNull(),email:(0,o.text)("email"),phone:(0,o.text)("phone"),story:(0,o.text)("story").notNull(),beforePhotoUrl:(0,o.text)("before_photo_url").notNull(),afterPhotoUrl:(0,o.text)("after_photo_url").notNull(),collagePhotoUrl:(0,o.text)("collage_photo_url"),jpegCollagePhotoUrl:(0,o.text)("jpeg_collage_photo_url"),beforeFocalX:(0,n.integer)("before_focal_x"),beforeFocalY:(0,n.integer)("before_focal_y"),afterFocalX:(0,n.integer)("after_focal_x"),afterFocalY:(0,n.integer)("after_focal_y"),serviceCategory:(0,o.text)("service_category").notNull(),location:(0,o.text)("location").notNull(),approved:(0,l.boolean)("approved").notNull().default(!1),submittedAt:(0,r.timestamp)("submitted_at").notNull().defaultNow()},e=>({submittedAtIdx:c("customer_success_stories_submitted_at_idx").on(e.submittedAt),approvedIdx:c("customer_success_stories_approved_idx").on(e.approved),categoryIdx:c("customer_success_stories_category_idx").on(e.serviceCategory)})),et=(0,a.pgTable)("service_areas",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),cityName:(0,o.text)("city_name").notNull(),slug:(0,o.text)("slug").notNull().unique(),region:(0,o.text)("region").notNull(),metaDescription:(0,o.text)("meta_description").notNull(),introContent:(0,o.text)("intro_content").notNull(),neighborhoods:(0,o.text)("neighborhoods").array(),landmarks:(0,o.text)("landmarks").array(),localPainPoints:(0,o.text)("local_pain_points").array(),seasonalIssues:(0,o.text)("seasonal_issues").array(),uniqueFaqs:(0,o.text)("unique_faqs").array(),testimonials:(0,o.text)("testimonials").array(),population:(0,o.text)("population"),zipCodes:(0,o.text)("zip_codes").array(),latitude:(0,o.text)("latitude"),longitude:(0,o.text)("longitude")},e=>({regionIdx:c("service_areas_region_idx").on(e.region)})),ea=q(k).pick({username:!0,password:!0}),eo=q(E).omit({id:!0,publishDate:!0}),ei=q(M).omit({id:!0}),er=q(K).omit({id:!0,submittedAt:!0}),en=q(ee).omit({id:!0,submittedAt:!0,approved:!0}),el=(0,a.pgTable)("google_reviews",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),authorName:(0,o.text)("author_name").notNull(),authorUrl:(0,o.text)("author_url"),profilePhotoUrl:(0,o.text)("profile_photo_url"),rating:(0,n.integer)("rating").notNull(),text:(0,o.text)("text").notNull(),relativeTime:(0,o.text)("relative_time").notNull(),timestamp:(0,n.integer)("timestamp").notNull(),fetchedAt:(0,r.timestamp)("fetched_at").notNull().defaultNow(),categories:(0,o.text)("categories").array().notNull().default(t.sql`ARRAY[]::text[]`),source:(0,o.text)("source").notNull().default("places_api"),reviewId:(0,o.text)("review_id"),replyText:(0,o.text)("reply_text"),repliedAt:(0,r.timestamp)("replied_at"),canReply:(0,l.boolean)("can_reply").notNull().default(!1)},e=>({ratingIdx:c("google_reviews_rating_idx").on(e.rating),timestampIdx:c("google_reviews_timestamp_idx").on(e.timestamp),sourceIdx:c("google_reviews_source_idx").on(e.source),repliedIdx:c("google_reviews_replied_idx").on(e.repliedAt)})),ed=(0,a.pgTable)("google_oauth_tokens",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),service:(0,o.text)("service").notNull().default("google_my_business"),accessToken:(0,o.text)("access_token").notNull(),refreshToken:(0,o.text)("refresh_token").notNull(),expiryDate:(0,r.timestamp)("expiry_date").notNull(),accountId:(0,o.text)("account_id"),locationId:(0,o.text)("location_id"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()}),es=(0,a.pgTable)("zoom_oauth_tokens",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),accessToken:(0,o.text)("access_token").notNull(),refreshToken:(0,o.text)("refresh_token").notNull(),expiresAt:(0,r.timestamp)("expires_at").notNull(),scope:(0,o.text)("scope"),tokenType:(0,o.text)("token_type").notNull().default("bearer"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()}),eu=(0,a.pgTable)("pending_purchases",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),paymentIntentId:(0,o.text)("payment_intent_id").notNull().unique(),productId:(0,i.varchar)("product_id").notNull(),customerType:(0,o.text)("customer_type").notNull(),customerName:(0,o.text)("customer_name"),companyName:(0,o.text)("company_name"),contactPersonName:(0,o.text)("contact_person_name"),locationPhone:(0,o.text)("location_phone"),extension:(0,o.text)("extension"),locationName:(0,o.text)("location_name"),street:(0,o.text)("street").notNull(),city:(0,o.text)("city").notNull(),state:(0,o.text)("state").notNull(),zip:(0,o.text)("zip").notNull(),billingName:(0,o.text)("billing_name"),billingStreet:(0,o.text)("billing_street"),billingCity:(0,o.text)("billing_city"),billingState:(0,o.text)("billing_state"),billingZip:(0,o.text)("billing_zip"),phone:(0,o.text)("phone").notNull(),email:(0,o.text)("email").notNull(),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({paymentIntentIdIdx:c("pending_purchases_payment_intent_id_idx").on(e.paymentIntentId)})),em=(0,a.pgTable)("service_titan_memberships",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerType:(0,o.text)("customer_type").notNull(),customerName:(0,o.text)("customer_name"),companyName:(0,o.text)("company_name"),contactPersonName:(0,o.text)("contact_person_name"),locationPhone:(0,o.text)("location_phone"),extension:(0,o.text)("extension"),locationName:(0,o.text)("location_name"),street:(0,o.text)("street").notNull(),city:(0,o.text)("city").notNull(),state:(0,o.text)("state").notNull(),zip:(0,o.text)("zip").notNull(),billingName:(0,o.text)("billing_name"),billingStreet:(0,o.text)("billing_street"),billingCity:(0,o.text)("billing_city"),billingState:(0,o.text)("billing_state"),billingZip:(0,o.text)("billing_zip"),phone:(0,o.text)("phone").notNull(),email:(0,o.text)("email").notNull(),serviceTitanMembershipTypeId:(0,o.text)("service_titan_membership_type_id").notNull(),serviceTitanCustomerId:(0,o.text)("service_titan_customer_id"),serviceTitanMembershipId:(0,o.text)("service_titan_membership_id"),serviceTitanInvoiceId:(0,o.text)("service_titan_invoice_id"),productId:(0,i.varchar)("product_id").notNull(),stripePaymentIntentId:(0,o.text)("stripe_payment_intent_id"),stripeCustomerId:(0,o.text)("stripe_customer_id"),amount:(0,n.integer)("amount").notNull(),syncStatus:(0,o.text)("sync_status").notNull().default("pending"),syncError:(0,o.text)("sync_error"),lastSyncAttempt:(0,r.timestamp)("last_sync_attempt"),syncedAt:(0,r.timestamp)("synced_at"),purchasedAt:(0,r.timestamp)("purchased_at").notNull().defaultNow()},e=>({customerTypeIdx:c("st_memberships_customer_type_idx").on(e.customerType),syncStatusIdx:c("st_memberships_sync_status_idx").on(e.syncStatus),serviceTitanCustomerIdIdx:c("st_memberships_st_customer_id_idx").on(e.serviceTitanCustomerId),productIdIdx:c("st_memberships_product_id_idx").on(e.productId)})),e_=(0,a.pgTable)("service_titan_customers",{id:(0,n.integer)("id").primaryKey(),name:(0,o.text)("name").notNull(),type:(0,o.text)("type").notNull(),email:(0,o.text)("email"),phone:(0,o.text)("phone"),mobilePhone:(0,o.text)("mobile_phone"),street:(0,o.text)("street"),city:(0,o.text)("city"),state:(0,o.text)("state"),zip:(0,o.text)("zip"),active:(0,l.boolean)("active").notNull().default(!0),balance:(0,o.text)("balance"),jobCount:(0,n.integer)("job_count").notNull().default(0),lastServiceDate:(0,r.timestamp)("last_service_date"),lastServiceType:(0,o.text)("last_service_type"),lifetimeValue:(0,n.integer)("lifetime_value").notNull().default(0),customerTags:(0,o.text)("customer_tags").array(),preferredContactMethod:(0,o.text)("preferred_contact_method"),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({activeIdx:c("st_customers_active_idx").on(e.active),emailIdx:c("st_customers_email_idx").on(e.email),phoneIdx:c("st_customers_phone_idx").on(e.phone),mobilePhoneIdx:c("st_customers_mobile_phone_idx").on(e.mobilePhone),typeIdx:c("st_customers_type_idx").on(e.type),jobCountIdx:c("st_customers_job_count_idx").on(e.jobCount),lastSyncedIdx:c("st_customers_last_synced_idx").on(e.lastSyncedAt),lastServiceDateIdx:c("st_customers_last_service_date_idx").on(e.lastServiceDate),lifetimeValueIdx:c("st_customers_lifetime_value_idx").on(e.lifetimeValue),preferredContactIdx:c("st_customers_preferred_contact_idx").on(e.preferredContactMethod)})),ec=(0,a.pgTable)("service_titan_contacts",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerId:(0,n.integer)("customer_id").notNull(),contactType:(0,o.text)("contact_type").notNull(),value:(0,o.text)("value").notNull(),normalizedValue:(0,o.text)("normalized_value").notNull(),isPrimary:(0,l.boolean)("is_primary").notNull().default(!1),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({customerIdIdx:c("st_contacts_customer_id_idx").on(e.customerId),normalizedValueIdx:c("st_contacts_normalized_value_idx").on(e.normalizedValue),contactTypeIdx:c("st_contacts_contact_type_idx").on(e.contactType)})),ep=(0,a.pgTable)("customers_xlsx",{id:(0,n.integer)("id").primaryKey(),name:(0,o.text)("name").notNull(),type:(0,o.text)("type").notNull(),email:(0,o.text)("email"),phone:(0,o.text)("phone"),mobilePhone:(0,o.text)("mobile_phone"),street:(0,o.text)("street"),city:(0,o.text)("city"),state:(0,o.text)("state"),zip:(0,o.text)("zip"),active:(0,l.boolean)("active").notNull().default(!0),balance:(0,o.text)("balance"),jobCount:(0,n.integer)("job_count").notNull().default(0),lastServiceDate:(0,r.timestamp)("last_service_date"),lastServiceType:(0,o.text)("last_service_type"),lifetimeValue:(0,n.integer)("lifetime_value").notNull().default(0),customerTags:(0,o.text)("customer_tags").array(),preferredContactMethod:(0,o.text)("preferred_contact_method"),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({activeIdx:c("customers_xlsx_active_idx").on(e.active),emailIdx:c("customers_xlsx_email_idx").on(e.email),phoneIdx:c("customers_xlsx_phone_idx").on(e.phone),mobilePhoneIdx:c("customers_xlsx_mobile_phone_idx").on(e.mobilePhone),typeIdx:c("customers_xlsx_type_idx").on(e.type),jobCountIdx:c("customers_xlsx_job_count_idx").on(e.jobCount),lastSyncedIdx:c("customers_xlsx_last_synced_idx").on(e.lastSyncedAt),lastServiceDateIdx:c("customers_xlsx_last_service_date_idx").on(e.lastServiceDate),lifetimeValueIdx:c("customers_xlsx_lifetime_value_idx").on(e.lifetimeValue),preferredContactIdx:c("customers_xlsx_preferred_contact_idx").on(e.preferredContactMethod)})),ex=(0,a.pgTable)("contacts_xlsx",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerId:(0,n.integer)("customer_id").notNull(),contactType:(0,o.text)("contact_type").notNull(),value:(0,o.text)("value").notNull(),normalizedValue:(0,o.text)("normalized_value").notNull(),isPrimary:(0,l.boolean)("is_primary").notNull().default(!1),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({customerIdIdx:c("contacts_xlsx_customer_id_idx").on(e.customerId),normalizedValueIdx:c("contacts_xlsx_normalized_value_idx").on(e.normalizedValue),contactTypeIdx:c("contacts_xlsx_contact_type_idx").on(e.contactType)})),eg=(0,a.pgTable)("mailgun_webhook_logs",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),receivedAt:(0,r.timestamp)("received_at").notNull().defaultNow(),messageId:(0,o.text)("message_id"),sender:(0,o.text)("sender"),recipient:(0,o.text)("recipient"),subject:(0,o.text)("subject"),signatureVerified:(0,l.boolean)("signature_verified").notNull().default(!1),timestampAge:(0,n.integer)("timestamp_age"),attachmentCount:(0,n.integer)("attachment_count").notNull().default(0),xlsxFound:(0,l.boolean)("xlsx_found").notNull().default(!1),xlsxFileName:(0,o.text)("xlsx_file_name"),xlsxSize:(0,n.integer)("xlsx_size"),status:(0,o.text)("status").notNull(),errorMessage:(0,o.text)("error_message"),importId:(0,i.varchar)("import_id"),processingTime:(0,n.integer)("processing_time")},e=>({receivedAtIdx:c("mailgun_webhook_logs_received_at_idx").on(e.receivedAt),statusIdx:c("mailgun_webhook_logs_status_idx").on(e.status),messageIdIdx:c("mailgun_webhook_logs_message_id_idx").on(e.messageId)})),ef=(0,a.pgTable)("customer_data_imports",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),fileName:(0,o.text)("file_name").notNull(),importedBy:(0,o.text)("imported_by"),importSource:(0,o.text)("import_source").notNull().default("manual"),totalRows:(0,n.integer)("total_rows").notNull().default(0),customersImported:(0,n.integer)("customers_imported").notNull().default(0),contactsImported:(0,n.integer)("contacts_imported").notNull().default(0),errors:(0,n.integer)("errors").notNull().default(0),totalLifetimeRevenue:(0,n.integer)("total_lifetime_revenue").notNull().default(0),customersWithRevenue:(0,n.integer)("customers_with_revenue").notNull().default(0),avgLifetimeRevenue:(0,n.integer)("avg_lifetime_revenue").notNull().default(0),maxLifetimeRevenue:(0,n.integer)("max_lifetime_revenue").notNull().default(0),newCustomers:(0,n.integer)("new_customers").notNull().default(0),revenueChange:(0,n.integer)("revenue_change").notNull().default(0),status:(0,o.text)("status").notNull().default("processing"),errorMessage:(0,o.text)("error_message"),startedAt:(0,r.timestamp)("started_at").notNull().defaultNow(),completedAt:(0,r.timestamp)("completed_at"),processingTime:(0,n.integer)("processing_time")},e=>({importSourceIdx:c("customer_imports_source_idx").on(e.importSource),statusIdx:c("customer_imports_status_idx").on(e.status),startedAtIdx:c("customer_imports_started_at_idx").on(e.startedAt)})),eN=(0,a.pgTable)("tracking_numbers",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),channelKey:(0,o.text)("channel_key").notNull().unique(),channelName:(0,o.text)("channel_name").notNull(),displayNumber:(0,o.text)("display_number").notNull(),rawNumber:(0,o.text)("raw_number").notNull(),telLink:(0,o.text)("tel_link").notNull(),detectionRules:(0,o.text)("detection_rules").notNull(),isActive:(0,l.boolean)("is_active").notNull().default(!0),isDefault:(0,l.boolean)("is_default").notNull().default(!1),sortOrder:(0,n.integer)("sort_order").notNull().default(0),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()},e=>({channelKeyIdx:c("tracking_numbers_channel_key_idx").on(e.channelKey),isActiveIdx:c("tracking_numbers_is_active_idx").on(e.isActive),isDefaultIdx:c("tracking_numbers_is_default_idx").on(e.isDefault)})),eb=q(et).omit({id:!0}),ey=q(eN).omit({id:!0,createdAt:!0,updatedAt:!0}),eI=q(el).omit({id:!0,fetchedAt:!0}),eh=q(ed).omit({id:!0,updatedAt:!0}),ev=q(es).omit({id:!0,createdAt:!0,updatedAt:!0}),eA=q(eu).omit({id:!0,createdAt:!0}),eT=q(em).omit({id:!0,purchasedAt:!0,lastSyncAttempt:!0,syncedAt:!0}),eS=(0,a.pgTable)("companycam_photos",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),companyCamPhotoId:(0,o.text)("companycam_photo_id").unique(),companyCamProjectId:(0,o.text)("companycam_project_id"),photoUrl:(0,o.text)("photo_url").notNull(),thumbnailUrl:(0,o.text)("thumbnail_url"),source:(0,o.text)("source").notNull().default("companycam"),category:(0,o.text)("category").notNull(),aiDescription:(0,o.text)("ai_description"),tags:(0,o.text)("tags").array(),qualityAnalyzed:(0,l.boolean)("quality_analyzed").notNull().default(!1),isGoodQuality:(0,l.boolean)("is_good_quality"),shouldKeep:(0,l.boolean)("should_keep"),qualityScore:(0,n.integer)("quality_score"),qualityReasoning:(0,o.text)("quality_reasoning"),analyzedAt:(0,r.timestamp)("analyzed_at"),focalPointX:(0,n.integer)("focal_point_x"),focalPointY:(0,n.integer)("focal_point_y"),focalPointReason:(0,o.text)("focal_point_reason"),suggestedBlogTopic:(0,o.text)("suggested_blog_topic"),blogTopicAnalyzed:(0,l.boolean)("blog_topic_analyzed").notNull().default(!1),blogTopicAnalyzedAt:(0,r.timestamp)("blog_topic_analyzed_at"),uploadedAt:(0,r.timestamp)("uploaded_at"),fetchedAt:(0,r.timestamp)("fetched_at").notNull().defaultNow(),usedInBlogPostId:(0,i.varchar)("used_in_blog_post_id"),usedInPageUrl:(0,o.text)("used_in_page_url")},e=>({categoryIdx:c("companycam_photos_category_idx").on(e.category),projectIdIdx:c("companycam_photos_project_id_idx").on(e.companyCamProjectId),qualityIdx:c("companycam_photos_quality_idx").on(e.shouldKeep),blogTopicIdx:c("companycam_photos_blog_topic_idx").on(e.blogTopicAnalyzed,e.usedInBlogPostId)})),ew=q(eS).omit({id:!0,fetchedAt:!0}),eq=(0,a.pgTable)("before_after_composites",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),beforePhotoId:(0,i.varchar)("before_photo_id").notNull(),afterPhotoId:(0,i.varchar)("after_photo_id").notNull(),compositeUrl:(0,o.text)("composite_url").notNull(),jpegCompositeUrl:(0,o.text)("jpeg_composite_url"),caption:(0,o.text)("caption"),category:(0,o.text)("category").notNull(),jobId:(0,o.text)("job_id"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),postedToFacebook:(0,l.boolean)("posted_to_facebook").notNull().default(!1),postedToInstagram:(0,l.boolean)("posted_to_instagram").notNull().default(!1),facebookPostId:(0,o.text)("facebook_post_id"),instagramPostId:(0,o.text)("instagram_post_id"),postedAt:(0,r.timestamp)("posted_at")},e=>({categoryIdx:c("before_after_composites_category_idx").on(e.category),postedIdx:c("before_after_composites_posted_idx").on(e.postedToFacebook,e.postedToInstagram)})),ek=q(eq).omit({id:!0,createdAt:!0}),eC=(0,a.pgTable)("system_settings",{key:(0,o.text)("key").primaryKey(),value:(0,o.text)("value"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()}),ej=(0,a.pgTable)("not_found_errors",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),requestedUrl:(0,o.text)("requested_url").notNull(),referrer:(0,o.text)("referrer"),userAgent:(0,o.text)("user_agent"),ipAddress:(0,o.text)("ip_address"),timestamp:(0,r.timestamp)("timestamp").notNull().defaultNow(),emailSent:(0,l.boolean)("email_sent").notNull().default(!1)},e=>({timestampIdx:c("not_found_errors_timestamp_idx").on(e.timestamp),urlIdx:c("not_found_errors_url_idx").on(e.requestedUrl)})),eP=(0,a.pgTable)("imported_photos",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),url:(0,o.text)("url").notNull(),category:(0,o.text)("category").notNull(),isProductionQuality:(0,l.boolean)("is_production_quality").notNull().default(!0),aiQuality:(0,n.integer)("ai_quality"),aiQualityScore:(0,n.integer)("ai_quality_score"),qualityReason:(0,o.text)("quality_reason"),aiDescription:(0,o.text)("ai_description"),aiTags:(0,o.text)("ai_tags").array(),focalPointX:(0,n.integer)("focal_point_x"),focalPointY:(0,n.integer)("focal_point_y"),gdriveFileId:(0,o.text)("gdrive_file_id").unique(),usedInBlog:(0,l.boolean)("used_in_blog").notNull().default(!1),usedInBlogPostId:(0,o.text)("used_in_blog_post_id"),usedInPageUrl:(0,o.text)("used_in_page_url"),uploadDate:(0,r.timestamp)("upload_date"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),fetchedAt:(0,r.timestamp)("fetched_at").notNull().defaultNow()},e=>({categoryIdx:c("imported_photos_category_idx").on(e.category),usedIdx:c("imported_photos_used_idx").on(e.usedInBlog),qualityIdx:c("imported_photos_quality_idx").on(e.isProductionQuality),gdriveIdx:c("imported_photos_gdrive_idx").on(e.gdriveFileId)})),eE=q(eC),eM=q(ej).omit({id:!0,timestamp:!0}),eK=q(eP).omit({id:!0,fetchedAt:!0}),eR=(0,a.pgTable)("commercial_customers",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),name:(0,o.text)("name").notNull(),logoUrl:(0,o.text)("logo_url").notNull(),websiteUrl:(0,o.text)("website_url"),location:(0,o.text)("location"),industry:(0,o.text)("industry"),customerSince:(0,n.integer)("customer_since"),displayOrder:(0,n.integer)("display_order").notNull().default(0),active:(0,l.boolean)("active").notNull().default(!0),addedAt:(0,r.timestamp)("added_at").notNull().defaultNow()},e=>({activeIdx:c("commercial_customers_active_idx").on(e.active),displayOrderIdx:c("commercial_customers_display_order_idx").on(e.displayOrder)})),eD=q(eR).omit({id:!0,addedAt:!0}),ez=(0,a.pgTable)("portal_analytics",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),searchType:(0,o.text)("search_type").notNull(),searchValue:(0,o.text)("search_value").notNull(),found:(0,l.boolean)("found").notNull(),customerId:(0,n.integer)("customer_id"),timestamp:(0,r.timestamp)("timestamp").notNull().defaultNow()},e=>({timestampIdx:c("portal_analytics_timestamp_idx").on(e.timestamp),foundIdx:c("portal_analytics_found_idx").on(e.found)})),eO=(0,a.pgTable)("phone_login_lookups",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),lookupToken:(0,o.text)("lookup_token").notNull().unique(),phone:(0,o.text)("phone").notNull(),email:(0,o.text)("email").notNull(),customerId:(0,n.integer)("customer_id").notNull(),expiresAt:(0,r.timestamp)("expires_at",{withTimezone:!0}).notNull(),createdAt:(0,r.timestamp)("created_at").defaultNow()},e=>({tokenIdx:c("phone_login_lookups_token_idx").on(e.lookupToken),expiresIdx:c("phone_login_lookups_expires_idx").on(e.expiresAt)})),eU=(0,a.pgTable)("portal_verifications",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),verificationType:(0,o.text)("verification_type").notNull(),contactValue:(0,o.text)("contact_value").notNull(),code:(0,o.text)("code").notNull(),customerIds:(0,n.integer)("customer_ids").array().notNull(),verified:(0,l.boolean)("verified").notNull().default(!1),verifiedAt:(0,r.timestamp)("verified_at",{withTimezone:!0}),expiresAt:(0,r.timestamp)("expires_at",{withTimezone:!0}).notNull(),attempts:(0,n.integer)("attempts").notNull().default(0),createdAt:(0,r.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow()},e=>({codeIdx:c("portal_verifications_code_idx").on(e.code),contactIdx:c("portal_verifications_contact_idx").on(e.contactValue),expiresIdx:c("portal_verifications_expires_idx").on(e.expiresAt)})),eB=(0,a.pgTable)("page_metadata",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),path:(0,o.text)("path").notNull().unique(),title:(0,o.text)("title").notNull(),description:(0,o.text)("description").notNull(),keywords:(0,o.text)("keywords"),canonicalUrl:(0,o.text)("canonical_url"),ogImage:(0,o.text)("og_image"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow(),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({pathIdx:c("page_metadata_path_idx").on(e.path)})),eX=q(eB).omit({id:!0,createdAt:!0,updatedAt:!0}),eF=q(e_).omit({lastSyncedAt:!0}),eV=q(ec).omit({id:!0,lastSyncedAt:!0}),eL=q(eg).omit({id:!0,receivedAt:!0}),eG=q(ef).omit({id:!0,startedAt:!0,completedAt:!0}),eQ=(0,a.pgTable)("otp_verifications",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),phoneNumber:(0,o.text)("phone_number").notNull(),otp:(0,o.text)("otp").notNull(),verified:(0,l.boolean)("verified").notNull().default(!1),expiresAt:(0,r.timestamp)("expires_at").notNull(),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({phoneNumberIdx:c("otp_verifications_phone_number_idx").on(e.phoneNumber),expiresAtIdx:c("otp_verifications_expires_at_idx").on(e.expiresAt)})),eJ=q(eQ).omit({id:!0,createdAt:!0}),eY=(0,a.pgTable)("custom_reviews",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerName:(0,o.text)("customer_name").notNull(),email:(0,o.text)("email"),phone:(0,o.text)("phone"),serviceTitanCustomerId:(0,n.integer)("service_titan_customer_id"),rating:(0,n.integer)("rating").notNull(),title:(0,o.text)("title"),text:(0,o.text)("text").notNull(),serviceType:(0,o.text)("service_type"),jobDate:(0,r.timestamp)("job_date"),photoUrls:(0,o.text)("photo_urls").array().default(t.sql`ARRAY[]::text[]`),status:(0,o.text)("status").notNull().default("pending"),replyText:(0,o.text)("reply_text"),repliedAt:(0,r.timestamp)("replied_at"),moderatedBy:(0,i.varchar)("moderated_by"),moderatedAt:(0,r.timestamp)("moderated_at"),moderationNotes:(0,o.text)("moderation_notes"),featured:(0,l.boolean)("featured").notNull().default(!1),displayOnWebsite:(0,l.boolean)("display_on_website").notNull().default(!0),submittedAt:(0,r.timestamp)("submitted_at").notNull().defaultNow(),ipAddress:(0,o.text)("ip_address"),userAgent:(0,o.text)("user_agent"),source:(0,o.text)("source").notNull().default("website"),requestId:(0,i.varchar)("request_id")},e=>({statusIdx:c("custom_reviews_status_idx").on(e.status),ratingIdx:c("custom_reviews_rating_idx").on(e.rating),submittedAtIdx:c("custom_reviews_submitted_at_idx").on(e.submittedAt),featuredIdx:c("custom_reviews_featured_idx").on(e.featured),customerIdIdx:c("custom_reviews_customer_id_idx").on(e.serviceTitanCustomerId)})),eW=q(eY).omit({id:!0,submittedAt:!0,moderatedBy:!0,moderatedAt:!0}),eZ=(0,a.pgTable)("review_platforms",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),platform:(0,o.text)("platform").notNull().unique(),displayName:(0,o.text)("display_name").notNull(),url:(0,o.text)("url").notNull(),enabled:(0,l.boolean)("enabled").notNull().default(!0),sortOrder:(0,n.integer)("sort_order").notNull().default(0),icon:(0,o.text)("icon"),description:(0,o.text)("description"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()}),eH=(0,a.pgTable)("service_titan_jobs_staging",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),jobId:(0,x.bigint)("job_id",{mode:"number"}).notNull(),rawData:(0,g.jsonb)("raw_data").notNull(),fetchedAt:(0,r.timestamp)("fetched_at").notNull().defaultNow(),processedAt:(0,r.timestamp)("processed_at"),processingError:(0,o.text)("processing_error")},e=>({jobIdIdx:c("st_jobs_staging_job_id_idx").on(e.jobId),fetchedAtIdx:c("st_jobs_staging_fetched_at_idx").on(e.fetchedAt),processedAtIdx:c("st_jobs_staging_processed_at_idx").on(e.processedAt)})),e$=(0,a.pgTable)("service_titan_jobs",{id:(0,x.bigint)("id",{mode:"number"}).primaryKey(),jobNumber:(0,i.varchar)("job_number").notNull(),customerId:(0,n.integer)("customer_id").notNull(),jobType:(0,i.varchar)("job_type"),businessUnitId:(0,x.bigint)("business_unit_id",{mode:"number"}),jobStatus:(0,i.varchar)("job_status").notNull(),completedOn:(0,r.timestamp)("completed_on"),total:(0,n.integer)("total").notNull().default(0),invoice:(0,n.integer)("invoice").notNull().default(0),serviceCategory:(0,i.varchar)("service_category"),equipmentInstalled:(0,o.text)("equipment_installed").array(),customerSatisfaction:(0,n.integer)("customer_satisfaction"),createdOn:(0,r.timestamp)("created_on").notNull(),modifiedOn:(0,r.timestamp)("modified_on").notNull(),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({customerIdIdx:c("st_jobs_customer_id_idx").on(e.customerId),jobStatusIdx:c("st_jobs_job_status_idx").on(e.jobStatus),completedOnIdx:c("st_jobs_completed_on_idx").on(e.completedOn),modifiedOnIdx:c("st_jobs_modified_on_idx").on(e.modifiedOn),jobNumberIdx:c("st_jobs_job_number_idx").on(e.jobNumber),serviceCategoryIdx:c("st_jobs_service_category_idx").on(e.serviceCategory),customerSatisfactionIdx:c("st_jobs_customer_satisfaction_idx").on(e.customerSatisfaction)})),e0=(0,a.pgTable)("sync_watermarks",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),syncType:(0,i.varchar)("sync_type").notNull(),lastSuccessfulSyncAt:(0,r.timestamp)("last_successful_sync_at"),lastModifiedOnFetched:(0,r.timestamp)("last_modified_on_fetched"),recordsProcessed:(0,n.integer)("records_processed").notNull().default(0),syncDuration:(0,n.integer)("sync_duration"),lastError:(0,o.text)("last_error"),lastErrorAt:(0,r.timestamp)("last_error_at"),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()}),e1=(0,a.pgTable)("service_titan_job_forms",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),formId:(0,x.bigint)("form_id",{mode:"number"}).notNull(),jobId:(0,x.bigint)("job_id",{mode:"number"}).notNull(),customerId:(0,n.integer)("customer_id").notNull(),formTemplateId:(0,x.bigint)("form_template_id",{mode:"number"}),formTemplateName:(0,o.text)("form_template_name"),rawFormData:(0,g.jsonb)("raw_form_data").notNull(),parsedFields:(0,g.jsonb)("parsed_fields").notNull(),technicianNotes:(0,o.text)("technician_notes"),customerConcerns:(0,o.text)("customer_concerns").array(),recommendationsMade:(0,o.text)("recommendations_made").array(),equipmentCondition:(0,o.text)("equipment_condition"),submittedOn:(0,r.timestamp)("submitted_on").notNull(),submittedBy:(0,o.text)("submitted_by"),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({jobIdIdx:c("st_job_forms_job_id_idx").on(e.jobId),customerIdIdx:c("st_job_forms_customer_id_idx").on(e.customerId),formIdIdx:c("st_job_forms_form_id_idx").on(e.formId)})),e2=(0,a.pgTable)("service_titan_estimates",{id:(0,x.bigint)("id",{mode:"number"}).primaryKey(),jobId:(0,x.bigint)("job_id",{mode:"number"}),customerId:(0,n.integer)("customer_id").notNull(),name:(0,o.text)("name"),summary:(0,o.text)("summary"),status:(0,i.varchar)("status").notNull(),soldBy:(0,o.text)("sold_by"),soldOn:(0,r.timestamp)("sold_on"),dismissedBy:(0,o.text)("dismissed_by"),dismissedOn:(0,r.timestamp)("dismissed_on"),subtotal:(0,n.integer)("subtotal").notNull().default(0),tax:(0,n.integer)("tax").notNull().default(0),total:(0,n.integer)("total").notNull().default(0),createdBy:(0,o.text)("created_by"),createdOn:(0,r.timestamp)("created_on").notNull(),modifiedOn:(0,r.timestamp)("modified_on"),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({jobIdIdx:c("st_estimates_job_id_idx").on(e.jobId),customerIdIdx:c("st_estimates_customer_id_idx").on(e.customerId),statusIdx:c("st_estimates_status_idx").on(e.status),soldOnIdx:c("st_estimates_sold_on_idx").on(e.soldOn),createdOnIdx:c("st_estimates_created_on_idx").on(e.createdOn)})),e8=(0,a.pgTable)("service_titan_line_items",{id:(0,x.bigint)("id",{mode:"number"}).primaryKey(),estimateId:(0,x.bigint)("estimate_id",{mode:"number"}).notNull(),jobId:(0,x.bigint)("job_id",{mode:"number"}),customerId:(0,n.integer)("customer_id").notNull(),itemType:(0,i.varchar)("item_type").notNull(),skuId:(0,x.bigint)("sku_id",{mode:"number"}),skuName:(0,o.text)("sku_name"),description:(0,o.text)("description"),equipmentManufacturer:(0,o.text)("equipment_manufacturer"),equipmentModel:(0,o.text)("equipment_model"),equipmentSize:(0,o.text)("equipment_size"),equipmentType:(0,o.text)("equipment_type"),quantity:(0,n.integer)("quantity").notNull().default(1),unitPrice:(0,n.integer)("unit_price").notNull().default(0),totalPrice:(0,n.integer)("total_price").notNull().default(0),cost:(0,n.integer)("cost").notNull().default(0),memberPrice:(0,n.integer)("member_price"),sold:(0,l.boolean)("sold").notNull().default(!1),soldBy:(0,o.text)("sold_by"),soldOn:(0,r.timestamp)("sold_on"),lastSyncedAt:(0,r.timestamp)("last_synced_at").notNull().defaultNow()},e=>({estimateIdIdx:c("st_line_items_estimate_id_idx").on(e.estimateId),jobIdIdx:c("st_line_items_job_id_idx").on(e.jobId),customerIdIdx:c("st_line_items_customer_id_idx").on(e.customerId),itemTypeIdx:c("st_line_items_item_type_idx").on(e.itemType),skuIdIdx:c("st_line_items_sku_id_idx").on(e.skuId),equipmentTypeIdx:c("st_line_items_equipment_type_idx").on(e.equipmentType),soldIdx:c("st_line_items_sold_idx").on(e.sold),soldOnIdx:c("st_line_items_sold_on_idx").on(e.soldOn)})),e3=q(e2).omit({lastSyncedAt:!0}),e4=q(e8).omit({lastSyncedAt:!0}),e6=q(eZ).omit({id:!0,updatedAt:!0}),e5=(0,a.pgTable)("job_completions",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),jobId:(0,n.integer)("job_id").notNull().unique(),customerId:(0,n.integer)("customer_id").notNull(),customerName:(0,o.text)("customer_name").notNull(),customerEmail:(0,o.text)("customer_email"),customerPhone:(0,o.text)("customer_phone"),completionDate:(0,r.timestamp)("completion_date").notNull(),serviceName:(0,o.text)("service_name"),technicianName:(0,o.text)("technician_name"),invoiceTotal:(0,n.integer)("invoice_total"),jobNotes:(0,o.text)("job_notes"),marketingOptedOut:(0,l.boolean)("marketing_opted_out").notNull().default(!1),isQuoteOnly:(0,l.boolean)("is_quote_only").notNull().default(!1),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({completionDateIdx:c("job_completions_completion_date_idx").on(e.completionDate),customerIdIdx:c("job_completions_customer_id_idx").on(e.customerId)})),e7=(0,a.pgTable)("review_requests",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),jobCompletionId:(0,i.varchar)("job_completion_id").notNull(),customerId:(0,n.integer)("customer_id").notNull(),customerEmail:(0,o.text)("customer_email").notNull(),status:(0,o.text)("status").notNull().default("queued"),stopReason:(0,o.text)("stop_reason"),email1SentAt:(0,r.timestamp)("email1_sent_at"),email2SentAt:(0,r.timestamp)("email2_sent_at"),email3SentAt:(0,r.timestamp)("email3_sent_at"),email4SentAt:(0,r.timestamp)("email4_sent_at"),reviewSubmitted:(0,l.boolean)("review_submitted").notNull().default(!1),reviewSubmittedAt:(0,r.timestamp)("review_submitted_at"),reviewRating:(0,n.integer)("review_rating"),reviewPlatform:(0,o.text)("review_platform"),emailOpens:(0,n.integer)("email_opens").notNull().default(0),linkClicks:(0,n.integer)("link_clicks").notNull().default(0),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),completedAt:(0,r.timestamp)("completed_at")},e=>({statusIdx:c("review_requests_status_idx").on(e.status),customerIdIdx:c("review_requests_customer_id_idx").on(e.customerId),createdAtIdx:c("review_requests_created_at_idx").on(e.createdAt)})),e9=(0,a.pgTable)("review_feedback",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),reviewRequestId:(0,i.varchar)("review_request_id").notNull(),customerId:(0,n.integer)("customer_id").notNull(),rating:(0,n.integer)("rating").notNull(),feedbackText:(0,o.text)("feedback_text"),wouldRecommend:(0,l.boolean)("would_recommend"),followedUp:(0,l.boolean)("followed_up").notNull().default(!1),followedUpAt:(0,r.timestamp)("followed_up_at"),followUpNotes:(0,o.text)("follow_up_notes"),resolved:(0,l.boolean)("resolved").notNull().default(!1),submittedAt:(0,r.timestamp)("submitted_at").notNull().defaultNow()},e=>({reviewRequestIdIdx:c("review_feedback_review_request_idx").on(e.reviewRequestId),followedUpIdx:c("review_feedback_followed_up_idx").on(e.followedUp),ratingIdx:c("review_feedback_rating_idx").on(e.rating)})),te=(0,a.pgTable)("referral_nurture_campaigns",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),customerId:(0,n.integer)("customer_id").notNull().unique(),customerEmail:(0,o.text)("customer_email").notNull(),originalReviewId:(0,i.varchar)("original_review_id"),status:(0,o.text)("status").notNull().default("queued"),pauseReason:(0,o.text)("pause_reason"),email1SentAt:(0,r.timestamp)("email1_sent_at"),email2SentAt:(0,r.timestamp)("email2_sent_at"),email3SentAt:(0,r.timestamp)("email3_sent_at"),email4SentAt:(0,r.timestamp)("email4_sent_at"),consecutiveUnopened:(0,n.integer)("consecutive_unopened").notNull().default(0),totalOpens:(0,n.integer)("total_opens").notNull().default(0),totalClicks:(0,n.integer)("total_clicks").notNull().default(0),referralsSubmitted:(0,n.integer)("referrals_submitted").notNull().default(0),lastReferralAt:(0,r.timestamp)("last_referral_at"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),pausedAt:(0,r.timestamp)("paused_at"),completedAt:(0,r.timestamp)("completed_at")},e=>({statusIdx:c("referral_nurture_status_idx").on(e.status),customerIdIdx:c("referral_nurture_customer_id_idx").on(e.customerId),createdAtIdx:c("referral_nurture_created_at_idx").on(e.createdAt)})),tt=(0,a.pgTable)("review_email_templates",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),campaignType:(0,o.text)("campaign_type").notNull(),emailNumber:(0,n.integer)("email_number").notNull(),subject:(0,o.text)("subject").notNull(),htmlContent:(0,o.text)("html_content").notNull(),plainTextContent:(0,o.text)("plain_text_content").notNull(),mergeFields:(0,o.text)("merge_fields").array(),isDefault:(0,l.boolean)("is_default").notNull().default(!1),customized:(0,l.boolean)("customized").notNull().default(!1),lastEditedBy:(0,i.varchar)("last_edited_by"),lastEditedAt:(0,r.timestamp)("last_edited_at"),aiGenerated:(0,l.boolean)("ai_generated").notNull().default(!1),aiPrompt:(0,o.text)("ai_prompt"),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow(),updatedAt:(0,r.timestamp)("updated_at").notNull().defaultNow()},e=>({campaignTypeIdx:c("review_email_templates_campaign_type_idx").on(e.campaignType),emailNumberIdx:c("review_email_templates_email_number_idx").on(e.emailNumber),uniqueCampaignEmail:p("review_email_templates_campaign_email_unique").on(e.campaignType,e.emailNumber)})),ta=(0,a.pgTable)("email_send_log",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),campaignType:(0,o.text)("campaign_type").notNull(),campaignRecordId:(0,i.varchar)("campaign_record_id").notNull(),emailNumber:(0,n.integer)("email_number").notNull(),recipientEmail:(0,o.text)("recipient_email").notNull(),recipientName:(0,o.text)("recipient_name"),customerId:(0,n.integer)("customer_id").notNull(),resendEmailId:(0,o.text)("resend_email_id").unique(),resendStatus:(0,o.text)("resend_status"),sentAt:(0,r.timestamp)("sent_at").notNull().defaultNow(),deliveredAt:(0,r.timestamp)("delivered_at"),openedAt:(0,r.timestamp)("opened_at"),clickedAt:(0,r.timestamp)("clicked_at"),bouncedAt:(0,r.timestamp)("bounced_at"),complainedAt:(0,r.timestamp)("complained_at"),errorMessage:(0,o.text)("error_message")},e=>({resendEmailIdIdx:c("email_send_log_resend_email_id_idx").on(e.resendEmailId),campaignTypeIdx:c("email_send_log_campaign_type_idx").on(e.campaignType),campaignRecordIdx:c("email_send_log_campaign_record_idx").on(e.campaignRecordId),recipientEmailIdx:c("email_send_log_recipient_email_idx").on(e.recipientEmail)})),to=(0,a.pgTable)("email_suppression_list",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),email:(0,o.text)("email").notNull().unique(),reason:(0,o.text)("reason").notNull(),reasonDetails:(0,o.text)("reason_details"),resendEmailId:(0,o.text)("resend_email_id"),campaignRecordId:(0,i.varchar)("campaign_record_id"),addedAt:(0,r.timestamp)("added_at").notNull().defaultNow()},e=>({emailIdx:c("email_suppression_list_email_idx").on(e.email),reasonIdx:c("email_suppression_list_reason_idx").on(e.reason)})),ti=(0,a.pgTable)("webhook_failure_queue",{id:(0,i.varchar)("id").primaryKey().default(t.sql`gen_random_uuid()`),webhookType:(0,o.text)("webhook_type").notNull(),webhookEvent:(0,o.text)("webhook_event").notNull(),rawPayload:(0,g.jsonb)("raw_payload").notNull(),headers:(0,g.jsonb)("headers").notNull(),signature:(0,o.text)("signature"),attemptCount:(0,n.integer)("attempt_count").notNull().default(0),maxAttempts:(0,n.integer)("max_attempts").notNull().default(5),nextRetryAt:(0,r.timestamp)("next_retry_at"),lastAttemptAt:(0,r.timestamp)("last_attempt_at"),lastError:(0,o.text)("last_error"),status:(0,o.text)("status").notNull().default("pending"),processedAt:(0,r.timestamp)("processed_at"),movedToDeadLetterAt:(0,r.timestamp)("moved_to_dead_letter_at"),receivedAt:(0,r.timestamp)("received_at").notNull().defaultNow(),createdAt:(0,r.timestamp)("created_at").notNull().defaultNow()},e=>({statusIdx:c("webhook_failure_queue_status_idx").on(e.status),nextRetryAtIdx:c("webhook_failure_queue_next_retry_at_idx").on(e.nextRetryAt),webhookTypeIdx:c("webhook_failure_queue_type_idx").on(e.webhookType)})),tr=q(ti).omit({id:!0,receivedAt:!0,createdAt:!0,processedAt:!0,movedToDeadLetterAt:!0,lastAttemptAt:!0}),tn=q(D).omit({id:!0,startedAt:!0,feedbackPositive:!0,feedbackNegative:!0}),tl=q(z).omit({id:!0,createdAt:!0}),td=q(O).omit({id:!0,lastAsked:!0,count:!0}),ts=q(U).omit({id:!0}),tu=q(e5).omit({id:!0,createdAt:!0}),tm=q(e7).omit({id:!0,createdAt:!0,completedAt:!0}),t_=q(e9).omit({id:!0,submittedAt:!0,followedUpAt:!0}),tc=q(te).omit({id:!0,createdAt:!0,pausedAt:!0,completedAt:!0}),tp=q(tt).omit({id:!0,createdAt:!0,updatedAt:!0}),tx=q(ta).omit({id:!0,sentAt:!0}),tg=q(to).omit({id:!0,addedAt:!0}),tf=q(X).omit({id:!0,processedAt:!0}),tN=q(F).omit({id:!0,createdAt:!0,sentAt:!0}),tb=q(V).omit({id:!0,createdAt:!0,approvedAt:!0,sentAt:!0}),ty=q(L).omit({id:!0,createdAt:!0,approvedAt:!0,sentAt:!0}),tI=q(G).omit({id:!0,createdAt:!0,lastUpdated:!0}),th=q(Q).omit({id:!0,capturedAt:!0,convertedAt:!0}),tv=q(J).omit({id:!0,createdAt:!0}),tA=q(Y).omit({id:!0,createdAt:!0,updatedAt:!0}),tT=q(W).omit({id:!0,addedAt:!0}),tS=q(Z).omit({id:!0,createdAt:!0,updatedAt:!0}),tw=q(H).omit({id:!0,createdAt:!0,updatedAt:!0}),tq=q($).omit({id:!0,sentAt:!0});e.s(["adminWhitelist",0,P,"beforeAfterComposites",0,eq,"blogPosts",0,E,"chatbotAnalytics",0,O,"chatbotConversations",0,D,"chatbotMessages",0,z,"chatbotQuickResponses",0,U,"commercialCustomers",0,eR,"companyCamPhotos",0,eS,"contactSubmissions",0,K,"contactsXlsx",0,ex,"conversionEvents",0,J,"customCampaignEmails",0,H,"customCampaignSendLog",0,$,"customEmailCampaigns",0,Z,"customReviews",0,eY,"customerDataImports",0,ef,"customerSegments",0,Y,"customerSuccessStories",0,ee,"customersXlsx",0,ep,"emailPreferences",0,G,"emailSendLog",0,ta,"emailSuppressionList",0,to,"googleOAuthTokens",0,ed,"googleReviews",0,el,"importedPhotos",0,eP,"insertBeforeAfterCompositeSchema",0,ek,"insertBlogPostSchema",0,eo,"insertChatbotAnalyticsSchema",0,td,"insertChatbotConversationSchema",0,tn,"insertChatbotMessageSchema",0,tl,"insertChatbotQuickResponseSchema",0,ts,"insertCommercialCustomerSchema",0,eD,"insertCompanyCamPhotoSchema",0,ew,"insertContactSubmissionSchema",0,er,"insertConversionEventSchema",0,tv,"insertCustomCampaignEmailSchema",0,tw,"insertCustomCampaignSendLogSchema",0,tq,"insertCustomEmailCampaignSchema",0,tS,"insertCustomReviewSchema",0,eW,"insertCustomerDataImportSchema",0,eG,"insertCustomerSegmentSchema",0,tA,"insertCustomerSuccessStorySchema",0,en,"insertEmailPreferencesSchema",0,tI,"insertEmailSendLogSchema",0,tx,"insertEmailSuppressionListSchema",0,tg,"insertGoogleOAuthTokenSchema",0,eh,"insertGoogleReviewSchema",0,eI,"insertImportedPhotoSchema",0,eK,"insertJobCompletionSchema",0,tu,"insertMailgunWebhookLogSchema",0,eL,"insertNotFoundErrorSchema",0,eM,"insertOtpVerificationSchema",0,eJ,"insertPageMetadataSchema",0,eX,"insertPendingPurchaseSchema",0,eA,"insertPendingReferralSchema",0,th,"insertProductSchema",0,ei,"insertRefereeWelcomeEmailSchema",0,tN,"insertReferralCreditUsageSchema",0,tf,"insertReferralNurtureCampaignSchema",0,tc,"insertReferrerSuccessEmailSchema",0,ty,"insertReferrerThankYouEmailSchema",0,tb,"insertReviewEmailTemplateSchema",0,tp,"insertReviewFeedbackSchema",0,t_,"insertReviewPlatformSchema",0,e6,"insertReviewRequestSchema",0,tm,"insertSegmentMembershipSchema",0,tT,"insertServiceAreaSchema",0,eb,"insertServiceTitanContactSchema",0,eV,"insertServiceTitanCustomerSchema",0,eF,"insertServiceTitanEstimateSchema",0,e3,"insertServiceTitanLineItemSchema",0,e4,"insertServiceTitanMembershipSchema",0,eT,"insertSystemSettingSchema",0,eE,"insertTrackingNumberSchema",0,ey,"insertUserSchema",0,ea,"insertWebhookFailureQueueSchema",0,tr,"insertZoomOAuthTokenSchema",0,ev,"jobCompletions",0,e5,"mailgunWebhookLogs",0,eg,"notFoundErrors",0,ej,"oauthUsers",0,C,"otpVerifications",0,eQ,"pageMetadata",0,eB,"pendingPurchases",0,eu,"pendingReferrals",0,Q,"phoneLoginLookups",0,eO,"portalAnalytics",0,ez,"portalVerifications",0,eU,"products",0,M,"refereeWelcomeEmails",0,F,"referralCodes",0,R,"referralCreditUsage",0,X,"referralNurtureCampaigns",0,te,"referrals",0,B,"referrerSuccessEmails",0,L,"referrerThankYouEmails",0,V,"reviewEmailTemplates",0,tt,"reviewFeedback",0,e9,"reviewPlatforms",0,eZ,"reviewRequests",0,e7,"segmentMembership",0,W,"serviceAreas",0,et,"serviceTitanContacts",0,ec,"serviceTitanCustomers",0,e_,"serviceTitanEstimates",0,e2,"serviceTitanJobForms",0,e1,"serviceTitanJobs",0,e$,"serviceTitanJobsStaging",0,eH,"serviceTitanLineItems",0,e8,"serviceTitanMemberships",0,em,"sessions",0,j,"syncWatermarks",0,e0,"systemSettings",0,eC,"trackingNumbers",0,eN,"users",0,k,"webhookFailureQueue",0,ti,"zoomOAuthTokens",0,es],90337)}];

//# sourceMappingURL=shared_schema_ts_d3bfe82c._.js.map