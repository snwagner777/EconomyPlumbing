module.exports=[169685,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(591119),f=a.i(699570),g=a.i(875083),h=a.i(333140),i=a.i(124348),j=a.i(292e3),k=a.i(821374),l=a.i(992258),m=a.i(563588),n=a.i(590545),o=a.i(478793),p=a.i(50944),q=a.i(238246);function r(){let{toast:a}=(0,o.useToast)(),r=(0,p.useSearchParams)(),[s,t]=(0,c.useState)(r.get("tab")||"overview"),{data:u,isLoading:v,isError:w}=(0,d.useQuery)({queryKey:["/api/admin/review-requests"]}),{data:x,isLoading:y,isError:z}=(0,d.useQuery)({queryKey:["/api/admin/email-templates"]}),{data:A,isLoading:B,isError:C}=(0,d.useQuery)({queryKey:["/api/google-reviews"]}),{data:D,isLoading:E,isError:F}=(0,d.useQuery)({queryKey:["/api/google-reviews/stats"]}),G=b=>{a({title:"Coming Soon",description:`${b} feature will be implemented in the next phase.`})};return(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2","data-testid":"heading-reputation",children:"Reputation Management"}),(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-description",children:"AI-powered review request automation and template management"})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsxs)(e.Card,{className:"p-6","data-testid":"stat-active-campaigns",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(l.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Active Campaigns"})]}),v?(0,b.jsx)(h.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-active-campaigns"}):w?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-active-campaigns-count",children:u?.campaigns?.filter(a=>"active"===a.status)?.length??0})]}),(0,b.jsxs)(e.Card,{className:"p-6","data-testid":"stat-pending-reviews",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(m.MessageSquare,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Pending Reviews"})]}),E?(0,b.jsx)(h.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-pending-reviews"}):F?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-pending-reviews-count",children:D?.displayableReviews||0})]}),(0,b.jsxs)(e.Card,{className:"p-6","data-testid":"stat-gmb-reviews",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(k.Star,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"GMB Reviews"})]}),B?(0,b.jsx)(h.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-gmb-reviews"}):C?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-gmb-reviews-count",children:A?.reviews?.length??0})]}),(0,b.jsxs)(e.Card,{className:"p-6","data-testid":"stat-avg-rating",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(n.ThumbsUp,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Avg Rating"})]}),E?(0,b.jsx)(h.Skeleton,{className:"h-9 w-16","data-testid":"skeleton-avg-rating"}):F?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-avg-rating-value",children:D?.averageRating?.toFixed(1)||"—"})]})]}),(0,b.jsxs)(g.Tabs,{value:s,onValueChange:a=>{t(a),window.history.pushState({},"",`/admin/reputation?tab=${a}`)},children:[(0,b.jsxs)(g.TabsList,{className:"mb-8",children:[(0,b.jsx)(g.TabsTrigger,{value:"overview","data-testid":"tab-overview",children:"Overview"}),(0,b.jsx)(g.TabsTrigger,{value:"campaigns","data-testid":"tab-campaigns",children:"Review Campaigns"}),(0,b.jsx)(g.TabsTrigger,{value:"templates","data-testid":"tab-templates",children:"Email Templates"}),(0,b.jsx)(g.TabsTrigger,{value:"gmb-reviews","data-testid":"tab-gmb-reviews",children:"GMB Reviews"})]}),(0,b.jsx)(g.TabsContent,{value:"overview",children:(0,b.jsxs)(e.Card,{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Reputation Overview"}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)(q.default,{href:"/admin/reputation?tab=campaigns",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-review-campaigns",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Review Request Campaigns"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"4-email drip campaign over 21 days to request customer reviews"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:v?(0,b.jsx)(h.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-campaigns"}):w?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[u?.campaigns?.filter(a=>"active"===a.status)?.length??0," active campaigns"]})})]}),(0,b.jsxs)(q.default,{href:"/admin/reputation?tab=templates",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-email-templates",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"AI Email Templates"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"GPT-4o generated templates with preview/edit/approve workflow"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:y?(0,b.jsx)(h.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-templates"}):z?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[x?.templates?.length??0," templates ready"]})})]}),(0,b.jsxs)(q.default,{href:"/admin/reputation?tab=gmb-reviews",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-gmb-reviews",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Google My Business Reviews"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automated fetching and AI-powered reply generation"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:B?(0,b.jsx)(h.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-gmb"}):C?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[A?.reviews?.length??0," total reviews"]})})]}),(0,b.jsxs)("div",{className:"p-6 bg-accent/50 rounded-lg","data-testid":"card-settings",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Campaign Settings"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Master email switch and campaign-specific phone numbers"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>G("Settings"),"data-testid":"button-manage-settings",children:"Manage Settings"})})]})]})})]})}),(0,b.jsx)(g.TabsContent,{value:"campaigns",children:(0,b.jsxs)(e.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Review Request Campaigns"}),(0,b.jsx)(f.Button,{"data-testid":"button-create-campaign",children:"Create Campaign"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"4-email drip campaign sent over 21 days after job completion. Automatically pauses when customer submits a review."}),v?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(h.Skeleton,{className:"h-6 w-48 mb-2","data-testid":`skeleton-campaign-${a}`}),(0,b.jsx)(h.Skeleton,{className:"h-4 w-64","data-testid":`skeleton-campaign-desc-${a}`})]},a))}):w?(0,b.jsxs)(i.Alert,{variant:"destructive",children:[(0,b.jsx)(j.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(i.AlertDescription,{children:"Failed to load review request campaigns. Please try again."})]}):u?.campaigns&&u.campaigns.length>0?(0,b.jsx)("div",{className:"space-y-3",children:u.campaigns.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`campaign-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.customerName}),(0,b.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"active"===a.status?"bg-green-500/10 text-green-600":"completed"===a.status?"bg-blue-500/10 text-blue-600":"paused"===a.status?"bg-yellow-500/10 text-yellow-600":"bg-gray-500/10 text-gray-600"}`,"data-testid":`status-${a.id}`,children:a.status}),(0,b.jsxs)("span",{className:"text-xs bg-gray-500/10 text-gray-600 px-2 py-0.5 rounded","data-testid":`email-${a.id}`,children:["Email ",a.currentEmail||1,"/4"]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.email," • Started ",new Date(a.startedAt).toLocaleDateString()]}),a.lastEmailSent&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["Last email: ",new Date(a.lastEmailSent).toLocaleDateString()]})]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>G("Campaign details"),"data-testid":`button-view-${a.id}`,children:"View"})]})},a.id))}):(0,b.jsx)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-campaigns",children:"No active review request campaigns"})})]})}),(0,b.jsx)(g.TabsContent,{value:"templates",children:(0,b.jsxs)(e.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"AI Email Templates"}),(0,b.jsx)(f.Button,{"data-testid":"button-generate-template",children:"Generate Template"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"GPT-4o powered email templates with preview, edit, and approve workflow. Templates support merge tags for personalization."}),y?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(h.Skeleton,{className:"h-6 w-64 mb-2","data-testid":`skeleton-template-${a}`}),(0,b.jsx)(h.Skeleton,{className:"h-4 w-48","data-testid":`skeleton-template-desc-${a}`})]},a))}):z?(0,b.jsxs)(i.Alert,{variant:"destructive",children:[(0,b.jsx)(j.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(i.AlertDescription,{children:"Failed to load email templates. Please try again."})]}):x?.templates&&x.templates.length>0?(0,b.jsx)("div",{className:"space-y-3",children:x.templates.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`template-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.subject}),(0,b.jsxs)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded","data-testid":`type-${a.id}`,children:["Email ",a.emailNumber]}),a.generatedByAI&&(0,b.jsx)("span",{className:"text-xs bg-blue-500/10 text-blue-600 px-2 py-0.5 rounded",children:"AI Generated"})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.campaignType," • Created ",new Date(a.createdAt).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>G("Template preview"),"data-testid":`button-preview-${a.id}`,children:"Preview"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>G("Template edit"),"data-testid":`button-edit-${a.id}`,children:"Edit"})]})]})},a.id))}):(0,b.jsxs)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:[(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-templates",children:"No email templates yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Generate your first AI-powered email template"})]})]})}),(0,b.jsx)(g.TabsContent,{value:"gmb-reviews",children:(0,b.jsxs)(e.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Google My Business Reviews"}),(0,b.jsx)(f.Button,{"data-testid":"button-fetch-gmb-reviews",children:"Fetch Latest Reviews"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"Automatically fetched GMB reviews with AI-powered reply generation and moderation workflow."}),B?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(h.Skeleton,{className:"h-6 w-40 mb-2","data-testid":`skeleton-gmb-review-${a}`}),(0,b.jsx)(h.Skeleton,{className:"h-4 w-full mb-2","data-testid":`skeleton-gmb-review-text-${a}`}),(0,b.jsx)(h.Skeleton,{className:"h-4 w-32","data-testid":`skeleton-gmb-review-date-${a}`})]},a))}):C?(0,b.jsxs)(i.Alert,{variant:"destructive",children:[(0,b.jsx)(j.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(i.AlertDescription,{children:"Failed to load GMB reviews. Please try again."})]}):A?.reviews&&A.reviews.length>0?(0,b.jsx)("div",{className:"space-y-3",children:A.reviews.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`gmb-review-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.authorName}),(0,b.jsx)("div",{className:"flex items-center",children:[void 0,void 0,void 0,void 0,void 0].map((c,d)=>(0,b.jsx)(k.Star,{className:`h-4 w-4 ${d<a.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},d))}),a.replyText&&(0,b.jsx)("span",{className:"text-xs bg-green-500/10 text-green-600 px-2 py-0.5 rounded",children:"Replied"})]}),(0,b.jsx)("p",{className:"text-sm mb-2",children:a.text}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(a.createTime).toLocaleDateString()})]}),!a.replyText&&(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>G("Generate AI reply"),"data-testid":`button-reply-${a.id}`,children:"Generate Reply"})]})},a.id))}):(0,b.jsxs)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:[(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-gmb-reviews",children:"No GMB reviews found"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "Fetch Latest Reviews" to import from Google My Business'})]})]})})]})]})})}a.s(["default",()=>r])}];

//# sourceMappingURL=app_admin_reputation_reputation-dashboard_tsx_b76c061e._.js.map