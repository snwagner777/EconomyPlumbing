module.exports=[70987,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33217),e=a.i(50944),f=a.i(75083),g=a.i(91119),h=a.i(99570),i=a.i(33140),j=a.i(24348),k=a.i(38246),l=a.i(77430),m=a.i(92e3);function n(){let a=(0,e.useRouter)(),n=(0,e.useSearchParams)(),{toast:o}=(0,l.useToast)(),[p,q]=(0,c.useState)(n.get("tab")||"overview");(0,c.useEffect)(()=>{let a=n.get("tab");a&&q(a)},[n]);let r=a=>{o({title:"Feature Coming Soon",description:`${a} functionality will be available in the next update.`})},{data:s,isLoading:t,isError:u}=(0,d.useQuery)({queryKey:["/api/admin/review-requests"]}),{data:v,isLoading:w,isError:x}=(0,d.useQuery)({queryKey:["/api/admin/referral-campaigns"]}),{data:y,isLoading:z,isError:A}=(0,d.useQuery)({queryKey:["/api/admin/tracking-numbers"]}),{data:B,isLoading:C,isError:D}=(0,d.useQuery)({queryKey:["/api/admin/email-templates"]});return(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2","data-testid":"heading-marketing",children:"Marketing Automation"}),(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-description",children:"Manage campaigns, email templates, and phone tracking"})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsxs)(g.Card,{className:"p-6","data-testid":"stat-review-requests",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Active Review Requests"}),t?(0,b.jsx)(i.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-review-requests"}):u?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-review-requests-count",children:s?.requests?.filter(a=>"sent"===a.status).length||0})]}),(0,b.jsxs)(g.Card,{className:"p-6","data-testid":"stat-referral-campaigns",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Referral Campaigns"}),w?(0,b.jsx)(i.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-referral-campaigns"}):x?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-referral-campaigns-count",children:v?.campaigns?.length||0})]}),(0,b.jsxs)(g.Card,{className:"p-6","data-testid":"stat-tracking-numbers",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Tracking Numbers"}),z?(0,b.jsx)(i.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-tracking-numbers"}):A?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-tracking-numbers-count",children:y?.numbers?.length||0})]}),(0,b.jsxs)(g.Card,{className:"p-6","data-testid":"stat-email-templates",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Email Templates"}),C?(0,b.jsx)(i.Skeleton,{className:"h-9 w-12","data-testid":"skeleton-email-templates"}):D?(0,b.jsx)("div",{className:"text-3xl font-bold text-destructive",children:"—"}):(0,b.jsx)("div",{className:"text-3xl font-bold","data-testid":"text-email-templates-count",children:B?.templates?.length||0})]})]}),(0,b.jsxs)(f.Tabs,{value:p,onValueChange:b=>{q(b),a.push(`/admin/marketing?tab=${b}`)},children:[(0,b.jsxs)(f.TabsList,{className:"mb-8",children:[(0,b.jsx)(f.TabsTrigger,{value:"overview","data-testid":"tab-overview",children:"Overview"}),(0,b.jsx)(f.TabsTrigger,{value:"review-requests","data-testid":"tab-review-requests",children:"Review Requests"}),(0,b.jsx)(f.TabsTrigger,{value:"referral-nurture","data-testid":"tab-referral-nurture",children:"Referral Nurture"}),(0,b.jsx)(f.TabsTrigger,{value:"tracking","data-testid":"tab-tracking",children:"Phone Tracking"}),(0,b.jsx)(f.TabsTrigger,{value:"templates","data-testid":"tab-templates",children:"Email Templates"})]}),(0,b.jsx)(f.TabsContent,{value:"overview",children:(0,b.jsxs)(g.Card,{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Marketing Overview"}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)(k.default,{href:"/admin/marketing?tab=review-requests",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-review-requests",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Review Request Campaigns"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"4-email sequence to gather customer reviews after job completion"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:t?(0,b.jsx)(i.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-review-requests"}):u?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[s?.requests?.filter(a=>"sent"===a.status).length||0," active campaigns"]})})]}),(0,b.jsxs)(k.default,{href:"/admin/marketing?tab=referral-nurture",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-referral-nurture",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Referral Nurture Campaigns"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"4-email sequence over 6 months to encourage referrals from happy customers"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:w?(0,b.jsx)(i.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-referral-campaigns"}):x?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[v?.campaigns?.length||0," enrolled customers"]})})]}),(0,b.jsxs)(k.default,{href:"/admin/marketing?tab=tracking",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-tracking-numbers",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Campaign Phone Tracking"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Dedicated tracking phone numbers for each email campaign type"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:z?(0,b.jsx)(i.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-tracking-numbers"}):A?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[y?.numbers?.length||0," tracking numbers configured"]})})]}),(0,b.jsxs)(k.default,{href:"/admin/marketing?tab=templates",className:"p-6 bg-accent/50 hover:bg-accent rounded-lg transition","data-testid":"link-email-templates",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"AI Email Templates"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"GPT-4o generated email templates with preview/edit workflow"}),(0,b.jsx)("div",{className:"mt-4 text-sm",children:C?(0,b.jsx)(i.Skeleton,{className:"h-5 w-32","data-testid":"skeleton-overview-email-templates"}):D?(0,b.jsx)("span",{className:"font-medium text-destructive",children:"—"}):(0,b.jsxs)("span",{className:"font-medium",children:[B?.templates?.length||0," templates ready"]})})]})]})})]})}),(0,b.jsx)(f.TabsContent,{value:"review-requests",children:(0,b.jsxs)(g.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Review Request Campaigns"}),(0,b.jsx)(h.Button,{"data-testid":"button-create-review-campaign",children:"Create Campaign"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"4-email drip campaign sent over 21 days to request customer reviews after job completion. Each campaign has a dedicated tracking phone number for attribution."}),t?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(i.Skeleton,{className:"h-6 w-48 mb-2","data-testid":`skeleton-review-request-${a}`}),(0,b.jsx)(i.Skeleton,{className:"h-4 w-64","data-testid":`skeleton-review-request-desc-${a}`})]},a))}):u?(0,b.jsxs)(j.Alert,{variant:"destructive",children:[(0,b.jsx)(m.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(j.AlertDescription,{children:"Failed to load review request campaigns. Please try again."})]}):s?.requests&&s.requests.length>0?(0,b.jsx)("div",{className:"space-y-3",children:s.requests.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`review-request-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.customerName}),(0,b.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"sent"===a.status?"bg-blue-500/10 text-blue-600":"opened"===a.status?"bg-green-500/10 text-green-600":"bg-gray-500/10 text-gray-600"}`,"data-testid":`status-${a.id}`,children:a.status})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.email," • Started ",new Date(a.startedAt).toLocaleDateString()]}),a.trackingNumber&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["Tracking: ",a.trackingNumber]})]}),(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>r("Campaign details"),"data-testid":`button-view-${a.id}`,children:"View"})]})},a.id))}):(0,b.jsx)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-review-requests",children:"No active review request campaigns"})})]})}),(0,b.jsx)(f.TabsContent,{value:"referral-nurture",children:(0,b.jsxs)(g.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Referral Nurture Campaigns"}),(0,b.jsx)(h.Button,{"data-testid":"button-create-referral-campaign",children:"Create Campaign"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"4-email sequence sent over 6 months (days 14, 60, 150, 210) to encourage referrals. Auto-pauses after 2 consecutive unopened emails. Each campaign has dedicated tracking number."}),w?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(i.Skeleton,{className:"h-6 w-48 mb-2","data-testid":`skeleton-referral-campaign-${a}`}),(0,b.jsx)(i.Skeleton,{className:"h-4 w-64","data-testid":`skeleton-referral-campaign-desc-${a}`})]},a))}):x?(0,b.jsxs)(j.Alert,{variant:"destructive",children:[(0,b.jsx)(m.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(j.AlertDescription,{children:"Failed to load referral nurture campaigns. Please try again."})]}):v?.campaigns&&v.campaigns.length>0?(0,b.jsx)("div",{className:"space-y-3",children:v.campaigns.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`referral-campaign-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.customerName}),a.isPaused&&(0,b.jsx)("span",{className:"text-xs bg-yellow-500/10 text-yellow-600 px-2 py-0.5 rounded","data-testid":`paused-${a.id}`,children:"Paused"}),(0,b.jsxs)("span",{className:"text-xs bg-gray-500/10 text-gray-600 px-2 py-0.5 rounded","data-testid":`email-${a.id}`,children:["Email ",a.currentEmail||1,"/4"]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.email," • Started ",new Date(a.startedAt).toLocaleDateString()]}),a.unopenedCount>0&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[a.unopenedCount," consecutive unopened emails"]})]}),(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>r("Campaign details"),"data-testid":`button-view-${a.id}`,children:"View"})]})},a.id))}):(0,b.jsx)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-referral-campaigns",children:"No active referral nurture campaigns"})})]})}),(0,b.jsx)(f.TabsContent,{value:"tracking",children:(0,b.jsxs)(g.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Campaign Phone Tracking"}),(0,b.jsx)(h.Button,{"data-testid":"button-add-tracking-number",children:"Add Tracking Number"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"Each email campaign type has its own dedicated tracking phone number for accurate attribution. All email links include automatic UTM parameters."}),z?(0,b.jsx)("div",{className:"space-y-3",children:[1,2].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(i.Skeleton,{className:"h-6 w-40 mb-2","data-testid":`skeleton-tracking-number-${a}`}),(0,b.jsx)(i.Skeleton,{className:"h-4 w-56","data-testid":`skeleton-tracking-number-desc-${a}`})]},a))}):A?(0,b.jsxs)(j.Alert,{variant:"destructive",children:[(0,b.jsx)(m.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(j.AlertDescription,{children:"Failed to load tracking numbers. Please try again."})]}):y?.numbers&&y.numbers.length>0?(0,b.jsx)("div",{className:"space-y-3",children:y.numbers.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`tracking-number-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-semibold text-lg",children:a.phoneNumber}),(0,b.jsx)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded","data-testid":`campaign-type-${a.id}`,children:a.campaignType})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.description||"No description"}),a.utmSource&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["UTM: ",a.utmSource," / ",a.utmMedium," / ",a.utmCampaign]})]}),(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>r("Edit tracking number"),"data-testid":`button-edit-${a.id}`,children:"Edit"})]})},a.id))}):(0,b.jsx)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-tracking-numbers",children:"No tracking numbers configured"})})]})}),(0,b.jsx)(f.TabsContent,{value:"templates",children:(0,b.jsxs)(g.Card,{className:"p-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"AI Email Templates"}),(0,b.jsx)(h.Button,{"data-testid":"button-generate-template",children:"Generate New Template"})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"GPT-4o powered email template generation with visual HTML preview and edit/approve workflow. Templates support dynamic variables and campaign-specific phone numbers."}),C?(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(i.Skeleton,{className:"h-6 w-64 mb-2","data-testid":`skeleton-email-template-${a}`}),(0,b.jsx)(i.Skeleton,{className:"h-4 w-48","data-testid":`skeleton-email-template-desc-${a}`})]},a))}):D?(0,b.jsxs)(j.Alert,{variant:"destructive",children:[(0,b.jsx)(m.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(j.AlertDescription,{children:"Failed to load email templates. Please try again."})]}):B?.templates&&B.templates.length>0?(0,b.jsx)("div",{className:"space-y-3",children:B.templates.map(a=>(0,b.jsx)("div",{className:"p-4 border rounded-lg","data-testid":`email-template-${a.id}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name||a.subject}),a.isAiGenerated&&(0,b.jsx)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"AI Generated"}),(0,b.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"approved"===a.status?"bg-green-500/10 text-green-600":"draft"===a.status?"bg-gray-500/10 text-gray-600":"bg-blue-500/10 text-blue-600"}`,"data-testid":`status-${a.id}`,children:a.status})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.campaignType&&(0,b.jsxs)("span",{children:["Campaign: ",a.campaignType]}),a.campaignType&&a.createdAt&&(0,b.jsx)("span",{className:"mx-2",children:"•"}),a.createdAt&&(0,b.jsxs)("span",{children:["Created ",new Date(a.createdAt).toLocaleDateString()]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>r("Template preview"),"data-testid":`button-preview-${a.id}`,children:"Preview"}),(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:()=>r("Edit template"),"data-testid":`button-edit-${a.id}`,children:"Edit"})]})]})},a.id))}):(0,b.jsxs)("div",{className:"bg-muted/30 p-8 rounded-lg text-center",children:[(0,b.jsx)("p",{className:"text-muted-foreground","data-testid":"text-empty-templates",children:"No email templates yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Generate your first AI-powered email template"})]})]})})]})]})})}a.s(["MarketingDashboard",()=>n])}];

//# sourceMappingURL=app_admin_marketing_marketing-dashboard_tsx_1f9e4cc7._.js.map