module.exports=[816201,a=>{"use strict";let b=(0,a.i(170106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],816201)},838632,a=>{"use strict";var b=a.i(849625);a.s(["Image",()=>b.default])},862722,a=>{"use strict";let b=(0,a.i(170106).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],862722)},227130,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(433217),f=a.i(370025),g=a.i(699570),h=a.i(591119),i=a.i(786304),j=a.i(333140),k=a.i(668929),l=a.i(220005),m=a.i(816201),n=a.i(862722),o=a.i(838632),p=a.i(478793);function q(){let a=(0,d.useRouter)(),{toast:q}=(0,p.useToast)(),{data:r}=(0,e.useQuery)({queryKey:["/api/admin/check"]});(0,c.useEffect)(()=>{r&&!r.isAdmin&&a.push("/admin/login")},[r,a]);let{data:s,isLoading:t}=(0,e.useQuery)({queryKey:["/api/admin/success-stories"]}),u=(0,f.useMutation)({mutationFn:async a=>await (0,k.apiRequest)("PUT",`/api/admin/success-stories/${a}/approve`),onSuccess:()=>{q({title:"Success Story Approved",description:"The success story has been approved and published."}),k.queryClient.invalidateQueries({queryKey:["/api/admin/success-stories"]})},onError:a=>{q({title:"Approval Failed",description:a.message||"An error occurred",variant:"destructive"})}}),v=(0,f.useMutation)({mutationFn:async a=>await (0,k.apiRequest)("DELETE",`/api/admin/success-stories/${a}`),onSuccess:()=>{q({title:"Success Story Deleted",description:"The success story has been removed."}),k.queryClient.invalidateQueries({queryKey:["/api/admin/success-stories"]})},onError:a=>{q({title:"Deletion Failed",description:a.message||"An error occurred",variant:"destructive"})}}),w=async()=>{await (0,k.apiRequest)("POST","/api/admin/logout"),a.push("/admin/login")};if(!r?.isAdmin)return null;let x=s?.stories||[],y=x.filter(a=>!a.approved),z=x.filter(a=>a.approved);return(0,b.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold","data-testid":"heading-admin",children:"Success Stories Admin"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Review and approve customer success stories"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>a.push("/admin"),"data-testid":"button-back",children:"Back to Admin"}),(0,b.jsxs)(g.Button,{variant:"outline",onClick:w,"data-testid":"button-logout",children:[(0,b.jsx)(l.LogOut,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Pending Review"}),(0,b.jsx)(i.Badge,{variant:"secondary",children:y.length})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:y.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Approved"}),(0,b.jsx)(i.Badge,{variant:"default",children:z.length})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:z.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Published stories"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Total"}),(0,b.jsx)(i.Badge,{variant:"outline",children:x.length})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:x.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All submissions"})]})]})]}),y.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold",children:["Pending Review (",y.length,")"]}),y.map(a=>(0,b.jsxs)(h.Card,{className:"overflow-hidden","data-testid":`story-pending-${a.id}`,children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{children:a.customerName}),(0,b.jsxs)(h.CardDescription,{className:"mt-1",children:[a.email&&`${a.email} • `,a.phone&&`${a.phone} • `,a.location]})]}),(0,b.jsx)(i.Badge,{variant:"secondary",children:"Pending"})]})}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-1",children:"Service Category"}),(0,b.jsx)(i.Badge,{children:a.serviceCategory})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-2",children:"Customer Story"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.story})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-2",children:"Before Photo"}),(0,b.jsxs)("a",{href:a.beforePhotoUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline","data-testid":`link-before-photo-${a.id}`,children:[(0,b.jsx)(o.Image,{className:"h-4 w-4"}),"View Before Photo"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-2",children:"After Photo"}),(0,b.jsxs)("a",{href:a.afterPhotoUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline","data-testid":`link-after-photo-${a.id}`,children:[(0,b.jsx)(o.Image,{className:"h-4 w-4"}),"View After Photo"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>{var b;return b=a.id,void(confirm("Approve this success story and publish it to the website?")&&u.mutate(b))},disabled:u.isPending,"data-testid":`button-approve-${a.id}`,children:[(0,b.jsx)(m.CheckCircle,{className:"h-4 w-4 mr-2"}),"Approve & Publish"]}),(0,b.jsxs)(g.Button,{variant:"destructive",onClick:()=>{var b;return b=a.id,void(confirm("Delete this success story? This action cannot be undone.")&&v.mutate(b))},disabled:v.isPending,"data-testid":`button-delete-${a.id}`,children:[(0,b.jsx)(n.XCircle,{className:"h-4 w-4 mr-2"}),"Reject"]})]})]})]},a.id))]}),z.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold",children:["Approved Stories (",z.length,")"]}),z.map(a=>(0,b.jsx)(h.Card,{className:"opacity-75","data-testid":`story-approved-${a.id}`,children:(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{children:a.customerName}),(0,b.jsxs)(h.CardDescription,{children:[a.serviceCategory," • ",a.location]})]}),(0,b.jsx)(i.Badge,{variant:"default",children:"Published"})]})})},a.id))]}),t?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(j.Skeleton,{className:"h-32 w-full"}),(0,b.jsx)(j.Skeleton,{className:"h-32 w-full"})]}):0===x.length?(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No success stories yet. Check back later!"})})}):null]})})}a.s(["default",()=>q])}];

//# sourceMappingURL=_ef22a51b._.js.map