module.exports=[673206,614228,a=>{"use strict";let b,c;var d,e=a.i(187924),f=a.i(572131),g=a.i(695245),h=a.i(159501);let i=Symbol.for("drizzle:entityKind");function j(a,b){if(!a||"object"!=typeof a)return!1;if(a instanceof b)return!0;if(!Object.prototype.hasOwnProperty.call(b,i))throw Error(`Class "${b.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let c=Object.getPrototypeOf(a).constructor;if(c)for(;c;){if(i in c&&c[i]===b[i])return!0;c=Object.getPrototypeOf(c)}return!1}Symbol.for("drizzle:hasOwnEntityKind");class k{static [i]="ColumnBuilder";config;constructor(a,b,c){this.config={name:a,keyAsName:""===a,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:b,columnType:c,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(a){return this.config.default=a,this.config.hasDefault=!0,this}$defaultFn(a){return this.config.defaultFn=a,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(a){return this.config.onUpdateFn=a,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(a){""===this.config.name&&(this.config.name=a)}}class l{constructor(a,b){this.table=a,this.config=b,this.name=b.name,this.keyAsName=b.keyAsName,this.notNull=b.notNull,this.default=b.default,this.defaultFn=b.defaultFn,this.onUpdateFn=b.onUpdateFn,this.hasDefault=b.hasDefault,this.primary=b.primaryKey,this.isUnique=b.isUnique,this.uniqueName=b.uniqueName,this.uniqueType=b.uniqueType,this.dataType=b.dataType,this.columnType=b.columnType,this.generated=b.generated,this.generatedIdentity=b.generatedIdentity}static [i]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(a){return a}mapToDriverValue(a){return a}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}let m=Symbol.for("drizzle:Name");class n{static [i]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=void 0===a?"no action":a,this}onDelete(a){return this._onDelete=void 0===a?"no action":a,this}build(a){return new o(a,this)}}class o{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [i]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[m],...d,c[0].table[m],...e];return a??`${f.join("_")}_fk`}}function p(a,...b){return a(...b)}function q(a,b){return`${a[m]}_${b.join("_")}_unique`}class r{constructor(a,b){this.name=b,this.columns=a}static [i]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(a){return new t(a,this.columns,this.nullsNotDistinctConfig,this.name)}}class s{static [i]="PgUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new r(a,this.name)}}class t{constructor(a,b,c,d){this.table=a,this.columns=b,this.name=d??q(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=c}static [i]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}function u(a,b,c){for(let d=b;d<a.length;d++){let e=a[d];if("\\"===e){d++;continue}if('"'===e)return[a.slice(b,d).replace(/\\/g,""),d+1];if(!c&&(","===e||"}"===e))return[a.slice(b,d).replace(/\\/g,""),d]}return[a.slice(b).replace(/\\/g,""),a.length]}class v extends k{foreignKeyConfigs=[];static [i]="PgColumnBuilder";array(a){return new z(this.config.name,this,a)}references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a,b){return this.config.isUnique=!0,this.config.uniqueName=a,this.config.uniqueType=b?.nulls,this}generatedAlwaysAs(a){return this.config.generated={as:a,type:"always",mode:"stored"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>p((c,d)=>{let e=new n(()=>({columns:[a],foreignColumns:[c()]}));return d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)},c,d))}buildExtraConfigColumn(a){return new x(a,this.config)}}class w extends l{constructor(a,b){b.uniqueName||(b.uniqueName=q(a,[b.name])),super(a,b),this.table=a}static [i]="PgColumn"}class x extends w{static [i]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(a){return this.indexConfig.opClass=a,this}}class y{static [i]="IndexedColumn";constructor(a,b,c,d){this.name=a,this.keyAsName=b,this.type=c,this.indexConfig=d}name;keyAsName;type;indexConfig}class z extends v{static [i]="PgArrayBuilder";constructor(a,b,c){super(a,"array","PgArray"),this.config.baseBuilder=b,this.config.size=c}build(a){let b=this.config.baseBuilder.build(a);return new A(a,this.config,b)}}class A extends w{constructor(a,b,c,d){super(a,b),this.baseColumn=c,this.range=d,this.size=b.size}size;static [i]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(a){return"string"==typeof a&&(a=function(a){let[b]=function a(b,c=0){let d=[],e=c,f=!1;for(;e<b.length;){let g=b[e];if(","===g){(f||e===c)&&d.push(""),f=!0,e++;continue}if(f=!1,"\\"===g){e+=2;continue}if('"'===g){let[a,c]=u(b,e+1,!0);d.push(a),e=c;continue}if("}"===g)return[d,e+1];if("{"===g){let[c,f]=a(b,e+1);d.push(c),e=f;continue}let[h,i]=u(b,e,!1);d.push(h),e=i}return[d,e]}(a,1);return b}(a)),a.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(a,b=!1){let c=a.map(a=>null===a?null:j(this.baseColumn,A)?this.baseColumn.mapToDriverValue(a,!0):this.baseColumn.mapToDriverValue(a));return b?c:function a(b){return`{${b.map(b=>Array.isArray(b)?a(b):"string"==typeof b?`"${b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${b}`).join(",")}}`}(c)}}let B=Symbol.for("drizzle:isPgEnum");class C extends v{static [i]="PgEnumColumnBuilder";constructor(a,b){super(a,"string","PgEnumColumn"),this.config.enum=b}build(a){return new D(a,this.config)}}class D extends w{static [i]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}class E{static [i]="Subquery";constructor(a,b,c,d=!1){this._={brand:"Subquery",sql:a,selectedFields:b,alias:c,isWith:d}}}class F extends E{static [i]="WithSubquery"}let G=(a,d)=>b?(c||(c=b.trace.getTracer("drizzle-orm","0.39.1")),p((b,c)=>c.startActiveSpan(a,a=>{try{return d(a)}catch(c){throw a.setStatus({code:b.SpanStatusCode.ERROR,message:c instanceof Error?c.message:"Unknown error"}),c}finally{a.end()}}),b,c)):d(),H=Symbol.for("drizzle:ViewBaseConfig"),I=Symbol.for("drizzle:Schema"),J=Symbol.for("drizzle:Columns"),K=Symbol.for("drizzle:ExtraConfigColumns"),L=Symbol.for("drizzle:OriginalName"),M=Symbol.for("drizzle:BaseName"),N=Symbol.for("drizzle:IsAlias"),O=Symbol.for("drizzle:ExtraConfigBuilder"),P=Symbol.for("drizzle:IsDrizzleTable");class Q{static [i]="Table";static Symbol={Name:m,Schema:I,OriginalName:L,Columns:J,ExtraConfigColumns:K,BaseName:M,IsAlias:N,ExtraConfigBuilder:O};[m];[L];[I];[J];[K];[M];[N]=!1;[P]=!0;[O]=void 0;constructor(a,b,c){this[m]=this[L]=a,this[I]=b,this[M]=c}}function R(a){return"object"==typeof a&&null!==a&&P in a}class S{static [i]="FakePrimitiveParam"}class T{static [i]="StringChunk";value;constructor(a){this.value=Array.isArray(a)?a:[a]}getSQL(){return new U([this])}}class U{constructor(a){this.queryChunks=a}static [i]="SQL";decoder=W;shouldInlineParams=!1;append(a){return this.queryChunks.push(...a.queryChunks),this}toQuery(a){return G("drizzle.buildSQL",b=>{let c=this.buildQueryFromSourceParams(this.queryChunks,a);return b?.setAttributes({"drizzle.query.text":c.sql,"drizzle.query.params":JSON.stringify(c.params)}),c})}buildQueryFromSourceParams(a,b){let c=Object.assign({},b,{inlineParams:b.inlineParams||this.shouldInlineParams,paramStartIndex:b.paramStartIndex||{value:0}}),{casing:d,escapeName:e,escapeParam:f,prepareTyping:g,inlineParams:h,paramStartIndex:i}=c;var k=a.map(a=>{if(j(a,T))return{sql:a.value.join(""),params:[]};if(j(a,V))return{sql:e(a.value),params:[]};if(void 0===a)return{sql:"",params:[]};if(Array.isArray(a)){let b=[new T("(")];for(let[c,d]of a.entries())b.push(d),c<a.length-1&&b.push(new T(", "));return b.push(new T(")")),this.buildQueryFromSourceParams(b,c)}if(j(a,U))return this.buildQueryFromSourceParams(a.queryChunks,{...c,inlineParams:h||a.shouldInlineParams});if(j(a,Q)){let b=a[Q.Symbol.Schema],c=a[Q.Symbol.Name];return{sql:void 0===b||a[N]?e(c):e(b)+"."+e(c),params:[]}}if(j(a,l)){let c=d.getColumnCasing(a);if("indexes"===b.invokeSource)return{sql:e(c),params:[]};let f=a.table[Q.Symbol.Schema];return{sql:a.table[N]||void 0===f?e(a.table[Q.Symbol.Name])+"."+e(c):e(f)+"."+e(a.table[Q.Symbol.Name])+"."+e(c),params:[]}}if(j(a,ac)){let b=a[H].schema,c=a[H].name;return{sql:void 0===b||a[H].isAlias?e(c):e(b)+"."+e(c),params:[]}}if(j(a,Y)){if(j(a.value,aa))return{sql:f(i.value++,a),params:[a],typings:["none"]};let b=null===a.value?null:a.encoder.mapToDriverValue(a.value);if(j(b,U))return this.buildQueryFromSourceParams([b],c);if(h)return{sql:this.mapInlineParam(b,c),params:[]};let d=["none"];return g&&(d=[g(a.encoder)]),{sql:f(i.value++,b),params:[b],typings:d}}return j(a,aa)?{sql:f(i.value++,a),params:[a],typings:["none"]}:j(a,U.Aliased)&&void 0!==a.fieldAlias?{sql:e(a.fieldAlias),params:[]}:j(a,E)?a._.isWith?{sql:e(a._.alias),params:[]}:this.buildQueryFromSourceParams([new T("("),a._.sql,new T(") "),new V(a._.alias)],c):a&&"function"==typeof a&&B in a&&!0===a[B]?a.schema?{sql:e(a.schema)+"."+e(a.enumName),params:[]}:{sql:e(a.enumName),params:[]}:null!=a&&"function"==typeof a.getSQL?a.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([a.getSQL()],c):this.buildQueryFromSourceParams([new T("("),a.getSQL(),new T(")")],c):h?{sql:this.mapInlineParam(a,c),params:[]}:{sql:f(i.value++,a),params:[a],typings:["none"]}});let m={sql:"",params:[]};for(let a of k)m.sql+=a.sql,m.params.push(...a.params),a.typings?.length&&(m.typings||(m.typings=[]),m.typings.push(...a.typings));return m}mapInlineParam(a,{escapeString:b}){if(null===a)return"null";if("number"==typeof a||"boolean"==typeof a)return a.toString();if("string"==typeof a)return b(a);if("object"==typeof a){let c=a.toString();return"[object Object]"===c?b(JSON.stringify(a)):b(c)}throw Error("Unexpected param value: "+a)}getSQL(){return this}as(a){return void 0===a?this:new U.Aliased(this,a)}mapWith(a){return this.decoder="function"==typeof a?{mapFromDriverValue:a}:a,this}inlineParams(){return this.shouldInlineParams=!0,this}if(a){return a?this:void 0}}class V{constructor(a){this.value=a}static [i]="Name";brand;getSQL(){return new U([this])}}let W={mapFromDriverValue:a=>a},X={mapToDriverValue:a=>a};({...W,...X});class Y{constructor(a,b=X){this.value=a,this.encoder=b}static [i]="Param";brand;getSQL(){return new U([this])}}function Z(a,...b){let c=[];for(let[d,e]of((b.length>0||a.length>0&&""!==a[0])&&c.push(new T(a[0])),b.entries()))c.push(e,new T(a[d+1]));return new U(c)}(d=Z||(Z={})).empty=function(){return new U([])},d.fromList=function(a){return new U(a)},d.raw=function(a){return new U([new T(a)])},d.join=function(a,b){let c=[];for(let[d,e]of a.entries())d>0&&void 0!==b&&c.push(b),c.push(e);return new U(c)},d.identifier=function(a){return new V(a)},d.placeholder=function(a){return new aa(a)},d.param=function(a,b){return new Y(a,b)};var $=U||(U={});class _{constructor(a,b){this.sql=a,this.fieldAlias=b}static [i]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new _(this.sql,this.fieldAlias)}}$.Aliased=_;class aa{constructor(a){this.name=a}static [i]="Placeholder";getSQL(){return new U([this])}}let ab=Symbol.for("drizzle:IsDrizzleView");class ac{static [i]="View";[H];[ab]=!0;constructor({name:a,schema:b,selectedFields:c,query:d}){this[H]={name:a,originalName:a,schema:b,selectedFields:c,query:d,isExisting:!d,isAlias:!1}}getSQL(){return new U([this])}}function ad(a,b){return{name:"string"==typeof a&&a.length>0?a:"",config:"object"==typeof a?a:b}}l.prototype.getSQL=function(){return new U([this])},Q.prototype.getSQL=function(){return new U([this])},E.prototype.getSQL=function(){return new U([this])};class ae extends v{static [i]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"always",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"byDefault",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class af extends ae{static [i]="PgBigInt53Builder";constructor(a){super(a,"number","PgBigInt53")}build(a){return new ag(a,this.config)}}class ag extends w{static [i]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class ah extends ae{static [i]="PgBigInt64Builder";constructor(a){super(a,"bigint","PgBigInt64")}build(a){return new ai(a,this.config)}}class ai extends w{static [i]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(a){return BigInt(a)}}function aj(a,b){let{name:c,config:d}=ad(a,b);return"number"===d.mode?new af(c):new ah(c)}class ak extends v{static [i]="PgBigSerial53Builder";constructor(a){super(a,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new al(a,this.config)}}class al extends w{static [i]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class am extends v{static [i]="PgBigSerial64Builder";constructor(a){super(a,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(a){return new an(a,this.config)}}class an extends w{static [i]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(a){return BigInt(a)}}function ao(a,b){let{name:c,config:d}=ad(a,b);return"number"===d.mode?new ak(c):new am(c)}class ap extends v{static [i]="PgBooleanBuilder";constructor(a){super(a,"boolean","PgBoolean")}build(a){return new aq(a,this.config)}}class aq extends w{static [i]="PgBoolean";getSQLType(){return"boolean"}}function ar(a){return new ap(a??"")}class as extends v{static [i]="PgCharBuilder";constructor(a,b){super(a,"string","PgChar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new at(a,this.config)}}class at extends w{static [i]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function au(a,b={}){let{name:c,config:d}=ad(a,b);return new as(c,d)}class av extends v{static [i]="PgCidrBuilder";constructor(a){super(a,"string","PgCidr")}build(a){return new aw(a,this.config)}}class aw extends w{static [i]="PgCidr";getSQLType(){return"cidr"}}function ax(a){return new av(a??"")}class ay extends v{static [i]="PgCustomColumnBuilder";constructor(a,b,c){super(a,"custom","PgCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new az(a,this.config)}}class az extends w{static [i]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function aA(a){return(b,c)=>{let{name:d,config:e}=ad(b,c);return new ay(d,e,a)}}class aB extends v{static [i]="PgDateColumnBaseBuilder";defaultNow(){return this.default(Z`now()`)}}class aC extends aB{static [i]="PgDateBuilder";constructor(a){super(a,"date","PgDate")}build(a){return new aD(a,this.config)}}class aD extends w{static [i]="PgDate";getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}mapToDriverValue(a){return a.toISOString()}}class aE extends aB{static [i]="PgDateStringBuilder";constructor(a){super(a,"string","PgDateString")}build(a){return new aF(a,this.config)}}class aF extends w{static [i]="PgDateString";getSQLType(){return"date"}}function aG(a,b){let{name:c,config:d}=ad(a,b);return d?.mode==="date"?new aC(c):new aE(c)}class aH extends v{static [i]="PgDoublePrecisionBuilder";constructor(a){super(a,"number","PgDoublePrecision")}build(a){return new aI(a,this.config)}}class aI extends w{static [i]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(a){return"string"==typeof a?Number.parseFloat(a):a}}function aJ(a){return new aH(a??"")}class aK extends v{static [i]="PgInetBuilder";constructor(a){super(a,"string","PgInet")}build(a){return new aL(a,this.config)}}class aL extends w{static [i]="PgInet";getSQLType(){return"inet"}}function aM(a){return new aK(a??"")}class aN extends ae{static [i]="PgIntegerBuilder";constructor(a){super(a,"number","PgInteger")}build(a){return new aO(a,this.config)}}class aO extends w{static [i]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(a){return"string"==typeof a?Number.parseInt(a):a}}function aP(a){return new aN(a??"")}class aQ extends v{static [i]="PgIntervalBuilder";constructor(a,b){super(a,"string","PgInterval"),this.config.intervalConfig=b}build(a){return new aR(a,this.config)}}class aR extends w{static [i]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let a=this.fields?` ${this.fields}`:"",b=this.precision?`(${this.precision})`:"";return`interval${a}${b}`}}function aS(a,b={}){let{name:c,config:d}=ad(a,b);return new aQ(c,d)}class aT extends v{static [i]="PgJsonBuilder";constructor(a){super(a,"json","PgJson")}build(a){return new aU(a,this.config)}}class aU extends w{static [i]="PgJson";constructor(a,b){super(a,b)}getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function aV(a){return new aT(a??"")}class aW extends v{static [i]="PgJsonbBuilder";constructor(a){super(a,"json","PgJsonb")}build(a){return new aX(a,this.config)}}class aX extends w{static [i]="PgJsonb";constructor(a,b){super(a,b)}getSQLType(){return"jsonb"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function aY(a){return new aW(a??"")}class aZ extends v{static [i]="PgLineBuilder";constructor(a){super(a,"array","PgLine")}build(a){return new a$(a,this.config)}}class a$ extends w{static [i]="PgLine";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c),Number.parseFloat(d)]}mapToDriverValue(a){return`{${a[0]},${a[1]},${a[2]}}`}}class a_ extends v{static [i]="PgLineABCBuilder";constructor(a){super(a,"json","PgLineABC")}build(a){return new a0(a,this.config)}}class a0 extends w{static [i]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return{a:Number.parseFloat(b),b:Number.parseFloat(c),c:Number.parseFloat(d)}}mapToDriverValue(a){return`{${a.a},${a.b},${a.c}}`}}function a1(a,b){let{name:c,config:d}=ad(a,b);return d?.mode&&"tuple"!==d.mode?new a_(c):new aZ(c)}class a2 extends v{static [i]="PgMacaddrBuilder";constructor(a){super(a,"string","PgMacaddr")}build(a){return new a3(a,this.config)}}class a3 extends w{static [i]="PgMacaddr";getSQLType(){return"macaddr"}}function a4(a){return new a2(a??"")}class a5 extends v{static [i]="PgMacaddr8Builder";constructor(a){super(a,"string","PgMacaddr8")}build(a){return new a6(a,this.config)}}class a6 extends w{static [i]="PgMacaddr8";getSQLType(){return"macaddr8"}}function a7(a){return new a5(a??"")}class a8 extends v{static [i]="PgNumericBuilder";constructor(a,b,c){super(a,"string","PgNumeric"),this.config.precision=b,this.config.scale=c}build(a){return new a9(a,this.config)}}class a9 extends w{static [i]="PgNumeric";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function ba(a,b){let{name:c,config:d}=ad(a,b);return new a8(c,d?.precision,d?.scale)}class bb extends v{static [i]="PgPointTupleBuilder";constructor(a){super(a,"array","PgPointTuple")}build(a){return new bc(a,this.config)}}class bc extends w{static [i]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c)]}return[a.x,a.y]}mapToDriverValue(a){return`(${a[0]},${a[1]})`}}class bd extends v{static [i]="PgPointObjectBuilder";constructor(a){super(a,"json","PgPointObject")}build(a){return new be(a,this.config)}}class be extends w{static [i]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return{x:Number.parseFloat(b),y:Number.parseFloat(c)}}return a}mapToDriverValue(a){return`(${a.x},${a.y})`}}function bf(a,b){let{name:c,config:d}=ad(a,b);return d?.mode&&"tuple"!==d.mode?new bd(c):new bb(c)}function bg(a,b){let c=new DataView(new ArrayBuffer(8));for(let d=0;d<8;d++)c.setUint8(d,a[b+d]);return c.getFloat64(0,!0)}function bh(a){let b=function(a){let b=[];for(let c=0;c<a.length;c+=2)b.push(Number.parseInt(a.slice(c,c+2),16));return new Uint8Array(b)}(a),c=0,d=b[0];c+=1;let e=new DataView(b.buffer),f=e.getUint32(c,1===d);if(c+=4,0x20000000&f&&(e.getUint32(c,1===d),c+=4),(65535&f)==1){let a=bg(b,c),d=bg(b,c+=8);return c+=8,[a,d]}throw Error("Unsupported geometry type")}class bi extends v{static [i]="PgGeometryBuilder";constructor(a){super(a,"array","PgGeometry")}build(a){return new bj(a,this.config)}}class bj extends w{static [i]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){return bh(a)}mapToDriverValue(a){return`point(${a[0]} ${a[1]})`}}class bk extends v{static [i]="PgGeometryObjectBuilder";constructor(a){super(a,"json","PgGeometryObject")}build(a){return new bl(a,this.config)}}class bl extends w{static [i]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){let b=bh(a);return{x:b[0],y:b[1]}}mapToDriverValue(a){return`point(${a.x} ${a.y})`}}function bm(a,b){let{name:c,config:d}=ad(a,b);return d?.mode&&"tuple"!==d.mode?new bk(c):new bi(c)}class bn extends v{static [i]="PgRealBuilder";constructor(a,b){super(a,"number","PgReal"),this.config.length=b}build(a){return new bo(a,this.config)}}class bo extends w{static [i]="PgReal";constructor(a,b){super(a,b)}getSQLType(){return"real"}mapFromDriverValue=a=>"string"==typeof a?Number.parseFloat(a):a}function bp(a){return new bn(a??"")}class bq extends v{static [i]="PgSerialBuilder";constructor(a){super(a,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new br(a,this.config)}}class br extends w{static [i]="PgSerial";getSQLType(){return"serial"}}function bs(a){return new bq(a??"")}class bt extends ae{static [i]="PgSmallIntBuilder";constructor(a){super(a,"number","PgSmallInt")}build(a){return new bu(a,this.config)}}class bu extends w{static [i]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=a=>"string"==typeof a?Number(a):a}function bv(a){return new bt(a??"")}class bw extends v{static [i]="PgSmallSerialBuilder";constructor(a){super(a,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bx(a,this.config)}}class bx extends w{static [i]="PgSmallSerial";getSQLType(){return"smallserial"}}function by(a){return new bw(a??"")}class bz extends v{static [i]="PgTextBuilder";constructor(a,b){super(a,"string","PgText"),this.config.enumValues=b.enum}build(a){return new bA(a,this.config)}}class bA extends w{static [i]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function bB(a,b={}){let{name:c,config:d}=ad(a,b);return new bz(c,d)}class bC extends aB{constructor(a,b,c){super(a,"string","PgTime"),this.withTimezone=b,this.precision=c,this.config.withTimezone=b,this.config.precision=c}static [i]="PgTimeBuilder";build(a){return new bD(a,this.config)}}class bD extends w{static [i]="PgTime";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`time${a}${this.withTimezone?" with time zone":""}`}}function bE(a,b={}){let{name:c,config:d}=ad(a,b);return new bC(c,d.withTimezone??!1,d.precision)}class bF extends aB{static [i]="PgTimestampBuilder";constructor(a,b,c){super(a,"date","PgTimestamp"),this.config.withTimezone=b,this.config.precision=c}build(a){return new bG(a,this.config)}}class bG extends w{static [i]="PgTimestamp";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":` (${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=a=>new Date(this.withTimezone?a:a+"+0000");mapToDriverValue=a=>a.toISOString()}class bH extends aB{static [i]="PgTimestampStringBuilder";constructor(a,b,c){super(a,"string","PgTimestampString"),this.config.withTimezone=b,this.config.precision=c}build(a){return new bI(a,this.config)}}class bI extends w{static [i]="PgTimestampString";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}}function bJ(a,b={}){let{name:c,config:d}=ad(a,b);return d?.mode==="string"?new bH(c,d.withTimezone??!1,d.precision):new bF(c,d?.withTimezone??!1,d?.precision)}class bK extends v{static [i]="PgUUIDBuilder";constructor(a){super(a,"string","PgUUID")}defaultRandom(){return this.default(Z`gen_random_uuid()`)}build(a){return new bL(a,this.config)}}class bL extends w{static [i]="PgUUID";getSQLType(){return"uuid"}}function bM(a){return new bK(a??"")}class bN extends v{static [i]="PgVarcharBuilder";constructor(a,b){super(a,"string","PgVarchar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new bO(a,this.config)}}class bO extends w{static [i]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function bP(a,b={}){let{name:c,config:d}=ad(a,b);return new bN(c,d)}class bQ extends v{static [i]="PgBinaryVectorBuilder";constructor(a,b){super(a,"string","PgBinaryVector"),this.config.dimensions=b.dimensions}build(a){return new bR(a,this.config)}}class bR extends w{static [i]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function bS(a,b){let{name:c,config:d}=ad(a,b);return new bQ(c,d)}class bT extends v{static [i]="PgHalfVectorBuilder";constructor(a,b){super(a,"array","PgHalfVector"),this.config.dimensions=b.dimensions}build(a){return new bU(a,this.config)}}class bU extends w{static [i]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function bV(a,b){let{name:c,config:d}=ad(a,b);return new bT(c,d)}class bW extends v{static [i]="PgSparseVectorBuilder";constructor(a,b){super(a,"string","PgSparseVector"),this.config.dimensions=b.dimensions}build(a){return new bX(a,this.config)}}class bX extends w{static [i]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function bY(a,b){let{name:c,config:d}=ad(a,b);return new bW(c,d)}class bZ extends v{static [i]="PgVectorBuilder";constructor(a,b){super(a,"array","PgVector"),this.config.dimensions=b.dimensions}build(a){return new b$(a,this.config)}}class b$ extends w{static [i]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function b_(a,b){let{name:c,config:d}=ad(a,b);return new bZ(c,d)}let b0=Symbol.for("drizzle:PgInlineForeignKeys"),b1=Symbol.for("drizzle:EnableRLS");class b2 extends Q{static [i]="PgTable";static Symbol=Object.assign({},Q.Symbol,{InlineForeignKeys:b0,EnableRLS:b1});[b0]=[];[b1]=!1;[Q.Symbol.ExtraConfigBuilder]=void 0}let b3=(a,b,c)=>(function(a,b,c,d,e=a){let f=new b2(a,d,e),g="function"==typeof b?b({bigint:aj,bigserial:ao,boolean:ar,char:au,cidr:ax,customType:aA,date:aG,doublePrecision:aJ,inet:aM,integer:aP,interval:aS,json:aV,jsonb:aY,line:a1,macaddr:a4,macaddr8:a7,numeric:ba,point:bf,geometry:bm,real:bp,serial:bs,smallint:bv,smallserial:by,text:bB,time:bE,timestamp:bJ,uuid:bM,varchar:bP,bit:bS,halfvec:bV,sparsevec:bY,vector:b_}):b,h=Object.fromEntries(Object.entries(g).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[b0].push(...b.buildForeignKeys(c,f)),[a,c]})),i=Object.fromEntries(Object.entries(g).map(([a,b])=>(b.setName(a),[a,b.buildExtraConfigColumn(f)]))),j=Object.assign(f,h);return j[Q.Symbol.Columns]=h,j[Q.Symbol.ExtraConfigColumns]=i,c&&(j[b2.Symbol.ExtraConfigBuilder]=c),Object.assign(j,{enableRLS:()=>(j[b2.Symbol.EnableRLS]=!0,j)})})(a,b,c,void 0);class b4{constructor(a,b){this.unique=a,this.name=b}static [i]="PgIndexBuilderOn";on(...a){return new b5(a.map(a=>{if(j(a,U))return a;let b=new y(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!1,this.name)}onOnly(...a){return new b5(a.map(a=>{if(j(a,U))return a;let b=new y(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=a.defaultConfig,b}),this.unique,!0,this.name)}using(a,...b){return new b5(b.map(a=>{if(j(a,U))return a;let b=new y(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!0,this.name,a)}}class b5{static [i]="PgIndexBuilder";config;constructor(a,b,c,d,e="btree"){this.config={name:d,columns:a,unique:b,only:c,method:e}}concurrently(){return this.config.concurrently=!0,this}with(a){return this.config.with=a,this}where(a){return this.config.where=a,this}build(a){return new b6(this.config,a)}}class b6{static [i]="PgIndex";config;constructor(a,b){this.config={...a,table:b}}}function b7(a){return new b4(!1,a)}function b8(a){return new b4(!0,a)}var b9=a.i(88780);let ca={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:0xffffff,INT32_MIN:-0x80000000,INT32_MAX:0x7fffffff,INT32_UNSIGNED_MAX:0xffffffff,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-0x8000000000000000n,INT64_MAX:0x7fffffffffffffffn,INT64_UNSIGNED_MAX:0xffffffffffffffffn};function cb(a,b){return b.includes(a.columnType)}let cc=b9.z.union([b9.z.string(),b9.z.number(),b9.z.boolean(),b9.z.null()]),cd=b9.z.union([cc,b9.z.record(b9.z.any()),b9.z.array(b9.z.any())]),ce=b9.z.custom(a=>a instanceof Buffer);function cf(a){return R(a)?a[Q.Symbol.Columns]:a[H].selectedFields}let cg={never:a=>a?.generated?.type==="always"||a?.generatedIdentity?.type==="always",optional:a=>!a.notNull||a.notNull&&a.hasDefault,nullable:a=>!a.notNull},ch=(a,b)=>(function a(b,c,d,e){let f={};for(let[g,h]of Object.entries(b)){if(!j(h,l)&&!j(h,U)&&!j(h,U.Aliased)&&"object"==typeof h){let b=R(h)||"object"==typeof h&&null!==h&&ab in h?cf(h):h;f[g]=a(b,c[g]??{},d,e);continue}let b=c[g];if(void 0!==b&&"function"!=typeof b){f[g]=b;continue}let i=j(h,l)?h:void 0,k=i?function a(b,c){let d,e=c?.zodInstance??b9.z,f=c?.coerce??{};return"enumValues"in b&&Array.isArray(b.enumValues)&&b.enumValues.length>0&&(d=b.enumValues.length?e.enum(b.enumValues):e.string()),d||(cb(b,["PgGeometry","PgPointTuple"])?d=e.tuple([e.number(),e.number()]):cb(b,["PgGeometryObject","PgPointObject"])?d=e.object({x:e.number(),y:e.number()}):cb(b,["PgHalfVector","PgVector"])?(d=e.array(e.number()),d=b.dimensions?d.length(b.dimensions):d):cb(b,["PgLine"])?d=e.tuple([e.number(),e.number(),e.number()]):cb(b,["PgLineABC"])?d=e.object({a:e.number(),b:e.number(),c:e.number()}):cb(b,["PgArray"])?(d=e.array(a(b.baseColumn,e)),d=b.size?d.length(b.size):d):"array"===b.dataType?d=e.array(e.any()):"number"===b.dataType?d=function(a,b,c){let d,e,f=a.getSQLType().includes("unsigned"),g=!1;cb(a,["MySqlTinyInt","SingleStoreTinyInt"])?(d=f?0:ca.INT8_MIN,e=f?ca.INT8_UNSIGNED_MAX:ca.INT8_MAX,g=!0):cb(a,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(d=f?0:ca.INT16_MIN,e=f?ca.INT16_UNSIGNED_MAX:ca.INT16_MAX,g=!0):cb(a,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(d=f?0:ca.INT24_MIN,e=f?ca.INT24_UNSIGNED_MAX:ca.INT24_MAX,g=cb(a,["MySqlMediumInt","SingleStoreMediumInt"])):cb(a,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(d=f?0:ca.INT32_MIN,e=f?ca.INT32_UNSIGNED_MAX:ca.INT32_MAX,g=!0):cb(a,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(d=f?0:ca.INT48_MIN,e=f?ca.INT48_UNSIGNED_MAX:ca.INT48_MAX):cb(a,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(d=(f=f||cb(a,["MySqlSerial","SingleStoreSerial"]))?0:Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER,g=!0):cb(a,["MySqlYear","SingleStoreYear"])?(d=1901,e=2155,g=!0):(d=Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER);let h=!0===c||c?.number?b.coerce.number():b.number();return h=h.min(d).max(e),g?h.int():h}(b,e,f):"bigint"===b.dataType?d=function(a,b,c){let d=a.getSQLType().includes("unsigned"),e=d?0n:ca.INT64_MIN,f=d?ca.INT64_UNSIGNED_MAX:ca.INT64_MAX;return(!0===c||c?.bigint?b.coerce.bigint():b.bigint()).min(e).max(f)}(b,e,f):"boolean"===b.dataType?d=!0===f||f.boolean?e.coerce.boolean():e.boolean():"date"===b.dataType?d=!0===f||f.date?e.coerce.date():e.date():"string"===b.dataType?d=function(a,b,c){let d,e;if(cb(a,["PgUUID"]))return b.string().uuid();let f=!1;cb(a,["PgVarchar","SQLiteText"])?d=a.length:cb(a,["MySqlVarChar","SingleStoreVarChar"])?d=a.length??ca.INT16_UNSIGNED_MAX:cb(a,["MySqlText","SingleStoreText"])&&(d="longtext"===a.textType?ca.INT32_UNSIGNED_MAX:"mediumtext"===a.textType?ca.INT24_UNSIGNED_MAX:"text"===a.textType?ca.INT16_UNSIGNED_MAX:ca.INT8_UNSIGNED_MAX),cb(a,["PgChar","MySqlChar","SingleStoreChar"])&&(d=a.length,f=!0),cb(a,["PgBinaryVector"])&&(e=/^[01]+$/,d=a.dimensions);let g=!0===c||c?.string?b.coerce.string():b.string();return g=e?g.regex(e):g,d&&f?g.length(d):d?g.max(d):g}(b,e,f):"json"===b.dataType?d=cd:"custom"===b.dataType?d=e.any():"buffer"===b.dataType&&(d=ce)),d||(d=e.any()),d}(i,e):b9.z.any(),m="function"==typeof b?b(k):k;!d.never(i)&&(f[g]=m,i&&(d.nullable(i)&&(f[g]=f[g].nullable()),d.optional(i)&&(f[g]=f[g].optional())))}return b9.z.object(f)})(cf(a),b??{},cg),ci=b3("users",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),username:bB("username").notNull().unique(),password:bB("password").notNull()});b3("oauth_users",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),email:bP("email").unique(),firstName:bP("first_name"),lastName:bP("last_name"),profileImageUrl:bP("profile_image_url"),createdAt:bJ("created_at").defaultNow(),updatedAt:bJ("updated_at").defaultNow()}),b3("sessions",{sid:bP("sid").primaryKey(),sess:aY("sess").notNull(),expire:bJ("expire").notNull()},a=>[b7("IDX_session_expire").on(a.expire)]),b3("admin_whitelist",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),email:bP("email").notNull().unique(),addedAt:bJ("added_at").defaultNow(),addedBy:bP("added_by"),notes:bB("notes")});let cj=b3("blog_posts",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),title:bB("title").notNull(),h1:bB("h1"),slug:bB("slug").notNull().unique(),content:bB("content").notNull(),excerpt:bB("excerpt"),author:bB("author").notNull().default("Economy Plumbing"),publishDate:bJ("publish_date").notNull().defaultNow(),category:bB("category").notNull(),featuredImage:bB("featured_image"),jpegFeaturedImage:bB("jpeg_featured_image"),imageId:bP("image_id"),focalPointX:aP("focal_point_x"),focalPointY:aP("focal_point_y"),metaDescription:bB("meta_description"),published:ar("published").notNull().default(!0),isScheduled:ar("is_scheduled").notNull().default(!1),scheduledFor:bJ("scheduled_for"),generatedByAI:ar("generated_by_ai").notNull().default(!1)},a=>({publishDateIdx:b7("blog_posts_publish_date_idx").on(a.publishDate),categoryIdx:b7("blog_posts_category_idx").on(a.category),publishedIdx:b7("blog_posts_published_idx").on(a.published),imageIdIdx:b7("blog_posts_image_id_idx").on(a.imageId),scheduledIdx:b7("blog_posts_scheduled_idx").on(a.isScheduled,a.scheduledFor)})),ck=b3("products",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),name:bB("name").notNull(),slug:bB("slug").notNull().unique(),description:bB("description").notNull(),price:aP("price").notNull(),category:bB("category").notNull(),sku:bB("sku"),image:bB("image"),stripeProductId:bB("stripe_product_id"),stripePriceId:bB("stripe_price_id"),features:bB("features").array(),active:ar("active").notNull().default(!0),serviceTitanMembershipTypeId:bB("service_titan_membership_type_id"),durationBillingId:bB("duration_billing_id"),serviceTitanEnabled:ar("service_titan_enabled").notNull().default(!1)},a=>({categoryIdx:b7("products_category_idx").on(a.category),activeIdx:b7("products_active_idx").on(a.active)})),cl=b3("contact_submissions",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),name:bB("name").notNull(),phone:bB("phone").notNull(),email:bB("email"),service:bB("service"),location:bB("location"),urgency:bB("urgency"),message:bB("message"),pageContext:bB("page_context"),submittedAt:bJ("submitted_at").notNull().defaultNow()},a=>({submittedAtIdx:b7("contact_submissions_submitted_at_idx").on(a.submittedAt)}));b3("referral_codes",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),code:bB("code").notNull().unique(),customerId:aP("customer_id").notNull(),customerName:bB("customer_name").notNull(),customerPhone:bB("customer_phone"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({codeIdx:b7("referral_codes_code_idx").on(a.code),customerIdIdx:b7("referral_codes_customer_id_idx").on(a.customerId)}));let cm=b3("chatbot_conversations",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),sessionId:bP("session_id").notNull(),customerEmail:bP("customer_email"),customerPhone:bP("customer_phone"),startedAt:bJ("started_at").notNull().defaultNow(),endedAt:bJ("ended_at"),pageContext:bP("page_context"),handoffRequested:ar("handoff_requested").notNull().default(!1),handoffReason:bB("handoff_reason"),emailSent:ar("email_sent").notNull().default(!1),archived:ar("archived").notNull().default(!1),notes:bB("notes"),rating:aP("rating"),feedbackPositive:aP("feedback_positive").notNull().default(0),feedbackNegative:aP("feedback_negative").notNull().default(0)},a=>({sessionIdIdx:b7("chatbot_conversations_session_id_idx").on(a.sessionId),startedAtIdx:b7("chatbot_conversations_started_at_idx").on(a.startedAt),handoffIdx:b7("chatbot_conversations_handoff_idx").on(a.handoffRequested),archivedIdx:b7("chatbot_conversations_archived_idx").on(a.archived)})),cn=b3("chatbot_messages",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),conversationId:bP("conversation_id").notNull().references(()=>cm.id,{onDelete:"cascade"}),role:bP("role").notNull(),content:bB("content").notNull(),imageUrl:bB("image_url"),feedback:bP("feedback"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({conversationIdIdx:b7("chatbot_messages_conversation_id_idx").on(a.conversationId),createdAtIdx:b7("chatbot_messages_created_at_idx").on(a.createdAt)})),co=b3("chatbot_analytics",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),question:bB("question").notNull(),category:bP("category"),count:aP("count").notNull().default(1),lastAsked:bJ("last_asked").notNull().defaultNow(),suggestedAnswer:bB("suggested_answer"),isCommon:ar("is_common").notNull().default(!1)},a=>({categoryIdx:b7("chatbot_analytics_category_idx").on(a.category),countIdx:b7("chatbot_analytics_count_idx").on(a.count),isCommonIdx:b7("chatbot_analytics_is_common_idx").on(a.isCommon)})),cp=b3("chatbot_quick_responses",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),label:bP("label").notNull(),message:bB("message").notNull(),category:bP("category"),sortOrder:aP("sort_order").notNull().default(0),active:ar("active").notNull().default(!0),icon:bP("icon")},a=>({categoryIdx:b7("chatbot_quick_responses_category_idx").on(a.category),activeIdx:b7("chatbot_quick_responses_active_idx").on(a.active),sortOrderIdx:b7("chatbot_quick_responses_sort_order_idx").on(a.sortOrder)}));b3("referrals",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),referralCode:bB("referral_code"),referrerName:bB("referrer_name").notNull(),referrerPhone:bB("referrer_phone").notNull(),referrerCustomerId:aP("referrer_customer_id"),refereeName:bB("referee_name").notNull(),refereePhone:bB("referee_phone").notNull(),refereeEmail:bB("referee_email"),refereeCustomerId:aP("referee_customer_id"),status:bB("status").notNull().default("pending"),creditAmount:aP("credit_amount").notNull().default(2500),firstJobId:bB("first_job_id"),firstJobDate:bJ("first_job_date"),firstJobAmount:aP("first_job_amount"),creditedAt:bJ("credited_at"),creditedBy:bP("credited_by"),creditNotes:bB("credit_notes"),expiresAt:bJ("expires_at"),submittedAt:bJ("submitted_at").notNull().defaultNow(),contactedAt:bJ("contacted_at"),updatedAt:bJ("updated_at").notNull().defaultNow()},a=>({referrerCustomerIdIdx:b7("referrals_referrer_customer_id_idx").on(a.referrerCustomerId),refereeCustomerIdIdx:b7("referrals_referee_customer_id_idx").on(a.refereeCustomerId),statusIdx:b7("referrals_status_idx").on(a.status),submittedAtIdx:b7("referrals_submitted_at_idx").on(a.submittedAt)}));let cq=b3("referral_credit_usage",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerId:aP("customer_id").notNull(),jobId:bB("job_id").notNull(),jobNumber:bB("job_number").notNull(),amountUsed:aP("amount_used").notNull(),usedAt:bJ("used_at").notNull(),processedAt:bJ("processed_at").notNull().defaultNow()},a=>({customerIdIdx:b7("referral_credit_usage_customer_id_idx").on(a.customerId),jobIdIdx:b8("referral_credit_usage_job_id_idx").on(a.jobId),usedAtIdx:b7("referral_credit_usage_used_at_idx").on(a.usedAt)})),cr=b3("referee_welcome_emails",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),referralId:bP("referral_id").notNull(),refereeName:bB("referee_name").notNull(),refereeEmail:bB("referee_email").notNull(),referrerName:bB("referrer_name").notNull(),subject:bB("subject").notNull(),htmlContent:bB("html_content").notNull(),plainTextContent:bB("plain_text_content").notNull(),status:bB("status").notNull().default("queued"),sentAt:bJ("sent_at"),failureReason:bB("failure_reason"),emailOpens:aP("email_opens").notNull().default(0),linkClicks:aP("link_clicks").notNull().default(0),generatedByAI:ar("generated_by_ai").notNull().default(!0),aiPrompt:bB("ai_prompt"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({referralIdIdx:b7("referee_welcome_emails_referral_id_idx").on(a.referralId),statusIdx:b7("referee_welcome_emails_status_idx").on(a.status),sentAtIdx:b7("referee_welcome_emails_sent_at_idx").on(a.sentAt),refereeEmailIdx:b7("referee_welcome_emails_referee_email_idx").on(a.refereeEmail)})),cs=b3("referrer_thank_you_emails",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),referralId:bP("referral_id").notNull(),referrerName:bB("referrer_name").notNull(),referrerEmail:bB("referrer_email").notNull(),referrerCustomerId:aP("referrer_customer_id").notNull(),refereeName:bB("referee_name").notNull(),subject:bB("subject").notNull(),htmlContent:bB("html_content").notNull(),plainTextContent:bB("plain_text_content").notNull(),status:bB("status").notNull().default("queued"),approvedAt:bJ("approved_at"),approvedBy:bP("approved_by"),sentAt:bJ("sent_at"),failureReason:bB("failure_reason"),emailOpens:aP("email_opens").notNull().default(0),linkClicks:aP("link_clicks").notNull().default(0),generatedByAI:ar("generated_by_ai").notNull().default(!0),aiPrompt:bB("ai_prompt"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({referralIdIdx:b7("referrer_thank_you_emails_referral_id_idx").on(a.referralId),statusIdx:b7("referrer_thank_you_emails_status_idx").on(a.status),sentAtIdx:b7("referrer_thank_you_emails_sent_at_idx").on(a.sentAt),referrerEmailIdx:b7("referrer_thank_you_emails_referrer_email_idx").on(a.referrerEmail),referrerCustomerIdIdx:b7("referrer_thank_you_emails_referrer_customer_id_idx").on(a.referrerCustomerId)})),ct=b3("referrer_success_emails",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),referralId:bP("referral_id").notNull(),referrerName:bB("referrer_name").notNull(),referrerEmail:bB("referrer_email").notNull(),referrerCustomerId:aP("referrer_customer_id").notNull(),refereeName:bB("referee_name").notNull(),creditAmount:aP("credit_amount").notNull(),creditExpiresAt:bJ("credit_expires_at").notNull(),currentBalance:aP("current_balance"),subject:bB("subject").notNull(),htmlContent:bB("html_content").notNull(),plainTextContent:bB("plain_text_content").notNull(),status:bB("status").notNull().default("queued"),approvedAt:bJ("approved_at"),approvedBy:bP("approved_by"),sentAt:bJ("sent_at"),failureReason:bB("failure_reason"),emailOpens:aP("email_opens").notNull().default(0),linkClicks:aP("link_clicks").notNull().default(0),generatedByAI:ar("generated_by_ai").notNull().default(!0),aiPrompt:bB("ai_prompt"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({referralIdIdx:b7("referrer_success_emails_referral_id_idx").on(a.referralId),statusIdx:b7("referrer_success_emails_status_idx").on(a.status),sentAtIdx:b7("referrer_success_emails_sent_at_idx").on(a.sentAt),referrerEmailIdx:b7("referrer_success_emails_referrer_email_idx").on(a.referrerEmail),referrerCustomerIdIdx:b7("referrer_success_emails_referrer_customer_id_idx").on(a.referrerCustomerId)})),cu=b3("email_preferences",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),email:bB("email").notNull().unique(),customerId:aP("customer_id"),marketingEmails:ar("marketing_emails").notNull().default(!0),reviewRequests:ar("review_requests").notNull().default(!0),referralEmails:ar("referral_emails").notNull().default(!0),serviceReminders:ar("service_reminders").notNull().default(!0),transactionalOnly:ar("transactional_only").notNull().default(!1),unsubscribeToken:bB("unsubscribe_token").notNull().unique(),optedOutAt:bJ("opted_out_at"),fullyUnsubscribedAt:bJ("fully_unsubscribed_at"),lastUpdated:bJ("last_updated").notNull().defaultNow(),createdAt:bJ("created_at").notNull().defaultNow()},a=>({emailIdx:b7("email_preferences_email_idx").on(a.email),customerIdIdx:b7("email_preferences_customer_id_idx").on(a.customerId),tokenIdx:b7("email_preferences_token_idx").on(a.unsubscribeToken)})),cv=b3("pending_referrals",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),referrerCustomerId:aP("referrer_customer_id").notNull(),referrerName:bB("referrer_name").notNull(),refereeName:bB("referee_name").notNull(),refereeEmail:bB("referee_email"),refereePhone:bB("referee_phone"),trackingCookie:bB("tracking_cookie").unique(),convertedToReferral:ar("converted_to_referral").notNull().default(!1),referralId:bP("referral_id"),capturedAt:bJ("captured_at").notNull().defaultNow(),convertedAt:bJ("converted_at"),expiresAt:bJ("expires_at").notNull()},a=>({referrerIdIdx:b7("pending_referrals_referrer_id_idx").on(a.referrerCustomerId),emailIdx:b7("pending_referrals_email_idx").on(a.refereeEmail),phoneIdx:b7("pending_referrals_phone_idx").on(a.refereePhone),cookieIdx:b7("pending_referrals_cookie_idx").on(a.trackingCookie),convertedIdx:b7("pending_referrals_converted_idx").on(a.convertedToReferral)})),cw=b3("conversion_events",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),eventType:bB("event_type").notNull(),source:bB("source"),utmSource:bB("utm_source"),utmMedium:bB("utm_medium"),utmCampaign:bB("utm_campaign"),utmContent:bB("utm_content"),metadata:aY("metadata"),customerId:aP("customer_id"),email:bB("email"),createdAt:bJ("created_at").notNull().defaultNow()},a=>({eventTypeIdx:b7("conversion_events_event_type_idx").on(a.eventType),createdAtIdx:b7("conversion_events_created_at_idx").on(a.createdAt),customerIdIdx:b7("conversion_events_customer_id_idx").on(a.customerId)})),cx=b3("customer_segments",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),name:bB("name").notNull().unique(),description:bB("description"),segmentType:bB("segment_type").notNull(),aiPrompt:bB("ai_prompt"),aiCriteria:aY("ai_criteria"),criteria:aY("criteria"),customerCount:aP("customer_count").notNull().default(0),lastRefreshedAt:bJ("last_refreshed_at"),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow()},a=>({nameIdx:b7("customer_segments_name_idx").on(a.name),typeIdx:b7("customer_segments_type_idx").on(a.segmentType)})),cy=b3("segment_membership",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),segmentId:bP("segment_id").notNull().references(()=>cx.id,{onDelete:"cascade"}),customerId:aP("customer_id").notNull(),addedAt:bJ("added_at").notNull().defaultNow(),addedBy:bP("added_by")},a=>({segmentCustomerIdx:b8("segment_membership_segment_customer_idx").on(a.segmentId,a.customerId),customerIdIdx:b7("segment_membership_customer_id_idx").on(a.customerId)})),cz=b3("custom_email_campaigns",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),name:bB("name").notNull().unique(),description:bB("description"),campaignType:bB("campaign_type").notNull(),segmentId:bP("segment_id").references(()=>cx.id,{onDelete:"set null"}),targetCustomerIds:aP("target_customer_ids").array(),trackingPhoneNumber:bB("tracking_phone_number"),utmCampaign:bB("utm_campaign"),utmSource:bB("utm_source").default("email"),utmMedium:bB("utm_medium").default("campaign"),status:bB("status").notNull().default("draft"),approvedBy:bP("approved_by"),approvedAt:bJ("approved_at"),scheduledFor:bJ("scheduled_for"),dripIntervalDays:aP("drip_interval_days").array(),pauseOnEngagement:ar("pause_on_engagement").notNull().default(!1),generatedByAI:ar("generated_by_ai").notNull().default(!1),aiPrompt:bB("ai_prompt"),aiGoal:bB("ai_goal"),totalSent:aP("total_sent").notNull().default(0),totalDelivered:aP("total_delivered").notNull().default(0),totalOpened:aP("total_opened").notNull().default(0),totalClicked:aP("total_clicked").notNull().default(0),totalUnsubscribed:aP("total_unsubscribed").notNull().default(0),totalBounced:aP("total_bounced").notNull().default(0),totalCalls:aP("total_calls").notNull().default(0),totalJobsBooked:aP("total_jobs_booked").notNull().default(0),totalRevenue:aP("total_revenue").notNull().default(0),dailySendLimit:aP("daily_send_limit").notNull().default(500),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow(),startedAt:bJ("started_at"),completedAt:bJ("completed_at")},a=>({nameIdx:b7("custom_campaigns_name_idx").on(a.name),statusIdx:b7("custom_campaigns_status_idx").on(a.status),segmentIdIdx:b7("custom_campaigns_segment_id_idx").on(a.segmentId),scheduledForIdx:b7("custom_campaigns_scheduled_for_idx").on(a.scheduledFor)})),cA=b3("custom_campaign_emails",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),campaignId:bP("campaign_id").notNull().references(()=>cz.id,{onDelete:"cascade"}),sequenceNumber:aP("sequence_number").notNull().default(1),daysAfterStart:aP("days_after_start").notNull().default(0),subject:bB("subject").notNull(),preheader:bB("preheader"),htmlContent:bB("html_content").notNull(),plainTextContent:bB("plain_text_content").notNull(),generatedByAI:ar("generated_by_ai").notNull().default(!1),aiStrategy:bB("ai_strategy"),aiPrompt:bB("ai_prompt"),isVariant:ar("is_variant").notNull().default(!1),variantOf:bP("variant_of"),testPercentage:aP("test_percentage"),totalSent:aP("total_sent").notNull().default(0),totalOpened:aP("total_opened").notNull().default(0),totalClicked:aP("total_clicked").notNull().default(0),enabled:ar("enabled").notNull().default(!0),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow()},a=>({campaignSequenceIdx:b7("custom_campaign_emails_campaign_sequence_idx").on(a.campaignId,a.sequenceNumber),variantOfIdx:b7("custom_campaign_emails_variant_of_idx").on(a.variantOf)})),cB=b3("custom_campaign_send_log",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),campaignId:bP("campaign_id").notNull().references(()=>cz.id,{onDelete:"cascade"}),campaignEmailId:bP("campaign_email_id").notNull().references(()=>cA.id,{onDelete:"cascade"}),customerId:aP("customer_id").notNull(),recipientEmail:bB("recipient_email").notNull(),recipientName:bB("recipient_name").notNull(),resendEmailId:bB("resend_email_id"),resendStatus:bB("resend_status"),sentAt:bJ("sent_at").notNull().defaultNow(),deliveredAt:bJ("delivered_at"),openedAt:bJ("opened_at"),clickedAt:bJ("clicked_at"),bouncedAt:bJ("bounced_at"),complainedAt:bJ("complained_at"),unsubscribedAt:bJ("unsubscribed_at"),openCount:aP("open_count").notNull().default(0),clickCount:aP("click_count").notNull().default(0),leadToJobBooking:ar("lead_to_job_booking").notNull().default(!1),jobId:aj("job_id",{mode:"number"}),revenueAttributed:aP("revenue_attributed").notNull().default(0),errorMessage:bB("error_message")},a=>({campaignCustomerIdx:b7("custom_send_log_campaign_customer_idx").on(a.campaignId,a.customerId),campaignEmailIdx:b7("custom_send_log_campaign_email_idx").on(a.campaignEmailId),sentAtIdx:b7("custom_send_log_sent_at_idx").on(a.sentAt),resendEmailIdIdx:b7("custom_send_log_resend_id_idx").on(a.resendEmailId),openedAtIdx:b7("custom_send_log_opened_at_idx").on(a.openedAt),clickedAtIdx:b7("custom_send_log_clicked_at_idx").on(a.clickedAt)})),cC=b3("customer_success_stories",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerName:bB("customer_name").notNull(),email:bB("email"),phone:bB("phone"),story:bB("story").notNull(),beforePhotoUrl:bB("before_photo_url").notNull(),afterPhotoUrl:bB("after_photo_url").notNull(),collagePhotoUrl:bB("collage_photo_url"),jpegCollagePhotoUrl:bB("jpeg_collage_photo_url"),beforeFocalX:aP("before_focal_x"),beforeFocalY:aP("before_focal_y"),afterFocalX:aP("after_focal_x"),afterFocalY:aP("after_focal_y"),serviceCategory:bB("service_category").notNull(),location:bB("location").notNull(),approved:ar("approved").notNull().default(!1),submittedAt:bJ("submitted_at").notNull().defaultNow()},a=>({submittedAtIdx:b7("customer_success_stories_submitted_at_idx").on(a.submittedAt),approvedIdx:b7("customer_success_stories_approved_idx").on(a.approved),categoryIdx:b7("customer_success_stories_category_idx").on(a.serviceCategory)})),cD=b3("service_areas",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),cityName:bB("city_name").notNull(),slug:bB("slug").notNull().unique(),region:bB("region").notNull(),metaDescription:bB("meta_description").notNull(),introContent:bB("intro_content").notNull(),neighborhoods:bB("neighborhoods").array(),landmarks:bB("landmarks").array(),localPainPoints:bB("local_pain_points").array(),seasonalIssues:bB("seasonal_issues").array(),uniqueFaqs:bB("unique_faqs").array(),testimonials:bB("testimonials").array(),population:bB("population"),zipCodes:bB("zip_codes").array(),latitude:bB("latitude"),longitude:bB("longitude")},a=>({regionIdx:b7("service_areas_region_idx").on(a.region)}));ch(ci).pick({username:!0,password:!0}),ch(cj).omit({id:!0,publishDate:!0}),ch(ck).omit({id:!0});let cE=ch(cl).omit({id:!0,submittedAt:!0});ch(cC).omit({id:!0,submittedAt:!0,approved:!0});let cF=b3("google_reviews",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),authorName:bB("author_name").notNull(),authorUrl:bB("author_url"),profilePhotoUrl:bB("profile_photo_url"),rating:aP("rating").notNull(),text:bB("text").notNull(),relativeTime:bB("relative_time").notNull(),timestamp:aP("timestamp").notNull(),fetchedAt:bJ("fetched_at").notNull().defaultNow(),categories:bB("categories").array().notNull().default(Z`ARRAY[]::text[]`),source:bB("source").notNull().default("places_api"),reviewId:bB("review_id"),replyText:bB("reply_text"),repliedAt:bJ("replied_at"),canReply:ar("can_reply").notNull().default(!1)},a=>({ratingIdx:b7("google_reviews_rating_idx").on(a.rating),timestampIdx:b7("google_reviews_timestamp_idx").on(a.timestamp),sourceIdx:b7("google_reviews_source_idx").on(a.source),repliedIdx:b7("google_reviews_replied_idx").on(a.repliedAt)})),cG=b3("google_oauth_tokens",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),service:bB("service").notNull().default("google_my_business"),accessToken:bB("access_token").notNull(),refreshToken:bB("refresh_token").notNull(),expiryDate:bJ("expiry_date").notNull(),accountId:bB("account_id"),locationId:bB("location_id"),updatedAt:bJ("updated_at").notNull().defaultNow()}),cH=b3("zoom_oauth_tokens",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),accessToken:bB("access_token").notNull(),refreshToken:bB("refresh_token").notNull(),expiresAt:bJ("expires_at").notNull(),scope:bB("scope"),tokenType:bB("token_type").notNull().default("bearer"),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow()}),cI=b3("pending_purchases",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),paymentIntentId:bB("payment_intent_id").notNull().unique(),productId:bP("product_id").notNull(),customerType:bB("customer_type").notNull(),customerName:bB("customer_name"),companyName:bB("company_name"),contactPersonName:bB("contact_person_name"),locationPhone:bB("location_phone"),extension:bB("extension"),locationName:bB("location_name"),street:bB("street").notNull(),city:bB("city").notNull(),state:bB("state").notNull(),zip:bB("zip").notNull(),billingName:bB("billing_name"),billingStreet:bB("billing_street"),billingCity:bB("billing_city"),billingState:bB("billing_state"),billingZip:bB("billing_zip"),phone:bB("phone").notNull(),email:bB("email").notNull(),createdAt:bJ("created_at").notNull().defaultNow()},a=>({paymentIntentIdIdx:b7("pending_purchases_payment_intent_id_idx").on(a.paymentIntentId)})),cJ=b3("service_titan_memberships",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerType:bB("customer_type").notNull(),customerName:bB("customer_name"),companyName:bB("company_name"),contactPersonName:bB("contact_person_name"),locationPhone:bB("location_phone"),extension:bB("extension"),locationName:bB("location_name"),street:bB("street").notNull(),city:bB("city").notNull(),state:bB("state").notNull(),zip:bB("zip").notNull(),billingName:bB("billing_name"),billingStreet:bB("billing_street"),billingCity:bB("billing_city"),billingState:bB("billing_state"),billingZip:bB("billing_zip"),phone:bB("phone").notNull(),email:bB("email").notNull(),serviceTitanMembershipTypeId:bB("service_titan_membership_type_id").notNull(),serviceTitanCustomerId:bB("service_titan_customer_id"),serviceTitanMembershipId:bB("service_titan_membership_id"),serviceTitanInvoiceId:bB("service_titan_invoice_id"),productId:bP("product_id").notNull(),stripePaymentIntentId:bB("stripe_payment_intent_id"),stripeCustomerId:bB("stripe_customer_id"),amount:aP("amount").notNull(),syncStatus:bB("sync_status").notNull().default("pending"),syncError:bB("sync_error"),lastSyncAttempt:bJ("last_sync_attempt"),syncedAt:bJ("synced_at"),purchasedAt:bJ("purchased_at").notNull().defaultNow()},a=>({customerTypeIdx:b7("st_memberships_customer_type_idx").on(a.customerType),syncStatusIdx:b7("st_memberships_sync_status_idx").on(a.syncStatus),serviceTitanCustomerIdIdx:b7("st_memberships_st_customer_id_idx").on(a.serviceTitanCustomerId),productIdIdx:b7("st_memberships_product_id_idx").on(a.productId)})),cK=b3("service_titan_customers",{id:aP("id").primaryKey(),name:bB("name").notNull(),type:bB("type").notNull(),email:bB("email"),phone:bB("phone"),mobilePhone:bB("mobile_phone"),street:bB("street"),city:bB("city"),state:bB("state"),zip:bB("zip"),active:ar("active").notNull().default(!0),balance:bB("balance"),jobCount:aP("job_count").notNull().default(0),lastServiceDate:bJ("last_service_date"),lastServiceType:bB("last_service_type"),lifetimeValue:aP("lifetime_value").notNull().default(0),customerTags:bB("customer_tags").array(),preferredContactMethod:bB("preferred_contact_method"),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({activeIdx:b7("st_customers_active_idx").on(a.active),emailIdx:b7("st_customers_email_idx").on(a.email),phoneIdx:b7("st_customers_phone_idx").on(a.phone),mobilePhoneIdx:b7("st_customers_mobile_phone_idx").on(a.mobilePhone),typeIdx:b7("st_customers_type_idx").on(a.type),jobCountIdx:b7("st_customers_job_count_idx").on(a.jobCount),lastSyncedIdx:b7("st_customers_last_synced_idx").on(a.lastSyncedAt),lastServiceDateIdx:b7("st_customers_last_service_date_idx").on(a.lastServiceDate),lifetimeValueIdx:b7("st_customers_lifetime_value_idx").on(a.lifetimeValue),preferredContactIdx:b7("st_customers_preferred_contact_idx").on(a.preferredContactMethod)})),cL=b3("service_titan_contacts",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerId:aP("customer_id").notNull(),contactType:bB("contact_type").notNull(),value:bB("value").notNull(),normalizedValue:bB("normalized_value").notNull(),isPrimary:ar("is_primary").notNull().default(!1),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({customerIdIdx:b7("st_contacts_customer_id_idx").on(a.customerId),normalizedValueIdx:b7("st_contacts_normalized_value_idx").on(a.normalizedValue),contactTypeIdx:b7("st_contacts_contact_type_idx").on(a.contactType)}));b3("customers_xlsx",{id:aP("id").primaryKey(),name:bB("name").notNull(),type:bB("type").notNull(),email:bB("email"),phone:bB("phone"),mobilePhone:bB("mobile_phone"),street:bB("street"),city:bB("city"),state:bB("state"),zip:bB("zip"),active:ar("active").notNull().default(!0),balance:bB("balance"),jobCount:aP("job_count").notNull().default(0),lastServiceDate:bJ("last_service_date"),lastServiceType:bB("last_service_type"),lifetimeValue:aP("lifetime_value").notNull().default(0),customerTags:bB("customer_tags").array(),preferredContactMethod:bB("preferred_contact_method"),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({activeIdx:b7("customers_xlsx_active_idx").on(a.active),emailIdx:b7("customers_xlsx_email_idx").on(a.email),phoneIdx:b7("customers_xlsx_phone_idx").on(a.phone),mobilePhoneIdx:b7("customers_xlsx_mobile_phone_idx").on(a.mobilePhone),typeIdx:b7("customers_xlsx_type_idx").on(a.type),jobCountIdx:b7("customers_xlsx_job_count_idx").on(a.jobCount),lastSyncedIdx:b7("customers_xlsx_last_synced_idx").on(a.lastSyncedAt),lastServiceDateIdx:b7("customers_xlsx_last_service_date_idx").on(a.lastServiceDate),lifetimeValueIdx:b7("customers_xlsx_lifetime_value_idx").on(a.lifetimeValue),preferredContactIdx:b7("customers_xlsx_preferred_contact_idx").on(a.preferredContactMethod)})),b3("contacts_xlsx",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerId:aP("customer_id").notNull(),contactType:bB("contact_type").notNull(),value:bB("value").notNull(),normalizedValue:bB("normalized_value").notNull(),isPrimary:ar("is_primary").notNull().default(!1),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({customerIdIdx:b7("contacts_xlsx_customer_id_idx").on(a.customerId),normalizedValueIdx:b7("contacts_xlsx_normalized_value_idx").on(a.normalizedValue),contactTypeIdx:b7("contacts_xlsx_contact_type_idx").on(a.contactType)}));let cM=b3("mailgun_webhook_logs",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),receivedAt:bJ("received_at").notNull().defaultNow(),messageId:bB("message_id"),sender:bB("sender"),recipient:bB("recipient"),subject:bB("subject"),signatureVerified:ar("signature_verified").notNull().default(!1),timestampAge:aP("timestamp_age"),attachmentCount:aP("attachment_count").notNull().default(0),xlsxFound:ar("xlsx_found").notNull().default(!1),xlsxFileName:bB("xlsx_file_name"),xlsxSize:aP("xlsx_size"),status:bB("status").notNull(),errorMessage:bB("error_message"),importId:bP("import_id"),processingTime:aP("processing_time")},a=>({receivedAtIdx:b7("mailgun_webhook_logs_received_at_idx").on(a.receivedAt),statusIdx:b7("mailgun_webhook_logs_status_idx").on(a.status),messageIdIdx:b7("mailgun_webhook_logs_message_id_idx").on(a.messageId)})),cN=b3("customer_data_imports",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),fileName:bB("file_name").notNull(),importedBy:bB("imported_by"),importSource:bB("import_source").notNull().default("manual"),totalRows:aP("total_rows").notNull().default(0),customersImported:aP("customers_imported").notNull().default(0),contactsImported:aP("contacts_imported").notNull().default(0),errors:aP("errors").notNull().default(0),totalLifetimeRevenue:aP("total_lifetime_revenue").notNull().default(0),customersWithRevenue:aP("customers_with_revenue").notNull().default(0),avgLifetimeRevenue:aP("avg_lifetime_revenue").notNull().default(0),maxLifetimeRevenue:aP("max_lifetime_revenue").notNull().default(0),newCustomers:aP("new_customers").notNull().default(0),revenueChange:aP("revenue_change").notNull().default(0),status:bB("status").notNull().default("processing"),errorMessage:bB("error_message"),startedAt:bJ("started_at").notNull().defaultNow(),completedAt:bJ("completed_at"),processingTime:aP("processing_time")},a=>({importSourceIdx:b7("customer_imports_source_idx").on(a.importSource),statusIdx:b7("customer_imports_status_idx").on(a.status),startedAtIdx:b7("customer_imports_started_at_idx").on(a.startedAt)})),cO=b3("tracking_numbers",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),channelKey:bB("channel_key").notNull().unique(),channelName:bB("channel_name").notNull(),displayNumber:bB("display_number").notNull(),rawNumber:bB("raw_number").notNull(),telLink:bB("tel_link").notNull(),detectionRules:bB("detection_rules").notNull(),isActive:ar("is_active").notNull().default(!0),isDefault:ar("is_default").notNull().default(!1),sortOrder:aP("sort_order").notNull().default(0),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow()},a=>({channelKeyIdx:b7("tracking_numbers_channel_key_idx").on(a.channelKey),isActiveIdx:b7("tracking_numbers_is_active_idx").on(a.isActive),isDefaultIdx:b7("tracking_numbers_is_default_idx").on(a.isDefault)}));ch(cD).omit({id:!0}),ch(cO).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cF).omit({id:!0,fetchedAt:!0}),ch(cG).omit({id:!0,updatedAt:!0}),ch(cH).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cI).omit({id:!0,createdAt:!0}),ch(cJ).omit({id:!0,purchasedAt:!0,lastSyncAttempt:!0,syncedAt:!0}),ch(b3("companycam_photos",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),companyCamPhotoId:bB("companycam_photo_id").unique(),companyCamProjectId:bB("companycam_project_id"),photoUrl:bB("photo_url").notNull(),thumbnailUrl:bB("thumbnail_url"),source:bB("source").notNull().default("companycam"),category:bB("category").notNull(),aiDescription:bB("ai_description"),tags:bB("tags").array(),qualityAnalyzed:ar("quality_analyzed").notNull().default(!1),isGoodQuality:ar("is_good_quality"),shouldKeep:ar("should_keep"),qualityScore:aP("quality_score"),qualityReasoning:bB("quality_reasoning"),analyzedAt:bJ("analyzed_at"),focalPointX:aP("focal_point_x"),focalPointY:aP("focal_point_y"),focalPointReason:bB("focal_point_reason"),suggestedBlogTopic:bB("suggested_blog_topic"),blogTopicAnalyzed:ar("blog_topic_analyzed").notNull().default(!1),blogTopicAnalyzedAt:bJ("blog_topic_analyzed_at"),uploadedAt:bJ("uploaded_at"),fetchedAt:bJ("fetched_at").notNull().defaultNow(),usedInBlogPostId:bP("used_in_blog_post_id"),usedInPageUrl:bB("used_in_page_url")},a=>({categoryIdx:b7("companycam_photos_category_idx").on(a.category),projectIdIdx:b7("companycam_photos_project_id_idx").on(a.companyCamProjectId),qualityIdx:b7("companycam_photos_quality_idx").on(a.shouldKeep),blogTopicIdx:b7("companycam_photos_blog_topic_idx").on(a.blogTopicAnalyzed,a.usedInBlogPostId)}))).omit({id:!0,fetchedAt:!0}),ch(b3("before_after_composites",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),beforePhotoId:bP("before_photo_id").notNull(),afterPhotoId:bP("after_photo_id").notNull(),compositeUrl:bB("composite_url").notNull(),jpegCompositeUrl:bB("jpeg_composite_url"),caption:bB("caption"),category:bB("category").notNull(),jobId:bB("job_id"),createdAt:bJ("created_at").notNull().defaultNow(),postedToFacebook:ar("posted_to_facebook").notNull().default(!1),postedToInstagram:ar("posted_to_instagram").notNull().default(!1),facebookPostId:bB("facebook_post_id"),instagramPostId:bB("instagram_post_id"),postedAt:bJ("posted_at")},a=>({categoryIdx:b7("before_after_composites_category_idx").on(a.category),postedIdx:b7("before_after_composites_posted_idx").on(a.postedToFacebook,a.postedToInstagram)}))).omit({id:!0,createdAt:!0});let cP=b3("system_settings",{key:bB("key").primaryKey(),value:bB("value"),updatedAt:bJ("updated_at").notNull().defaultNow()}),cQ=b3("not_found_errors",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),requestedUrl:bB("requested_url").notNull(),referrer:bB("referrer"),userAgent:bB("user_agent"),ipAddress:bB("ip_address"),timestamp:bJ("timestamp").notNull().defaultNow(),emailSent:ar("email_sent").notNull().default(!1)},a=>({timestampIdx:b7("not_found_errors_timestamp_idx").on(a.timestamp),urlIdx:b7("not_found_errors_url_idx").on(a.requestedUrl)})),cR=b3("imported_photos",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),url:bB("url").notNull(),category:bB("category").notNull(),isProductionQuality:ar("is_production_quality").notNull().default(!0),aiQuality:aP("ai_quality"),aiQualityScore:aP("ai_quality_score"),qualityReason:bB("quality_reason"),aiDescription:bB("ai_description"),aiTags:bB("ai_tags").array(),focalPointX:aP("focal_point_x"),focalPointY:aP("focal_point_y"),gdriveFileId:bB("gdrive_file_id").unique(),usedInBlog:ar("used_in_blog").notNull().default(!1),usedInBlogPostId:bB("used_in_blog_post_id"),usedInPageUrl:bB("used_in_page_url"),uploadDate:bJ("upload_date"),createdAt:bJ("created_at").notNull().defaultNow(),fetchedAt:bJ("fetched_at").notNull().defaultNow()},a=>({categoryIdx:b7("imported_photos_category_idx").on(a.category),usedIdx:b7("imported_photos_used_idx").on(a.usedInBlog),qualityIdx:b7("imported_photos_quality_idx").on(a.isProductionQuality),gdriveIdx:b7("imported_photos_gdrive_idx").on(a.gdriveFileId)}));ch(cP),ch(cQ).omit({id:!0,timestamp:!0}),ch(cR).omit({id:!0,fetchedAt:!0}),ch(b3("commercial_customers",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),name:bB("name").notNull(),logoUrl:bB("logo_url").notNull(),websiteUrl:bB("website_url"),location:bB("location"),industry:bB("industry"),customerSince:aP("customer_since"),displayOrder:aP("display_order").notNull().default(0),active:ar("active").notNull().default(!0),addedAt:bJ("added_at").notNull().defaultNow()},a=>({activeIdx:b7("commercial_customers_active_idx").on(a.active),displayOrderIdx:b7("commercial_customers_display_order_idx").on(a.displayOrder)}))).omit({id:!0,addedAt:!0}),b3("portal_analytics",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),searchType:bB("search_type").notNull(),searchValue:bB("search_value").notNull(),found:ar("found").notNull(),customerId:aP("customer_id"),timestamp:bJ("timestamp").notNull().defaultNow()},a=>({timestampIdx:b7("portal_analytics_timestamp_idx").on(a.timestamp),foundIdx:b7("portal_analytics_found_idx").on(a.found)})),b3("phone_login_lookups",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),lookupToken:bB("lookup_token").notNull().unique(),phone:bB("phone").notNull(),email:bB("email").notNull(),customerId:aP("customer_id").notNull(),expiresAt:bJ("expires_at",{withTimezone:!0}).notNull(),createdAt:bJ("created_at").defaultNow()},a=>({tokenIdx:b7("phone_login_lookups_token_idx").on(a.lookupToken),expiresIdx:b7("phone_login_lookups_expires_idx").on(a.expiresAt)})),b3("portal_verifications",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),verificationType:bB("verification_type").notNull(),contactValue:bB("contact_value").notNull(),code:bB("code").notNull(),customerIds:aP("customer_ids").array().notNull(),verified:ar("verified").notNull().default(!1),verifiedAt:bJ("verified_at",{withTimezone:!0}),expiresAt:bJ("expires_at",{withTimezone:!0}).notNull(),attempts:aP("attempts").notNull().default(0),createdAt:bJ("created_at",{withTimezone:!0}).notNull().defaultNow()},a=>({codeIdx:b7("portal_verifications_code_idx").on(a.code),contactIdx:b7("portal_verifications_contact_idx").on(a.contactValue),expiresIdx:b7("portal_verifications_expires_idx").on(a.expiresAt)})),ch(b3("page_metadata",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),path:bB("path").notNull().unique(),title:bB("title").notNull(),description:bB("description").notNull(),keywords:bB("keywords"),canonicalUrl:bB("canonical_url"),ogImage:bB("og_image"),updatedAt:bJ("updated_at").notNull().defaultNow(),createdAt:bJ("created_at").notNull().defaultNow()},a=>({pathIdx:b7("page_metadata_path_idx").on(a.path)}))).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cK).omit({lastSyncedAt:!0}),ch(cL).omit({id:!0,lastSyncedAt:!0}),ch(cM).omit({id:!0,receivedAt:!0}),ch(cN).omit({id:!0,startedAt:!0,completedAt:!0}),ch(b3("otp_verifications",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),phoneNumber:bB("phone_number").notNull(),otp:bB("otp").notNull(),verified:ar("verified").notNull().default(!1),expiresAt:bJ("expires_at").notNull(),createdAt:bJ("created_at").notNull().defaultNow()},a=>({phoneNumberIdx:b7("otp_verifications_phone_number_idx").on(a.phoneNumber),expiresAtIdx:b7("otp_verifications_expires_at_idx").on(a.expiresAt)}))).omit({id:!0,createdAt:!0}),ch(b3("custom_reviews",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerName:bB("customer_name").notNull(),email:bB("email"),phone:bB("phone"),serviceTitanCustomerId:aP("service_titan_customer_id"),rating:aP("rating").notNull(),title:bB("title"),text:bB("text").notNull(),serviceType:bB("service_type"),jobDate:bJ("job_date"),photoUrls:bB("photo_urls").array().default(Z`ARRAY[]::text[]`),status:bB("status").notNull().default("pending"),replyText:bB("reply_text"),repliedAt:bJ("replied_at"),moderatedBy:bP("moderated_by"),moderatedAt:bJ("moderated_at"),moderationNotes:bB("moderation_notes"),featured:ar("featured").notNull().default(!1),displayOnWebsite:ar("display_on_website").notNull().default(!0),submittedAt:bJ("submitted_at").notNull().defaultNow(),ipAddress:bB("ip_address"),userAgent:bB("user_agent"),source:bB("source").notNull().default("website"),requestId:bP("request_id")},a=>({statusIdx:b7("custom_reviews_status_idx").on(a.status),ratingIdx:b7("custom_reviews_rating_idx").on(a.rating),submittedAtIdx:b7("custom_reviews_submitted_at_idx").on(a.submittedAt),featuredIdx:b7("custom_reviews_featured_idx").on(a.featured),customerIdIdx:b7("custom_reviews_customer_id_idx").on(a.serviceTitanCustomerId)}))).omit({id:!0,submittedAt:!0,moderatedBy:!0,moderatedAt:!0});let cS=b3("review_platforms",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),platform:bB("platform").notNull().unique(),displayName:bB("display_name").notNull(),url:bB("url").notNull(),enabled:ar("enabled").notNull().default(!0),sortOrder:aP("sort_order").notNull().default(0),icon:bB("icon"),description:bB("description"),updatedAt:bJ("updated_at").notNull().defaultNow()});b3("service_titan_jobs_staging",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),jobId:aj("job_id",{mode:"number"}).notNull(),rawData:aY("raw_data").notNull(),fetchedAt:bJ("fetched_at").notNull().defaultNow(),processedAt:bJ("processed_at"),processingError:bB("processing_error")},a=>({jobIdIdx:b7("st_jobs_staging_job_id_idx").on(a.jobId),fetchedAtIdx:b7("st_jobs_staging_fetched_at_idx").on(a.fetchedAt),processedAtIdx:b7("st_jobs_staging_processed_at_idx").on(a.processedAt)})),b3("service_titan_jobs",{id:aj("id",{mode:"number"}).primaryKey(),jobNumber:bP("job_number").notNull(),customerId:aP("customer_id").notNull(),jobType:bP("job_type"),businessUnitId:aj("business_unit_id",{mode:"number"}),jobStatus:bP("job_status").notNull(),completedOn:bJ("completed_on"),total:aP("total").notNull().default(0),invoice:aP("invoice").notNull().default(0),serviceCategory:bP("service_category"),equipmentInstalled:bB("equipment_installed").array(),customerSatisfaction:aP("customer_satisfaction"),createdOn:bJ("created_on").notNull(),modifiedOn:bJ("modified_on").notNull(),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({customerIdIdx:b7("st_jobs_customer_id_idx").on(a.customerId),jobStatusIdx:b7("st_jobs_job_status_idx").on(a.jobStatus),completedOnIdx:b7("st_jobs_completed_on_idx").on(a.completedOn),modifiedOnIdx:b7("st_jobs_modified_on_idx").on(a.modifiedOn),jobNumberIdx:b7("st_jobs_job_number_idx").on(a.jobNumber),serviceCategoryIdx:b7("st_jobs_service_category_idx").on(a.serviceCategory),customerSatisfactionIdx:b7("st_jobs_customer_satisfaction_idx").on(a.customerSatisfaction)})),b3("sync_watermarks",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),syncType:bP("sync_type").notNull(),lastSuccessfulSyncAt:bJ("last_successful_sync_at"),lastModifiedOnFetched:bJ("last_modified_on_fetched"),recordsProcessed:aP("records_processed").notNull().default(0),syncDuration:aP("sync_duration"),lastError:bB("last_error"),lastErrorAt:bJ("last_error_at"),updatedAt:bJ("updated_at").notNull().defaultNow()}),b3("service_titan_job_forms",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),formId:aj("form_id",{mode:"number"}).notNull(),jobId:aj("job_id",{mode:"number"}).notNull(),customerId:aP("customer_id").notNull(),formTemplateId:aj("form_template_id",{mode:"number"}),formTemplateName:bB("form_template_name"),rawFormData:aY("raw_form_data").notNull(),parsedFields:aY("parsed_fields").notNull(),technicianNotes:bB("technician_notes"),customerConcerns:bB("customer_concerns").array(),recommendationsMade:bB("recommendations_made").array(),equipmentCondition:bB("equipment_condition"),submittedOn:bJ("submitted_on").notNull(),submittedBy:bB("submitted_by"),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({jobIdIdx:b7("st_job_forms_job_id_idx").on(a.jobId),customerIdIdx:b7("st_job_forms_customer_id_idx").on(a.customerId),formIdIdx:b7("st_job_forms_form_id_idx").on(a.formId)}));let cT=b3("service_titan_estimates",{id:aj("id",{mode:"number"}).primaryKey(),jobId:aj("job_id",{mode:"number"}),customerId:aP("customer_id").notNull(),name:bB("name"),summary:bB("summary"),status:bP("status").notNull(),soldBy:bB("sold_by"),soldOn:bJ("sold_on"),dismissedBy:bB("dismissed_by"),dismissedOn:bJ("dismissed_on"),subtotal:aP("subtotal").notNull().default(0),tax:aP("tax").notNull().default(0),total:aP("total").notNull().default(0),createdBy:bB("created_by"),createdOn:bJ("created_on").notNull(),modifiedOn:bJ("modified_on"),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({jobIdIdx:b7("st_estimates_job_id_idx").on(a.jobId),customerIdIdx:b7("st_estimates_customer_id_idx").on(a.customerId),statusIdx:b7("st_estimates_status_idx").on(a.status),soldOnIdx:b7("st_estimates_sold_on_idx").on(a.soldOn),createdOnIdx:b7("st_estimates_created_on_idx").on(a.createdOn)})),cU=b3("service_titan_line_items",{id:aj("id",{mode:"number"}).primaryKey(),estimateId:aj("estimate_id",{mode:"number"}).notNull(),jobId:aj("job_id",{mode:"number"}),customerId:aP("customer_id").notNull(),itemType:bP("item_type").notNull(),skuId:aj("sku_id",{mode:"number"}),skuName:bB("sku_name"),description:bB("description"),equipmentManufacturer:bB("equipment_manufacturer"),equipmentModel:bB("equipment_model"),equipmentSize:bB("equipment_size"),equipmentType:bB("equipment_type"),quantity:aP("quantity").notNull().default(1),unitPrice:aP("unit_price").notNull().default(0),totalPrice:aP("total_price").notNull().default(0),cost:aP("cost").notNull().default(0),memberPrice:aP("member_price"),sold:ar("sold").notNull().default(!1),soldBy:bB("sold_by"),soldOn:bJ("sold_on"),lastSyncedAt:bJ("last_synced_at").notNull().defaultNow()},a=>({estimateIdIdx:b7("st_line_items_estimate_id_idx").on(a.estimateId),jobIdIdx:b7("st_line_items_job_id_idx").on(a.jobId),customerIdIdx:b7("st_line_items_customer_id_idx").on(a.customerId),itemTypeIdx:b7("st_line_items_item_type_idx").on(a.itemType),skuIdIdx:b7("st_line_items_sku_id_idx").on(a.skuId),equipmentTypeIdx:b7("st_line_items_equipment_type_idx").on(a.equipmentType),soldIdx:b7("st_line_items_sold_idx").on(a.sold),soldOnIdx:b7("st_line_items_sold_on_idx").on(a.soldOn)}));ch(cT).omit({lastSyncedAt:!0}),ch(cU).omit({lastSyncedAt:!0}),ch(cS).omit({id:!0,updatedAt:!0});let cV=b3("job_completions",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),jobId:aP("job_id").notNull().unique(),customerId:aP("customer_id").notNull(),customerName:bB("customer_name").notNull(),customerEmail:bB("customer_email"),customerPhone:bB("customer_phone"),completionDate:bJ("completion_date").notNull(),serviceName:bB("service_name"),technicianName:bB("technician_name"),invoiceTotal:aP("invoice_total"),jobNotes:bB("job_notes"),marketingOptedOut:ar("marketing_opted_out").notNull().default(!1),isQuoteOnly:ar("is_quote_only").notNull().default(!1),createdAt:bJ("created_at").notNull().defaultNow()},a=>({completionDateIdx:b7("job_completions_completion_date_idx").on(a.completionDate),customerIdIdx:b7("job_completions_customer_id_idx").on(a.customerId)})),cW=b3("review_requests",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),jobCompletionId:bP("job_completion_id").notNull(),customerId:aP("customer_id").notNull(),customerEmail:bB("customer_email").notNull(),status:bB("status").notNull().default("queued"),stopReason:bB("stop_reason"),email1SentAt:bJ("email1_sent_at"),email2SentAt:bJ("email2_sent_at"),email3SentAt:bJ("email3_sent_at"),email4SentAt:bJ("email4_sent_at"),reviewSubmitted:ar("review_submitted").notNull().default(!1),reviewSubmittedAt:bJ("review_submitted_at"),reviewRating:aP("review_rating"),reviewPlatform:bB("review_platform"),emailOpens:aP("email_opens").notNull().default(0),linkClicks:aP("link_clicks").notNull().default(0),createdAt:bJ("created_at").notNull().defaultNow(),completedAt:bJ("completed_at")},a=>({statusIdx:b7("review_requests_status_idx").on(a.status),customerIdIdx:b7("review_requests_customer_id_idx").on(a.customerId),createdAtIdx:b7("review_requests_created_at_idx").on(a.createdAt)})),cX=b3("review_feedback",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),reviewRequestId:bP("review_request_id").notNull(),customerId:aP("customer_id").notNull(),rating:aP("rating").notNull(),feedbackText:bB("feedback_text"),wouldRecommend:ar("would_recommend"),followedUp:ar("followed_up").notNull().default(!1),followedUpAt:bJ("followed_up_at"),followUpNotes:bB("follow_up_notes"),resolved:ar("resolved").notNull().default(!1),submittedAt:bJ("submitted_at").notNull().defaultNow()},a=>({reviewRequestIdIdx:b7("review_feedback_review_request_idx").on(a.reviewRequestId),followedUpIdx:b7("review_feedback_followed_up_idx").on(a.followedUp),ratingIdx:b7("review_feedback_rating_idx").on(a.rating)})),cY=b3("referral_nurture_campaigns",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),customerId:aP("customer_id").notNull().unique(),customerEmail:bB("customer_email").notNull(),originalReviewId:bP("original_review_id"),status:bB("status").notNull().default("queued"),pauseReason:bB("pause_reason"),email1SentAt:bJ("email1_sent_at"),email2SentAt:bJ("email2_sent_at"),email3SentAt:bJ("email3_sent_at"),email4SentAt:bJ("email4_sent_at"),consecutiveUnopened:aP("consecutive_unopened").notNull().default(0),totalOpens:aP("total_opens").notNull().default(0),totalClicks:aP("total_clicks").notNull().default(0),referralsSubmitted:aP("referrals_submitted").notNull().default(0),lastReferralAt:bJ("last_referral_at"),createdAt:bJ("created_at").notNull().defaultNow(),pausedAt:bJ("paused_at"),completedAt:bJ("completed_at")},a=>({statusIdx:b7("referral_nurture_status_idx").on(a.status),customerIdIdx:b7("referral_nurture_customer_id_idx").on(a.customerId),createdAtIdx:b7("referral_nurture_created_at_idx").on(a.createdAt)})),cZ=b3("review_email_templates",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),campaignType:bB("campaign_type").notNull(),emailNumber:aP("email_number").notNull(),subject:bB("subject").notNull(),htmlContent:bB("html_content").notNull(),plainTextContent:bB("plain_text_content").notNull(),mergeFields:bB("merge_fields").array(),isDefault:ar("is_default").notNull().default(!1),customized:ar("customized").notNull().default(!1),lastEditedBy:bP("last_edited_by"),lastEditedAt:bJ("last_edited_at"),aiGenerated:ar("ai_generated").notNull().default(!1),aiPrompt:bB("ai_prompt"),createdAt:bJ("created_at").notNull().defaultNow(),updatedAt:bJ("updated_at").notNull().defaultNow()},a=>({campaignTypeIdx:b7("review_email_templates_campaign_type_idx").on(a.campaignType),emailNumberIdx:b7("review_email_templates_email_number_idx").on(a.emailNumber),uniqueCampaignEmail:b8("review_email_templates_campaign_email_unique").on(a.campaignType,a.emailNumber)})),c$=b3("email_send_log",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),campaignType:bB("campaign_type").notNull(),campaignRecordId:bP("campaign_record_id").notNull(),emailNumber:aP("email_number").notNull(),recipientEmail:bB("recipient_email").notNull(),recipientName:bB("recipient_name"),customerId:aP("customer_id").notNull(),resendEmailId:bB("resend_email_id").unique(),resendStatus:bB("resend_status"),sentAt:bJ("sent_at").notNull().defaultNow(),deliveredAt:bJ("delivered_at"),openedAt:bJ("opened_at"),clickedAt:bJ("clicked_at"),bouncedAt:bJ("bounced_at"),complainedAt:bJ("complained_at"),errorMessage:bB("error_message")},a=>({resendEmailIdIdx:b7("email_send_log_resend_email_id_idx").on(a.resendEmailId),campaignTypeIdx:b7("email_send_log_campaign_type_idx").on(a.campaignType),campaignRecordIdx:b7("email_send_log_campaign_record_idx").on(a.campaignRecordId),recipientEmailIdx:b7("email_send_log_recipient_email_idx").on(a.recipientEmail)})),c_=b3("email_suppression_list",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),email:bB("email").notNull().unique(),reason:bB("reason").notNull(),reasonDetails:bB("reason_details"),resendEmailId:bB("resend_email_id"),campaignRecordId:bP("campaign_record_id"),addedAt:bJ("added_at").notNull().defaultNow()},a=>({emailIdx:b7("email_suppression_list_email_idx").on(a.email),reasonIdx:b7("email_suppression_list_reason_idx").on(a.reason)}));ch(b3("webhook_failure_queue",{id:bP("id").primaryKey().default(Z`gen_random_uuid()`),webhookType:bB("webhook_type").notNull(),webhookEvent:bB("webhook_event").notNull(),rawPayload:aY("raw_payload").notNull(),headers:aY("headers").notNull(),signature:bB("signature"),attemptCount:aP("attempt_count").notNull().default(0),maxAttempts:aP("max_attempts").notNull().default(5),nextRetryAt:bJ("next_retry_at"),lastAttemptAt:bJ("last_attempt_at"),lastError:bB("last_error"),status:bB("status").notNull().default("pending"),processedAt:bJ("processed_at"),movedToDeadLetterAt:bJ("moved_to_dead_letter_at"),receivedAt:bJ("received_at").notNull().defaultNow(),createdAt:bJ("created_at").notNull().defaultNow()},a=>({statusIdx:b7("webhook_failure_queue_status_idx").on(a.status),nextRetryAtIdx:b7("webhook_failure_queue_next_retry_at_idx").on(a.nextRetryAt),webhookTypeIdx:b7("webhook_failure_queue_type_idx").on(a.webhookType)}))).omit({id:!0,receivedAt:!0,createdAt:!0,processedAt:!0,movedToDeadLetterAt:!0,lastAttemptAt:!0}),ch(cm).omit({id:!0,startedAt:!0,feedbackPositive:!0,feedbackNegative:!0}),ch(cn).omit({id:!0,createdAt:!0}),ch(co).omit({id:!0,lastAsked:!0,count:!0}),ch(cp).omit({id:!0}),ch(cV).omit({id:!0,createdAt:!0}),ch(cW).omit({id:!0,createdAt:!0,completedAt:!0}),ch(cX).omit({id:!0,submittedAt:!0,followedUpAt:!0}),ch(cY).omit({id:!0,createdAt:!0,pausedAt:!0,completedAt:!0}),ch(cZ).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(c$).omit({id:!0,sentAt:!0}),ch(c_).omit({id:!0,addedAt:!0}),ch(cq).omit({id:!0,processedAt:!0}),ch(cr).omit({id:!0,createdAt:!0,sentAt:!0}),ch(cs).omit({id:!0,createdAt:!0,approvedAt:!0,sentAt:!0}),ch(ct).omit({id:!0,createdAt:!0,approvedAt:!0,sentAt:!0}),ch(cu).omit({id:!0,createdAt:!0,lastUpdated:!0}),ch(cv).omit({id:!0,capturedAt:!0,convertedAt:!0}),ch(cw).omit({id:!0,createdAt:!0}),ch(cx).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cy).omit({id:!0,addedAt:!0}),ch(cz).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cA).omit({id:!0,createdAt:!0,updatedAt:!0}),ch(cB).omit({id:!0,sentAt:!0});var c0=a.i(370025),c1=a.i(668929),c2=a.i(478793),c3=a.i(591119),c4=a.i(699570),c5=a.i(866718),c6=a.i(429246),c7=a.i(441921),c8=a.i(580701);a.i(680115);var c9=a.i(583930);function da({title:a="Get a Free Estimate",description:b="Contact us today for expert plumbing services. We'll respond within 1 hour during business hours.",defaultService:c,defaultLocation:d,pageContext:i="Website Contact Form",phoneNumber:j,phoneLabel:k="Austin",className:l="",phoneTel:m}){let n=(0,c9.usePhoneConfig)(),{toast:o}=(0,c2.useToast)(),[p,q]=(0,f.useState)(!1),[r]=(0,f.useState)(Date.now()),s=j||n.display,t=m||n.tel,u=(0,g.useForm)({resolver:(0,h.zodResolver)(cE),defaultValues:{name:"",phone:"",email:"",service:c||"",location:d||"",urgency:"",message:"",pageContext:i}}),[v,w]=(0,f.useState)(""),x=(0,c0.useMutation)({mutationFn:async a=>(await (0,c1.apiRequest)("POST","/api/contact",{...a,website:v,formStartTime:r})).json(),onSuccess:()=>{q(!0),u.reset(),o({title:"Message Sent!",description:"We'll contact you within 1 hour during business hours."})},onError:a=>{o({title:"Error",description:a.message||"Failed to send message. Please call us instead.",variant:"destructive"})}});return p?(0,e.jsx)("section",{className:l,children:(0,e.jsxs)(c3.Card,{className:"p-8 max-w-2xl mx-auto text-center",children:[(0,e.jsx)("h3",{className:"text-2xl font-bold mb-4",children:"Thank You!"}),(0,e.jsx)("p",{className:"text-muted-foreground mb-6",children:"We've received your message and will contact you within 1 hour during business hours."}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Need immediate assistance?"}),(0,e.jsx)(c4.Button,{asChild:!0,className:"bg-primary","data-testid":"button-call-now",children:(0,e.jsxs)("a",{href:t,children:["Call ",s]})})]})}):(0,e.jsx)("section",{className:l,children:(0,e.jsxs)(c3.Card,{className:"p-8 max-w-2xl mx-auto",children:[(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h3",{className:"text-2xl font-bold mb-2",children:a}),(0,e.jsx)("p",{className:"text-muted-foreground",children:b})]}),(0,e.jsx)(c7.Form,{...u,children:(0,e.jsxs)("form",{onSubmit:u.handleSubmit(a=>{x.mutate(a)}),className:"space-y-6",children:[(0,e.jsxs)("div",{style:{position:"absolute",left:"-9999px",opacity:0},"aria-hidden":"true",children:[(0,e.jsx)("label",{htmlFor:"website-field",children:"Website (leave blank)"}),(0,e.jsx)("input",{type:"text",id:"website-field",name:"website",value:v,onChange:a=>w(a.target.value),autoComplete:"off",tabIndex:-1})]}),(0,e.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,e.jsx)(c7.FormField,{control:u.control,name:"name",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Name *"}),(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c5.Input,{...a,"data-testid":"input-name"})}),(0,e.jsx)(c7.FormMessage,{})]})}),(0,e.jsx)(c7.FormField,{control:u.control,name:"phone",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Phone *"}),(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c5.Input,{...a,type:"tel","data-testid":"input-phone"})}),(0,e.jsx)(c7.FormMessage,{})]})})]}),(0,e.jsx)(c7.FormField,{control:u.control,name:"email",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Email"}),(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c5.Input,{...a,value:a.value||"",type:"email","data-testid":"input-email"})}),(0,e.jsx)(c7.FormMessage,{})]})}),(0,e.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,e.jsx)(c7.FormField,{control:u.control,name:"service",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Service Needed"}),(0,e.jsxs)(c8.Select,{onValueChange:a.onChange,value:a.value||"",children:[(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c8.SelectTrigger,{"data-testid":"select-service",children:(0,e.jsx)(c8.SelectValue,{placeholder:"Select service"})})}),(0,e.jsxs)(c8.SelectContent,{children:[(0,e.jsx)(c8.SelectItem,{value:"water-heater",children:"Water Heater"}),(0,e.jsx)(c8.SelectItem,{value:"drain-cleaning",children:"Drain Cleaning"}),(0,e.jsx)(c8.SelectItem,{value:"leak-repair",children:"Leak Repair"}),(0,e.jsx)(c8.SelectItem,{value:"toilet-faucet",children:"Toilet/Faucet"}),(0,e.jsx)(c8.SelectItem,{value:"gas",children:"Gas Services"}),(0,e.jsx)(c8.SelectItem,{value:"backflow",children:"Backflow Testing"}),(0,e.jsx)(c8.SelectItem,{value:"commercial",children:"Commercial Plumbing"}),(0,e.jsx)(c8.SelectItem,{value:"other",children:"Other"})]})]}),(0,e.jsx)(c7.FormMessage,{})]})}),(0,e.jsx)(c7.FormField,{control:u.control,name:"urgency",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Urgency"}),(0,e.jsxs)(c8.Select,{onValueChange:a.onChange,value:a.value||"",children:[(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c8.SelectTrigger,{"data-testid":"select-urgency",children:(0,e.jsx)(c8.SelectValue,{placeholder:"Select urgency"})})}),(0,e.jsxs)(c8.SelectContent,{children:[(0,e.jsx)(c8.SelectItem,{value:"emergency",children:"Emergency - Need Help Now"}),(0,e.jsx)(c8.SelectItem,{value:"urgent",children:"Urgent - Within 24 Hours"}),(0,e.jsx)(c8.SelectItem,{value:"soon",children:"Soon - This Week"}),(0,e.jsx)(c8.SelectItem,{value:"scheduled",children:"Scheduled - Next Week or Later"})]})]}),(0,e.jsx)(c7.FormMessage,{})]})})]}),(0,e.jsx)(c7.FormField,{control:u.control,name:"location",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"City/Location"}),(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c5.Input,{...a,value:a.value||"",placeholder:"e.g. Austin, Cedar Park","data-testid":"input-location"})}),(0,e.jsx)(c7.FormMessage,{})]})}),(0,e.jsx)(c7.FormField,{control:u.control,name:"message",render:({field:a})=>(0,e.jsxs)(c7.FormItem,{children:[(0,e.jsx)(c7.FormLabel,{children:"Message"}),(0,e.jsx)(c7.FormControl,{children:(0,e.jsx)(c6.Textarea,{...a,value:a.value||"",placeholder:"Describe your plumbing issue...",rows:4,"data-testid":"textarea-message"})}),(0,e.jsx)(c7.FormMessage,{})]})}),(0,e.jsx)(c4.Button,{type:"submit",className:"w-full bg-primary",disabled:x.isPending,"data-testid":"button-submit-contact",children:x.isPending?"Sending...":"Send Message"}),(0,e.jsxs)("p",{className:"text-sm text-center text-muted-foreground",children:["Or call us directly at"," ",(0,e.jsx)("a",{href:t,className:"text-foreground hover:underline",children:s}),k&&(0,e.jsxs)("span",{className:"text-muted-foreground",children:[" (",k,")"]})]})]})})]})})}function db({data:a}){return(0,e.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(a)}})}function dc(a,b,c){return{"@context":"https://schema.org","@type":"Service","@id":c,name:a,serviceType:a,description:b,provider:{"@type":"Plumber","@id":"https://www.plumbersthatcare.com/#austin",name:"Economy Plumbing Services",telephone:["+15123689159","+18304603565"],url:"https://www.plumbersthatcare.com",address:{"@type":"PostalAddress",streetAddress:"701 Tillery St #12",addressLocality:"Austin",addressRegion:"TX",postalCode:"78702",addressCountry:"US"},geo:{"@type":"GeoCoordinates",latitude:"30.2672",longitude:"-97.7431"},aggregateRating:{"@type":"AggregateRating",ratingValue:"4.3",reviewCount:"495",bestRating:"5",worstRating:"1"}},areaServed:[{"@type":"City",name:"Austin",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Cedar Park",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Leander",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Round Rock",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Georgetown",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Pflugerville",containedIn:{"@type":"State",name:"Texas"}},{"@type":"City",name:"Marble Falls",containedIn:{"@type":"State",name:"Texas"}}],url:c,category:"Plumbing Services"}}function dd(a){return{"@context":"https://schema.org","@type":"FAQPage",mainEntity:a.map(a=>({"@type":"Question",name:a.question,acceptedAnswer:{"@type":"Answer",text:a.answer}}))}}function de(a){return{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:a.map((a,b)=>({"@type":"ListItem",position:b+1,name:a.name,...a.url&&{item:a.url}}))}}function df(a){let b=a.timestamp?new Date(1e3*a.timestamp).toISOString():new Date().toISOString();return{"@context":"https://schema.org","@type":"Review",author:{"@type":"Person",name:"Anonymous"===a.authorName?"Google Customer":a.authorName},reviewRating:{"@type":"Rating",ratingValue:a.rating.toString(),bestRating:"5",worstRating:"1"},reviewBody:a.text,datePublished:b,itemReviewed:{"@type":"LocalBusiness","@id":"https://www.plumbersthatcare.com",name:"Economy Plumbing Services",address:{"@type":"PostalAddress",streetAddress:"701 Tillery St #12",addressLocality:"Austin",addressRegion:"TX",postalCode:"78702",addressCountry:"US"},telephone:"+15123689159",url:"https://www.plumbersthatcare.com"}}}a.s(["default",()=>da],673206),a.s(["JsonLd",()=>db,"createBreadcrumbListSchema",()=>de,"createFAQSchema",()=>dd,"createReviewSchema",()=>df,"createServiceSchema",()=>dc],614228)}];

//# sourceMappingURL=src_components_ContactFormSection_tsx_e82f7880._.js.map