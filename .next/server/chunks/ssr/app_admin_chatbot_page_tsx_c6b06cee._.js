module.exports=[343251,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(668929),g=a.i(910738),h=a.i(591119),i=a.i(786304),j=a.i(699570),k=a.i(866718),l=a.i(870430),m=a.i(580701),n=a.i(875083),o=a.i(814574),p=a.i(368114);let q=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:d,className:(0,p.cn)("w-full caption-bottom text-sm",a),...c})}));q.displayName="Table";let r=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("thead",{ref:d,className:(0,p.cn)("[&_tr]:border-b",a),...c}));r.displayName="TableHeader";let s=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tbody",{ref:d,className:(0,p.cn)("[&_tr:last-child]:border-0",a),...c}));s.displayName="TableBody",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tfoot",{ref:d,className:(0,p.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let t=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tr",{ref:d,className:(0,p.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));t.displayName="TableRow";let u=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("th",{ref:d,className:(0,p.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));u.displayName="TableHead";let v=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("td",{ref:d,className:(0,p.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));v.displayName="TableCell",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("caption",{ref:d,className:(0,p.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption";var w=a.i(333140),x=a.i(429246),y=a.i(170106);let z=(0,y.default)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var A=a.i(177156),B=a.i(563588),C=a.i(587532),D=a.i(821374);let E=(0,y.default)("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);var F=a.i(590545),G=a.i(724669),H=a.i(660246),I=a.i(641710),J=a.i(992258);let K=(0,y.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var L=a.i(669520),M=a.i(478793),N=a.i(30553),O=a.i(777192),P=a.i(750104),Q=a.i(470121),R=a.i(746872),S=a.i(507827),T=a.i(872752),U=a.i(130656),V=a.i(507554),W="ScrollArea",[X,Y]=(0,P.createContextScope)(W),[Z,$]=X(W),_=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,type:f="hover",dir:g,scrollHideDelay:h=600,...i}=a,[j,k]=c.useState(null),[l,m]=c.useState(null),[n,o]=c.useState(null),[p,q]=c.useState(null),[r,s]=c.useState(null),[t,u]=c.useState(0),[v,w]=c.useState(0),[x,y]=c.useState(!1),[z,A]=c.useState(!1),B=(0,Q.useComposedRefs)(d,a=>k(a)),C=(0,S.useDirection)(g);return(0,b.jsx)(Z,{scope:e,type:f,dir:C,scrollHideDelay:h,scrollArea:j,viewport:l,onViewportChange:m,content:n,onContentChange:o,scrollbarX:p,onScrollbarXChange:q,scrollbarXEnabled:x,onScrollbarXEnabledChange:y,scrollbarY:r,onScrollbarYChange:s,scrollbarYEnabled:z,onScrollbarYEnabledChange:A,onCornerWidthChange:u,onCornerHeightChange:w,children:(0,b.jsx)(N.Primitive.div,{dir:C,...i,ref:B,style:{position:"relative","--radix-scroll-area-corner-width":t+"px","--radix-scroll-area-corner-height":v+"px",...a.style}})})});_.displayName=W;var aa="ScrollAreaViewport",ab=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,children:f,nonce:g,...h}=a,i=$(aa,e),j=c.useRef(null),k=(0,Q.useComposedRefs)(d,j,i.onViewportChange);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:g}),(0,b.jsx)(N.Primitive.div,{"data-radix-scroll-area-viewport":"",...h,ref:k,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...a.style},children:(0,b.jsx)("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:f})})]})});ab.displayName=aa;var ac="ScrollAreaScrollbar",ad=c.forwardRef((a,d)=>{let{forceMount:e,...f}=a,g=$(ac,a.__scopeScrollArea),{onScrollbarXEnabledChange:h,onScrollbarYEnabledChange:i}=g,j="horizontal"===a.orientation;return c.useEffect(()=>(j?h(!0):i(!0),()=>{j?h(!1):i(!1)}),[j,h,i]),"hover"===g.type?(0,b.jsx)(ae,{...f,ref:d,forceMount:e}):"scroll"===g.type?(0,b.jsx)(af,{...f,ref:d,forceMount:e}):"auto"===g.type?(0,b.jsx)(ag,{...f,ref:d,forceMount:e}):"always"===g.type?(0,b.jsx)(ah,{...f,ref:d}):null});ad.displayName=ac;var ae=c.forwardRef((a,d)=>{let{forceMount:e,...f}=a,g=$(ac,a.__scopeScrollArea),[h,i]=c.useState(!1);return c.useEffect(()=>{let a=g.scrollArea,b=0;if(a){let c=()=>{window.clearTimeout(b),i(!0)},d=()=>{b=window.setTimeout(()=>i(!1),g.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",d),()=>{window.clearTimeout(b),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",d)}}},[g.scrollArea,g.scrollHideDelay]),(0,b.jsx)(O.Presence,{present:e||h,children:(0,b.jsx)(ag,{"data-state":h?"visible":"hidden",...f,ref:d})})}),af=c.forwardRef((a,d)=>{var e;let{forceMount:f,...g}=a,h=$(ac,a.__scopeScrollArea),i="horizontal"===a.orientation,j=az(()=>l("SCROLL_END"),100),[k,l]=(e={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},c.useReducer((a,b)=>e[a][b]??a,"hidden"));return c.useEffect(()=>{if("idle"===k){let a=window.setTimeout(()=>l("HIDE"),h.scrollHideDelay);return()=>window.clearTimeout(a)}},[k,h.scrollHideDelay,l]),c.useEffect(()=>{let a=h.viewport,b=i?"scrollLeft":"scrollTop";if(a){let c=a[b],d=()=>{let d=a[b];c!==d&&(l("SCROLL"),j()),c=d};return a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[h.viewport,i,l,j]),(0,b.jsx)(O.Presence,{present:f||"hidden"!==k,children:(0,b.jsx)(ah,{"data-state":"hidden"===k?"hidden":"visible",...g,ref:d,onPointerEnter:(0,V.composeEventHandlers)(a.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:(0,V.composeEventHandlers)(a.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),ag=c.forwardRef((a,d)=>{let e=$(ac,a.__scopeScrollArea),{forceMount:f,...g}=a,[h,i]=c.useState(!1),j="horizontal"===a.orientation,k=az(()=>{if(e.viewport){let a=e.viewport.offsetWidth<e.viewport.scrollWidth,b=e.viewport.offsetHeight<e.viewport.scrollHeight;i(j?a:b)}},10);return aA(e.viewport,k),aA(e.content,k),(0,b.jsx)(O.Presence,{present:f||h,children:(0,b.jsx)(ah,{"data-state":h?"visible":"hidden",...g,ref:d})})}),ah=c.forwardRef((a,d)=>{let{orientation:e="vertical",...f}=a,g=$(ac,a.__scopeScrollArea),h=c.useRef(null),i=c.useRef(0),[j,k]=c.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),l=au(j.viewport,j.content),m={...f,sizes:j,onSizesChange:k,hasThumb:!!(l>0&&l<1),onThumbChange:a=>h.current=a,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:a=>i.current=a};function n(a,b){return function(a,b,c,d="ltr"){let e=av(c),f=b||e/2,g=c.scrollbar.paddingStart+f,h=c.scrollbar.size-c.scrollbar.paddingEnd-(e-f),i=c.content-c.viewport;return ax([g,h],"ltr"===d?[0,i]:[-1*i,0])(a)}(a,i.current,j,b)}return"horizontal"===e?(0,b.jsx)(ai,{...m,ref:d,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=aw(g.viewport.scrollLeft,j,g.dir);h.current.style.transform=`translate3d(${a}px, 0, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollLeft=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollLeft=n(a,g.dir))}}):"vertical"===e?(0,b.jsx)(aj,{...m,ref:d,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=aw(g.viewport.scrollTop,j);h.current.style.transform=`translate3d(0, ${a}px, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollTop=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollTop=n(a))}}):null}),ai=c.forwardRef((a,d)=>{let{sizes:e,onSizesChange:f,...g}=a,h=$(ac,a.__scopeScrollArea),[i,j]=c.useState(),k=c.useRef(null),l=(0,Q.useComposedRefs)(d,k,h.onScrollbarXChange);return c.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,b.jsx)(am,{"data-orientation":"horizontal",...g,ref:l,sizes:e,style:{bottom:0,left:"rtl"===h.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===h.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":av(e)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.x),onDragScroll:b=>a.onDragScroll(b.x),onWheelScroll:(b,c)=>{if(h.viewport){var d,e;let f=h.viewport.scrollLeft+b.deltaX;a.onWheelScroll(f),d=f,e=c,d>0&&d<e&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollWidth,viewport:h.viewport.offsetWidth,scrollbar:{size:k.current.clientWidth,paddingStart:at(i.paddingLeft),paddingEnd:at(i.paddingRight)}})}})}),aj=c.forwardRef((a,d)=>{let{sizes:e,onSizesChange:f,...g}=a,h=$(ac,a.__scopeScrollArea),[i,j]=c.useState(),k=c.useRef(null),l=(0,Q.useComposedRefs)(d,k,h.onScrollbarYChange);return c.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,b.jsx)(am,{"data-orientation":"vertical",...g,ref:l,sizes:e,style:{top:0,right:"ltr"===h.dir?0:void 0,left:"rtl"===h.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":av(e)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.y),onDragScroll:b=>a.onDragScroll(b.y),onWheelScroll:(b,c)=>{if(h.viewport){var d,e;let f=h.viewport.scrollTop+b.deltaY;a.onWheelScroll(f),d=f,e=c,d>0&&d<e&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollHeight,viewport:h.viewport.offsetHeight,scrollbar:{size:k.current.clientHeight,paddingStart:at(i.paddingTop),paddingEnd:at(i.paddingBottom)}})}})}),[ak,al]=X(ac),am=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,sizes:f,hasThumb:g,onThumbChange:h,onThumbPointerUp:i,onThumbPointerDown:j,onThumbPositionChange:k,onDragScroll:l,onWheelScroll:m,onResize:n,...o}=a,p=$(ac,e),[q,r]=c.useState(null),s=(0,Q.useComposedRefs)(d,a=>r(a)),t=c.useRef(null),u=c.useRef(""),v=p.viewport,w=f.content-f.viewport,x=(0,R.useCallbackRef)(m),y=(0,R.useCallbackRef)(k),z=az(n,10);function A(a){t.current&&l({x:a.clientX-t.current.left,y:a.clientY-t.current.top})}return c.useEffect(()=>{let a=a=>{let b=a.target;q?.contains(b)&&x(a,w)};return document.addEventListener("wheel",a,{passive:!1}),()=>document.removeEventListener("wheel",a,{passive:!1})},[v,q,w,x]),c.useEffect(y,[f,y]),aA(q,z),aA(p.content,z),(0,b.jsx)(ak,{scope:e,scrollbar:q,hasThumb:g,onThumbChange:(0,R.useCallbackRef)(h),onThumbPointerUp:(0,R.useCallbackRef)(i),onThumbPositionChange:y,onThumbPointerDown:(0,R.useCallbackRef)(j),children:(0,b.jsx)(N.Primitive.div,{...o,ref:s,style:{position:"absolute",...o.style},onPointerDown:(0,V.composeEventHandlers)(a.onPointerDown,a=>{0===a.button&&(a.target.setPointerCapture(a.pointerId),t.current=q.getBoundingClientRect(),u.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A(a))}),onPointerMove:(0,V.composeEventHandlers)(a.onPointerMove,A),onPointerUp:(0,V.composeEventHandlers)(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),document.body.style.webkitUserSelect=u.current,p.viewport&&(p.viewport.style.scrollBehavior=""),t.current=null})})})}),an="ScrollAreaThumb",ao=c.forwardRef((a,c)=>{let{forceMount:d,...e}=a,f=al(an,a.__scopeScrollArea);return(0,b.jsx)(O.Presence,{present:d||f.hasThumb,children:(0,b.jsx)(ap,{ref:c,...e})})}),ap=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,style:f,...g}=a,h=$(an,e),i=al(an,e),{onThumbPositionChange:j}=i,k=(0,Q.useComposedRefs)(d,a=>i.onThumbChange(a)),l=c.useRef(void 0),m=az(()=>{l.current&&(l.current(),l.current=void 0)},100);return c.useEffect(()=>{let a=h.viewport;if(a){let b=()=>{m(),l.current||(l.current=ay(a,j),j())};return j(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[h.viewport,m,j]),(0,b.jsx)(N.Primitive.div,{"data-state":i.hasThumb?"visible":"hidden",...g,ref:k,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...f},onPointerDownCapture:(0,V.composeEventHandlers)(a.onPointerDownCapture,a=>{let b=a.target.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;i.onThumbPointerDown({x:c,y:d})}),onPointerUp:(0,V.composeEventHandlers)(a.onPointerUp,i.onThumbPointerUp)})});ao.displayName=an;var aq="ScrollAreaCorner",ar=c.forwardRef((a,c)=>{let d=$(aq,a.__scopeScrollArea),e=!!(d.scrollbarX&&d.scrollbarY);return"scroll"!==d.type&&e?(0,b.jsx)(as,{...a,ref:c}):null});ar.displayName=aq;var as=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,...f}=a,g=$(aq,e),[h,i]=c.useState(0),[j,k]=c.useState(0),l=!!(h&&j);return aA(g.scrollbarX,()=>{let a=g.scrollbarX?.offsetHeight||0;g.onCornerHeightChange(a),k(a)}),aA(g.scrollbarY,()=>{let a=g.scrollbarY?.offsetWidth||0;g.onCornerWidthChange(a),i(a)}),l?(0,b.jsx)(N.Primitive.div,{...f,ref:d,style:{width:h,height:j,position:"absolute",right:"ltr"===g.dir?0:void 0,left:"rtl"===g.dir?0:void 0,bottom:0,...a.style}}):null});function at(a){return a?parseInt(a,10):0}function au(a,b){let c=a/b;return isNaN(c)?0:c}function av(a){let b=au(a.viewport,a.content),c=a.scrollbar.paddingStart+a.scrollbar.paddingEnd;return Math.max((a.scrollbar.size-c)*b,18)}function aw(a,b,c="ltr"){let d=av(b),e=b.scrollbar.paddingStart+b.scrollbar.paddingEnd,f=b.scrollbar.size-e,g=b.content-b.viewport,h=(0,U.clamp)(a,"ltr"===c?[0,g]:[-1*g,0]);return ax([0,g],[0,f-d])(h)}function ax(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}var ay=(a,b=()=>{})=>{let c={left:a.scrollLeft,top:a.scrollTop},d=0;return!function e(){let f={left:a.scrollLeft,top:a.scrollTop},g=c.left!==f.left,h=c.top!==f.top;(g||h)&&b(),c=f,d=window.requestAnimationFrame(e)}(),()=>window.cancelAnimationFrame(d)};function az(a,b){let d=(0,R.useCallbackRef)(a),e=c.useRef(0);return c.useEffect(()=>()=>window.clearTimeout(e.current),[]),c.useCallback(()=>{window.clearTimeout(e.current),e.current=window.setTimeout(d,b)},[d,b])}function aA(a,b){let c=(0,R.useCallbackRef)(b);(0,T.useLayoutEffect)(()=>{let b=0;if(a){let d=new ResizeObserver(()=>{cancelAnimationFrame(b),b=window.requestAnimationFrame(c)});return d.observe(a),()=>{window.cancelAnimationFrame(b),d.unobserve(a)}}},[a,c])}let aB=c.forwardRef(({className:a,children:c,...d},e)=>(0,b.jsxs)(_,{ref:e,className:(0,p.cn)("relative overflow-hidden",a),...d,children:[(0,b.jsx)(ab,{className:"h-full w-full rounded-[inherit]",children:c}),(0,b.jsx)(aC,{}),(0,b.jsx)(ar,{})]}));aB.displayName=_.displayName;let aC=c.forwardRef(({className:a,orientation:c="vertical",...d},e)=>(0,b.jsx)(ad,{ref:e,orientation:c,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===c&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===c&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...d,children:(0,b.jsx)(ao,{className:"relative flex-1 rounded-full bg-border"})}));aC.displayName=ad.displayName;var aD=a.i(505084);function aE(){let{toast:a}=(0,M.useToast)(),[p,y]=(0,c.useState)("conversations"),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)("all"),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(!1),{data:_=[],isLoading:aa,refetch:ab}=(0,d.useQuery)({queryKey:["/api/admin/chatbot/conversations"]}),{data:ac,isLoading:ad}=(0,d.useQuery)({queryKey:["/api/admin/chatbot/analytics"]}),{data:ae=[],isLoading:af,refetch:ag}=(0,d.useQuery)({queryKey:["/api/admin/chatbot/quick-responses"]}),ah=(0,e.useMutation)({mutationFn:async({id:a,archived:b})=>(0,f.apiRequest)("PATCH",`/api/admin/chatbot/conversation/${a}`,{archived:b}),onSuccess:()=>{a({title:"Success",description:"Conversation updated successfully"}),ab(),R&&S(null)},onError:()=>{a({title:"Error",description:"Failed to update conversation",variant:"destructive"})}}),ai=(0,e.useMutation)({mutationFn:async({id:a,notes:b})=>(0,f.apiRequest)("PATCH",`/api/admin/chatbot/conversation/${a}`,{notes:b}),onSuccess:()=>{a({title:"Success",description:"Notes saved successfully"}),ab()},onError:()=>{a({title:"Error",description:"Failed to save notes",variant:"destructive"})}}),aj=(0,e.useMutation)({mutationFn:async a=>a.id?(0,f.apiRequest)("PATCH",`/api/admin/chatbot/quick-responses/${a.id}`,a):(0,f.apiRequest)("POST","/api/admin/chatbot/quick-responses",a),onSuccess:()=>{a({title:"Success",description:"Quick response saved successfully"}),ag(),Y(null)},onError:()=>{a({title:"Error",description:"Failed to save quick response",variant:"destructive"})}}),ak=(0,e.useMutation)({mutationFn:async a=>(0,f.apiRequest)("DELETE",`/api/admin/chatbot/quick-responses/${a}`),onSuccess:()=>{a({title:"Success",description:"Quick response deleted successfully"}),ag()},onError:()=>{a({title:"Error",description:"Failed to delete quick response",variant:"destructive"})}}),al=async b=>{S(b),W(!0);try{let a=await fetch(`/api/admin/chatbot/conversation/${b.id}`);if(a.ok){let b=await a.json();U(b.messages||[])}}catch(b){console.error("Failed to load conversation details:",b),a({title:"Error",description:"Failed to load conversation details",variant:"destructive"})}finally{W(!1)}},am=async b=>{try{await (0,f.apiRequest)("POST",`/api/admin/chatbot/conversation/${b}/email`),a({title:"Success",description:"Conversation emailed to admin successfully"})}catch(b){a({title:"Error",description:"Failed to email conversation",variant:"destructive"})}},an=async b=>{try{let c=await fetch(`/api/admin/chatbot/export?format=${b}`);if(c.ok){let d=await c.blob(),e=window.URL.createObjectURL(d),f=document.createElement("a");f.href=e,f.download=`chatbot-conversations-${new Date().toISOString().split("T")[0]}.${b}`,f.click(),window.URL.revokeObjectURL(e),a({title:"Success",description:`Conversations exported as ${b.toUpperCase()}`})}}catch(b){a({title:"Error",description:"Failed to export conversations",variant:"destructive"})}$(!1)},ao=_.filter(a=>{if("active"===P&&a.archived||"archived"===P&&!a.archived)return!1;if(N){let b=N.toLowerCase();return a.customerName?.toLowerCase().includes(b)||a.customerEmail?.toLowerCase().includes(b)||a.lastMessage?.toLowerCase().includes(b)||a.pageContext?.toLowerCase().includes(b)}return!0});return(0,b.jsxs)("div",{className:"container mx-auto p-6 max-w-7xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"AI Chatbot Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monitor conversations, analyze engagement, and manage responses"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Button,{onClick:()=>ab(),variant:"outline","data-testid":"button-refresh-conversations",children:[(0,b.jsx)(L.RefreshCw,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,b.jsxs)(j.Button,{onClick:()=>$(!0),"data-testid":"button-export-conversations",children:[(0,b.jsx)(K,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),(0,b.jsxs)(n.Tabs,{value:p,onValueChange:y,className:"space-y-4",children:[(0,b.jsxs)(n.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsxs)(n.TabsTrigger,{value:"conversations","data-testid":"tab-conversations",children:[(0,b.jsx)(B.MessageSquare,{className:"w-4 h-4 mr-2"}),"Conversations"]}),(0,b.jsxs)(n.TabsTrigger,{value:"analytics","data-testid":"tab-analytics",children:[(0,b.jsx)(G.TrendingUp,{className:"w-4 h-4 mr-2"}),"Analytics"]}),(0,b.jsxs)(n.TabsTrigger,{value:"quick-responses","data-testid":"tab-quick-responses",children:[(0,b.jsx)(I.Clock,{className:"w-4 h-4 mr-2"}),"Quick Responses"]}),(0,b.jsxs)(n.TabsTrigger,{value:"settings","data-testid":"tab-settings",children:[(0,b.jsx)(z,{className:"w-4 h-4 mr-2"}),"Settings"]})]}),(0,b.jsx)(n.TabsContent,{value:"conversations",className:"space-y-4",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)(h.CardTitle,{children:"Recent Conversations"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(C.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(k.Input,{placeholder:"Search conversations...",value:N,onChange:a=>O(a.target.value),className:"pl-8 w-64","data-testid":"input-search-conversations"})]}),(0,b.jsxs)(m.Select,{value:P,onValueChange:a=>Q(a),children:[(0,b.jsx)(m.SelectTrigger,{className:"w-32","data-testid":"select-filter-status",children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(m.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(m.SelectItem,{value:"archived",children:"Archived"})]})]})]})]})}),(0,b.jsx)(h.CardContent,{children:aa?(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsx)(w.Skeleton,{className:"h-20 w-full"},a))}):(0,b.jsxs)(q,{children:[(0,b.jsx)(r,{children:(0,b.jsxs)(t,{children:[(0,b.jsx)(u,{children:"Customer"}),(0,b.jsx)(u,{children:"Started"}),(0,b.jsx)(u,{children:"Messages"}),(0,b.jsx)(u,{children:"Page"}),(0,b.jsx)(u,{children:"Rating"}),(0,b.jsx)(u,{children:"Status"}),(0,b.jsx)(u,{children:"Actions"})]})}),(0,b.jsx)(s,{children:0===ao.length?(0,b.jsx)(t,{children:(0,b.jsx)(v,{colSpan:7,className:"text-center py-8",children:"No conversations found"})}):ao.map(a=>(0,b.jsxs)(t,{children:[(0,b.jsx)(v,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.customerName||"Anonymous"}),a.customerEmail&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.customerEmail})]})}),(0,b.jsx)(v,{children:(0,g.formatDistanceToNow)(new Date(a.startedAt),{addSuffix:!0})}),(0,b.jsx)(v,{children:a.messageCount||0}),(0,b.jsx)(v,{children:(0,b.jsx)(i.Badge,{variant:"outline",children:a.pageContext||"Unknown"})}),(0,b.jsx)(v,{children:a.rating?(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(D.Star,{className:"w-4 h-4 text-yellow-500 mr-1"}),a.rating]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(v,{children:(0,b.jsx)(i.Badge,{variant:a.archived?"secondary":a.endedAt?"default":"outline",children:a.archived?"Archived":a.endedAt?"Ended":"Active"})}),(0,b.jsx)(v,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(j.Button,{size:"icon",variant:"ghost",onClick:()=>al(a),"data-testid":`button-view-conversation-${a.id}`,children:(0,b.jsx)(A.Eye,{className:"w-4 h-4"})}),(0,b.jsx)(j.Button,{size:"icon",variant:"ghost",onClick:()=>am(a.id),"data-testid":`button-email-conversation-${a.id}`,children:(0,b.jsx)(J.Mail,{className:"w-4 h-4"})}),(0,b.jsx)(j.Button,{size:"icon",variant:"ghost",onClick:()=>ah.mutate({id:a.id,archived:!a.archived}),"data-testid":`button-archive-conversation-${a.id}`,children:(0,b.jsx)(z,{className:"w-4 h-4"})})]})})]},a.id))})]})})]})}),(0,b.jsxs)(n.TabsContent,{value:"analytics",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Total Conversations"}),(0,b.jsx)(B.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad?(0,b.jsx)(w.Skeleton,{className:"h-8 w-20"}):ac?.totalConversations||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Active Now"}),(0,b.jsx)(H.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad?(0,b.jsx)(w.Skeleton,{className:"h-8 w-20"}):ac?.activeConversations||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently chatting"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Avg Rating"}),(0,b.jsx)(D.Star,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad?(0,b.jsx)(w.Skeleton,{className:"h-8 w-20"}):ac?.averageRating?.toFixed(1)||"N/A"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Out of 5 stars"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Feedback"}),(0,b.jsx)(F.ThumbsUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(F.ThumbsUp,{className:"w-4 h-4 text-green-600 mr-1"}),(0,b.jsx)("span",{className:"font-bold",children:ac?.totalFeedback?.positive||0})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(E,{className:"w-4 h-4 text-red-600 mr-1"}),(0,b.jsx)("span",{className:"font-bold",children:ac?.totalFeedback?.negative||0})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"User feedback"})]})]})]}),ac?.commonQuestions&&ac.commonQuestions.length>0&&(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:"Common Questions"}),(0,b.jsx)(h.CardDescription,{children:"Most frequently asked questions by customers"})]}),(0,b.jsx)(h.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:ac.commonQuestions.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg bg-muted",children:[(0,b.jsx)("span",{className:"flex-1",children:a.question}),(0,b.jsxs)(i.Badge,{variant:"secondary",children:[a.count," times"]})]},c))})})]})]}),(0,b.jsx)(n.TabsContent,{value:"quick-responses",className:"space-y-4",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{children:"Quick Response Templates"}),(0,b.jsx)(h.CardDescription,{children:"Manage predefined responses for common questions"})]}),(0,b.jsx)(j.Button,{onClick:()=>Y({}),"data-testid":"button-add-quick-response",children:"Add Response"})]})}),(0,b.jsx)(h.CardContent,{children:af?(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsx)(w.Skeleton,{className:"h-16 w-full"},a))}):(0,b.jsx)("div",{className:"space-y-2",children:0===ae.length?(0,b.jsx)("p",{className:"text-center py-8 text-muted-foreground",children:"No quick responses configured"}):ae.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h4",{className:"font-medium",children:a.label}),(0,b.jsx)(i.Badge,{variant:"outline",children:a.category}),!a.isActive&&(0,b.jsx)(i.Badge,{variant:"secondary",children:"Inactive"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.message})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",onClick:()=>Y(a),"data-testid":`button-edit-quick-response-${a.id}`,children:"Edit"}),(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",onClick:()=>ak.mutate(a.id),"data-testid":`button-delete-quick-response-${a.id}`,children:"Delete"})]})]},a.id))})})]})}),(0,b.jsx)(n.TabsContent,{value:"settings",className:"space-y-4",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:"Chatbot Configuration"}),(0,b.jsx)(h.CardDescription,{children:"Configure chatbot behavior and settings"})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Greeting Message"}),(0,b.jsx)(x.Textarea,{placeholder:"Hi! How can I help you today?",className:"min-h-20","data-testid":"textarea-greeting-message"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Auto-Response Delay (seconds)"}),(0,b.jsx)(k.Input,{type:"number",defaultValue:"1",min:"0",max:"10","data-testid":"input-response-delay"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Session Timeout (minutes)"}),(0,b.jsx)(k.Input,{type:"number",defaultValue:"30",min:"5",max:"120","data-testid":"input-session-timeout"})]}),(0,b.jsx)(j.Button,{className:"w-full","data-testid":"button-save-settings",children:"Save Settings"})]})]})})]}),(0,b.jsx)(o.Dialog,{open:!!R,onOpenChange:()=>S(null),children:(0,b.jsxs)(o.DialogContent,{className:"max-w-4xl max-h-[80vh]",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Conversation Details"}),(0,b.jsx)(o.DialogDescription,{children:R&&(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,b.jsx)(i.Badge,{children:R.pageContext||"Unknown Page"}),(0,b.jsxs)("span",{className:"text-sm",children:["Started ",(0,g.formatDistanceToNow)(new Date(R.startedAt),{addSuffix:!0})]}),R.rating&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(D.Star,{className:"w-4 h-4 text-yellow-500 mr-1"}),R.rating,"/5"]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)(aB,{className:"h-[400px] border rounded-lg p-4",children:V?(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsx)(w.Skeleton,{className:"h-16 w-full"},a))}):(0,b.jsx)("div",{className:"space-y-4",children:T.map(a=>(0,b.jsx)("div",{className:`flex ${"user"===a.role?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-[70%] p-3 rounded-lg ${"user"===a.role?"bg-primary text-primary-foreground":"bg-muted"}`,children:[a.imageUrl&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)("img",{src:a.imageUrl,alt:"Uploaded",className:"rounded-lg max-w-full"})}),(0,b.jsx)("p",{className:"text-sm",children:a.content}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,b.jsx)("span",{className:"text-xs opacity-70",children:(0,g.formatDistanceToNow)(new Date(a.timestamp),{addSuffix:!0})}),"assistant"===a.role&&a.feedback&&(0,b.jsx)("div",{className:"flex items-center",children:"positive"===a.feedback?(0,b.jsx)(F.ThumbsUp,{className:"w-3 h-3 text-green-600"}):(0,b.jsx)(E,{className:"w-3 h-3 text-red-600"})})]})]})},a.id))})})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Internal Notes"}),(0,b.jsx)(x.Textarea,{placeholder:"Add notes about this conversation...",value:R?.notes||"",onChange:a=>{R&&S({...R,notes:a.target.value})},className:"min-h-32 mt-2","data-testid":"textarea-conversation-notes"}),(0,b.jsx)(j.Button,{className:"w-full mt-2",onClick:()=>{R&&R.notes&&ai.mutate({id:R.id,notes:R.notes})},"data-testid":"button-save-notes",children:"Save Notes"})]}),(0,b.jsx)(aD.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Button,{className:"w-full",variant:"outline",onClick:()=>R&&am(R.id),"data-testid":"button-email-conversation-detail",children:[(0,b.jsx)(J.Mail,{className:"w-4 h-4 mr-2"}),"Email Conversation"]}),(0,b.jsxs)(j.Button,{className:"w-full",variant:"outline",onClick:()=>{R&&ah.mutate({id:R.id,archived:!R.archived})},"data-testid":"button-archive-conversation-detail",children:[(0,b.jsx)(z,{className:"w-4 h-4 mr-2"}),R?.archived?"Unarchive":"Archive"]})]})]})]})]})}),(0,b.jsx)(o.Dialog,{open:!!X,onOpenChange:()=>Y(null),children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)(o.DialogTitle,{children:[X?.id?"Edit":"Add"," Quick Response"]})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Label"}),(0,b.jsx)(k.Input,{value:X?.label||"",onChange:a=>Y({...X,label:a.target.value}),placeholder:"e.g., Schedule Service","data-testid":"input-quick-response-label"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Message"}),(0,b.jsx)(x.Textarea,{value:X?.message||"",onChange:a=>Y({...X,message:a.target.value}),placeholder:"The message that will be sent...",className:"min-h-24","data-testid":"textarea-quick-response-message"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Category"}),(0,b.jsxs)(m.Select,{value:X?.category||"general",onValueChange:a=>Y({...X,category:a}),children:[(0,b.jsx)(m.SelectTrigger,{"data-testid":"select-quick-response-category",children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"general",children:"General"}),(0,b.jsx)(m.SelectItem,{value:"service",children:"Service"}),(0,b.jsx)(m.SelectItem,{value:"emergency",children:"Emergency"}),(0,b.jsx)(m.SelectItem,{value:"pricing",children:"Pricing"}),(0,b.jsx)(m.SelectItem,{value:"hours",children:"Hours"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Sort Order"}),(0,b.jsx)(k.Input,{type:"number",value:X?.sortOrder||0,onChange:a=>Y({...X,sortOrder:parseInt(a.target.value)||0}),min:"0","data-testid":"input-quick-response-sort-order"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"quick-response-active",checked:X?.isActive!==!1,onChange:a=>Y({...X,isActive:a.target.checked}),"data-testid":"checkbox-quick-response-active"}),(0,b.jsx)(l.Label,{htmlFor:"quick-response-active",children:"Active"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>Y(null),"data-testid":"button-cancel-quick-response",children:"Cancel"}),(0,b.jsx)(j.Button,{onClick:()=>aj.mutate(X),"data-testid":"button-save-quick-response",children:"Save"})]})]})]})}),(0,b.jsx)(o.Dialog,{open:Z,onOpenChange:$,children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Export Conversations"}),(0,b.jsx)(o.DialogDescription,{children:"Choose the format for exporting conversation data"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(j.Button,{className:"flex-1",onClick:()=>an("csv"),"data-testid":"button-export-csv",children:"Export as CSV"}),(0,b.jsx)(j.Button,{className:"flex-1",variant:"outline",onClick:()=>an("json"),"data-testid":"button-export-json",children:"Export as JSON"})]})]})})]})}a.s(["default",()=>aE],343251)}];

//# sourceMappingURL=app_admin_chatbot_page_tsx_c6b06cee._.js.map