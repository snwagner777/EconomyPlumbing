<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/attached_assets/favicon.png" />
    <link rel="apple-touch-icon" href="/attached_assets/logo.jpg" />
    
    <!-- DNS Prefetch for third-party domains -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://static.servicetitan.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://js.stripe.com">
    <link rel="dns-prefetch" href="https://maps.googleapis.com">
    
    <!-- Preconnect for critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Preconnect for payment and analytics (non-critical, no crossorigin) -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://js.stripe.com">
    
    <!-- Preload critical fonts for LCP -->
    <link rel="preload" as="font" type="font/woff2" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZJhiI2B.woff2" crossorigin>
    
    <!-- Async load fonts -->
    <link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap"></noscript>
    
    <!-- Inline critical CSS for LCP optimization -->
    <style>
      /* Critical above-the-fold styles to prevent layout shift and improve LCP */
      :root {
        --background: 0 0% 100%;
        --foreground: 222.2 84% 4.9%;
        --primary: 207 90% 54%;
        --primary-foreground: 210 40% 98%;
      }
      
      .dark {
        --background: 222.2 84% 4.9%;
        --foreground: 210 40% 98%;
        --primary: 207 90% 54%;
        --primary-foreground: 210 40% 98%;
      }
      
      html { scroll-behavior: smooth; }
      body {
        margin: 0;
        font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: hsl(var(--background));
        color: hsl(var(--foreground));
      }
      
      #root { min-height: 100vh; }
      
      /* Prevent layout shift for loading spinner */
      .animate-spin {
        animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    </style>
    
    <title>Economy Plumbing Services | Austin & Marble Falls Plumber</title>
    <meta name="description" content="Central Texas' Best Little Plumbing Company Since 2012. Licensed, insured plumbing services including water heater repair, drain cleaning, and emergency plumbing in Austin and Marble Falls." />
    
    <!-- Dynamic Phone Number Tracking Script -->
    <script>
      (function() {
        const PHONE_NUMBERS = {
          default: { display: '(512) 649-2811', tel: 'tel:+15126492811' },
          google: { display: '(512) 368-9159', tel: 'tel:+15123689159' },
          facebook: { display: '(512) 575-3157', tel: 'tel:+15125753157' },
          instagram: { display: '(512) 575-3157', tel: 'tel:+15125753157' },
          yelp: { display: '(512) 893-7316', tel: 'tel:+15128937316' },
          nextdoor: { display: '(512) 846-9146', tel: 'tel:+15128469146' }
        };

        function getCookie(name) {
          const value = '; ' + document.cookie;
          const parts = value.split('; ' + name + '=');
          if (parts.length === 2) return parts.pop().split(';').shift();
          return null;
        }

        function setCookie(name, value, days) {
          const date = new Date();
          date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
          document.cookie = name + '=' + value + ';expires=' + date.toUTCString() + ';path=/';
        }

        function detectTrafficSource() {
          const urlParams = new URLSearchParams(window.location.search);
          const referrer = document.referrer.toLowerCase();
          const utmSource = urlParams.get('utm_source')?.toLowerCase();

          if (urlParams.has('gclid') || utmSource === 'google' || referrer.includes('google.com')) {
            return 'google';
          }
          if (urlParams.has('fbclid') || referrer.includes('facebook.com') || referrer.includes('instagram.com')) {
            return 'facebook';
          }
          if (utmSource === 'facebook' || utmSource === 'instagram' || utmSource === 'fb' || utmSource === 'ig') {
            return 'facebook';
          }
          if (referrer.includes('yelp.com') || utmSource === 'yelp') {
            return 'yelp';
          }
          if (referrer.includes('nextdoor.com') || utmSource === 'nextdoor') {
            return 'nextdoor';
          }
          return 'default';
        }

        function getTrafficSource() {
          const detectedSource = detectTrafficSource();
          if (detectedSource !== 'default') {
            setCookie('traffic_source', detectedSource, 90);
            return detectedSource;
          }
          const cookieSource = getCookie('traffic_source');
          if (cookieSource && PHONE_NUMBERS[cookieSource]) {
            return cookieSource;
          }
          return 'default';
        }

        window.__PHONE_CONFIG__ = PHONE_NUMBERS[getTrafficSource()] || PHONE_NUMBERS.default;
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>